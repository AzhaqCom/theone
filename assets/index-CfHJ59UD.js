(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))u(d);new MutationObserver(d=>{for(const f of d)if(f.type==="childList")for(const h of f.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&u(h)}).observe(document,{childList:!0,subtree:!0});function s(d){const f={};return d.integrity&&(f.integrity=d.integrity),d.referrerPolicy&&(f.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?f.credentials="include":d.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function u(d){if(d.ep)return;d.ep=!0;const f=s(d);fetch(d.href,f)}})();function nu(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var Yr={exports:{}},Wl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wf;function Ih(){if(Wf)return Wl;Wf=1;var c=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function s(u,d,f){var h=null;if(f!==void 0&&(h=""+f),d.key!==void 0&&(h=""+d.key),"key"in d){f={};for(var m in d)m!=="key"&&(f[m]=d[m])}else f=d;return d=f.ref,{$$typeof:c,type:u,key:h,ref:d!==void 0?d:null,props:f}}return Wl.Fragment=r,Wl.jsx=s,Wl.jsxs=s,Wl}var Ff;function Wh(){return Ff||(Ff=1,Yr.exports=Ih()),Yr.exports}var i=Wh(),Xr={exports:{}},de={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var em;function Fh(){if(em)return de;em=1;var c=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),f=Symbol.for("react.consumer"),h=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),x=Symbol.iterator;function A(S){return S===null||typeof S!="object"?null:(S=x&&S[x]||S["@@iterator"],typeof S=="function"?S:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,E={};function D(S,U,k){this.props=S,this.context=U,this.refs=E,this.updater=k||N}D.prototype.isReactComponent={},D.prototype.setState=function(S,U){if(typeof S!="object"&&typeof S!="function"&&S!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,S,U,"setState")},D.prototype.forceUpdate=function(S){this.updater.enqueueForceUpdate(this,S,"forceUpdate")};function M(){}M.prototype=D.prototype;function B(S,U,k){this.props=S,this.context=U,this.refs=E,this.updater=k||N}var V=B.prototype=new M;V.constructor=B,C(V,D.prototype),V.isPureReactComponent=!0;var le=Array.isArray,I={H:null,A:null,T:null,S:null,V:null},ae=Object.prototype.hasOwnProperty;function J(S,U,k,Z,F,fe){return k=fe.ref,{$$typeof:c,type:S,key:U,ref:k!==void 0?k:null,props:fe}}function te(S,U){return J(S.type,U,void 0,void 0,void 0,S.props)}function K(S){return typeof S=="object"&&S!==null&&S.$$typeof===c}function me(S){var U={"=":"=0",":":"=2"};return"$"+S.replace(/[=:]/g,function(k){return U[k]})}var ie=/\/+/g;function Ee(S,U){return typeof S=="object"&&S!==null&&S.key!=null?me(""+S.key):U.toString(36)}function Le(){}function w(S){switch(S.status){case"fulfilled":return S.value;case"rejected":throw S.reason;default:switch(typeof S.status=="string"?S.then(Le,Le):(S.status="pending",S.then(function(U){S.status==="pending"&&(S.status="fulfilled",S.value=U)},function(U){S.status==="pending"&&(S.status="rejected",S.reason=U)})),S.status){case"fulfilled":return S.value;case"rejected":throw S.reason}}throw S}function $(S,U,k,Z,F){var fe=typeof S;(fe==="undefined"||fe==="boolean")&&(S=null);var ce=!1;if(S===null)ce=!0;else switch(fe){case"bigint":case"string":case"number":ce=!0;break;case"object":switch(S.$$typeof){case c:case r:ce=!0;break;case b:return ce=S._init,$(ce(S._payload),U,k,Z,F)}}if(ce)return F=F(S),ce=Z===""?"."+Ee(S,0):Z,le(F)?(k="",ce!=null&&(k=ce.replace(ie,"$&/")+"/"),$(F,U,k,"",function(Vt){return Vt})):F!=null&&(K(F)&&(F=te(F,k+(F.key==null||S&&S.key===F.key?"":(""+F.key).replace(ie,"$&/")+"/")+ce)),U.push(F)),1;ce=0;var Ze=Z===""?".":Z+":";if(le(S))for(var _e=0;_e<S.length;_e++)Z=S[_e],fe=Ze+Ee(Z,_e),ce+=$(Z,U,k,fe,F);else if(_e=A(S),typeof _e=="function")for(S=_e.call(S),_e=0;!(Z=S.next()).done;)Z=Z.value,fe=Ze+Ee(Z,_e++),ce+=$(Z,U,k,fe,F);else if(fe==="object"){if(typeof S.then=="function")return $(w(S),U,k,Z,F);throw U=String(S),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(S).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.")}return ce}function j(S,U,k){if(S==null)return S;var Z=[],F=0;return $(S,Z,"","",function(fe){return U.call(k,fe,F++)}),Z}function L(S){if(S._status===-1){var U=S._result;U=U(),U.then(function(k){(S._status===0||S._status===-1)&&(S._status=1,S._result=k)},function(k){(S._status===0||S._status===-1)&&(S._status=2,S._result=k)}),S._status===-1&&(S._status=0,S._result=U)}if(S._status===1)return S._result.default;throw S._result}var X=typeof reportError=="function"?reportError:function(S){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var U=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof S=="object"&&S!==null&&typeof S.message=="string"?String(S.message):String(S),error:S});if(!window.dispatchEvent(U))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",S);return}console.error(S)};function Q(){}return de.Children={map:j,forEach:function(S,U,k){j(S,function(){U.apply(this,arguments)},k)},count:function(S){var U=0;return j(S,function(){U++}),U},toArray:function(S){return j(S,function(U){return U})||[]},only:function(S){if(!K(S))throw Error("React.Children.only expected to receive a single React element child.");return S}},de.Component=D,de.Fragment=s,de.Profiler=d,de.PureComponent=B,de.StrictMode=u,de.Suspense=g,de.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,de.__COMPILER_RUNTIME={__proto__:null,c:function(S){return I.H.useMemoCache(S)}},de.cache=function(S){return function(){return S.apply(null,arguments)}},de.cloneElement=function(S,U,k){if(S==null)throw Error("The argument must be a React element, but you passed "+S+".");var Z=C({},S.props),F=S.key,fe=void 0;if(U!=null)for(ce in U.ref!==void 0&&(fe=void 0),U.key!==void 0&&(F=""+U.key),U)!ae.call(U,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&U.ref===void 0||(Z[ce]=U[ce]);var ce=arguments.length-2;if(ce===1)Z.children=k;else if(1<ce){for(var Ze=Array(ce),_e=0;_e<ce;_e++)Ze[_e]=arguments[_e+2];Z.children=Ze}return J(S.type,F,void 0,void 0,fe,Z)},de.createContext=function(S){return S={$$typeof:h,_currentValue:S,_currentValue2:S,_threadCount:0,Provider:null,Consumer:null},S.Provider=S,S.Consumer={$$typeof:f,_context:S},S},de.createElement=function(S,U,k){var Z,F={},fe=null;if(U!=null)for(Z in U.key!==void 0&&(fe=""+U.key),U)ae.call(U,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(F[Z]=U[Z]);var ce=arguments.length-2;if(ce===1)F.children=k;else if(1<ce){for(var Ze=Array(ce),_e=0;_e<ce;_e++)Ze[_e]=arguments[_e+2];F.children=Ze}if(S&&S.defaultProps)for(Z in ce=S.defaultProps,ce)F[Z]===void 0&&(F[Z]=ce[Z]);return J(S,fe,void 0,void 0,null,F)},de.createRef=function(){return{current:null}},de.forwardRef=function(S){return{$$typeof:m,render:S}},de.isValidElement=K,de.lazy=function(S){return{$$typeof:b,_payload:{_status:-1,_result:S},_init:L}},de.memo=function(S,U){return{$$typeof:v,type:S,compare:U===void 0?null:U}},de.startTransition=function(S){var U=I.T,k={};I.T=k;try{var Z=S(),F=I.S;F!==null&&F(k,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(Q,X)}catch(fe){X(fe)}finally{I.T=U}},de.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},de.use=function(S){return I.H.use(S)},de.useActionState=function(S,U,k){return I.H.useActionState(S,U,k)},de.useCallback=function(S,U){return I.H.useCallback(S,U)},de.useContext=function(S){return I.H.useContext(S)},de.useDebugValue=function(){},de.useDeferredValue=function(S,U){return I.H.useDeferredValue(S,U)},de.useEffect=function(S,U,k){var Z=I.H;if(typeof k=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Z.useEffect(S,U)},de.useId=function(){return I.H.useId()},de.useImperativeHandle=function(S,U,k){return I.H.useImperativeHandle(S,U,k)},de.useInsertionEffect=function(S,U){return I.H.useInsertionEffect(S,U)},de.useLayoutEffect=function(S,U){return I.H.useLayoutEffect(S,U)},de.useMemo=function(S,U){return I.H.useMemo(S,U)},de.useOptimistic=function(S,U){return I.H.useOptimistic(S,U)},de.useReducer=function(S,U,k){return I.H.useReducer(S,U,k)},de.useRef=function(S){return I.H.useRef(S)},de.useState=function(S){return I.H.useState(S)},de.useSyncExternalStore=function(S,U,k){return I.H.useSyncExternalStore(S,U,k)},de.useTransition=function(){return I.H.useTransition()},de.version="19.1.1",de}var tm;function lu(){return tm||(tm=1,Xr.exports=Fh()),Xr.exports}var ee=lu();const Oe=nu(ee);var Vr={exports:{}},Fl={},kr={exports:{}},Qr={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var am;function ev(){return am||(am=1,function(c){function r(j,L){var X=j.length;j.push(L);e:for(;0<X;){var Q=X-1>>>1,S=j[Q];if(0<d(S,L))j[Q]=L,j[X]=S,X=Q;else break e}}function s(j){return j.length===0?null:j[0]}function u(j){if(j.length===0)return null;var L=j[0],X=j.pop();if(X!==L){j[0]=X;e:for(var Q=0,S=j.length,U=S>>>1;Q<U;){var k=2*(Q+1)-1,Z=j[k],F=k+1,fe=j[F];if(0>d(Z,X))F<S&&0>d(fe,Z)?(j[Q]=fe,j[F]=X,Q=F):(j[Q]=Z,j[k]=X,Q=k);else if(F<S&&0>d(fe,X))j[Q]=fe,j[F]=X,Q=F;else break e}}return L}function d(j,L){var X=j.sortIndex-L.sortIndex;return X!==0?X:j.id-L.id}if(c.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var f=performance;c.unstable_now=function(){return f.now()}}else{var h=Date,m=h.now();c.unstable_now=function(){return h.now()-m}}var g=[],v=[],b=1,x=null,A=3,N=!1,C=!1,E=!1,D=!1,M=typeof setTimeout=="function"?setTimeout:null,B=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;function le(j){for(var L=s(v);L!==null;){if(L.callback===null)u(v);else if(L.startTime<=j)u(v),L.sortIndex=L.expirationTime,r(g,L);else break;L=s(v)}}function I(j){if(E=!1,le(j),!C)if(s(g)!==null)C=!0,ae||(ae=!0,Ee());else{var L=s(v);L!==null&&$(I,L.startTime-j)}}var ae=!1,J=-1,te=5,K=-1;function me(){return D?!0:!(c.unstable_now()-K<te)}function ie(){if(D=!1,ae){var j=c.unstable_now();K=j;var L=!0;try{e:{C=!1,E&&(E=!1,B(J),J=-1),N=!0;var X=A;try{t:{for(le(j),x=s(g);x!==null&&!(x.expirationTime>j&&me());){var Q=x.callback;if(typeof Q=="function"){x.callback=null,A=x.priorityLevel;var S=Q(x.expirationTime<=j);if(j=c.unstable_now(),typeof S=="function"){x.callback=S,le(j),L=!0;break t}x===s(g)&&u(g),le(j)}else u(g);x=s(g)}if(x!==null)L=!0;else{var U=s(v);U!==null&&$(I,U.startTime-j),L=!1}}break e}finally{x=null,A=X,N=!1}L=void 0}}finally{L?Ee():ae=!1}}}var Ee;if(typeof V=="function")Ee=function(){V(ie)};else if(typeof MessageChannel<"u"){var Le=new MessageChannel,w=Le.port2;Le.port1.onmessage=ie,Ee=function(){w.postMessage(null)}}else Ee=function(){M(ie,0)};function $(j,L){J=M(function(){j(c.unstable_now())},L)}c.unstable_IdlePriority=5,c.unstable_ImmediatePriority=1,c.unstable_LowPriority=4,c.unstable_NormalPriority=3,c.unstable_Profiling=null,c.unstable_UserBlockingPriority=2,c.unstable_cancelCallback=function(j){j.callback=null},c.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):te=0<j?Math.floor(1e3/j):5},c.unstable_getCurrentPriorityLevel=function(){return A},c.unstable_next=function(j){switch(A){case 1:case 2:case 3:var L=3;break;default:L=A}var X=A;A=L;try{return j()}finally{A=X}},c.unstable_requestPaint=function(){D=!0},c.unstable_runWithPriority=function(j,L){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var X=A;A=j;try{return L()}finally{A=X}},c.unstable_scheduleCallback=function(j,L,X){var Q=c.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?Q+X:Q):X=Q,j){case 1:var S=-1;break;case 2:S=250;break;case 5:S=1073741823;break;case 4:S=1e4;break;default:S=5e3}return S=X+S,j={id:b++,callback:L,priorityLevel:j,startTime:X,expirationTime:S,sortIndex:-1},X>Q?(j.sortIndex=X,r(v,j),s(g)===null&&j===s(v)&&(E?(B(J),J=-1):E=!0,$(I,X-Q))):(j.sortIndex=S,r(g,j),C||N||(C=!0,ae||(ae=!0,Ee()))),j},c.unstable_shouldYield=me,c.unstable_wrapCallback=function(j){var L=A;return function(){var X=A;A=L;try{return j.apply(this,arguments)}finally{A=X}}}}(Qr)),Qr}var nm;function tv(){return nm||(nm=1,kr.exports=ev()),kr.exports}var Zr={exports:{}},it={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lm;function av(){if(lm)return it;lm=1;var c=lu();function r(g){var v="https://react.dev/errors/"+g;if(1<arguments.length){v+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)v+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+g+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var u={d:{f:s,r:function(){throw Error(r(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},d=Symbol.for("react.portal");function f(g,v,b){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:x==null?null:""+x,children:g,containerInfo:v,implementation:b}}var h=c.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(g,v){if(g==="font")return"";if(typeof v=="string")return v==="use-credentials"?v:""}return it.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=u,it.createPortal=function(g,v){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!v||v.nodeType!==1&&v.nodeType!==9&&v.nodeType!==11)throw Error(r(299));return f(g,v,null,b)},it.flushSync=function(g){var v=h.T,b=u.p;try{if(h.T=null,u.p=2,g)return g()}finally{h.T=v,u.p=b,u.d.f()}},it.preconnect=function(g,v){typeof g=="string"&&(v?(v=v.crossOrigin,v=typeof v=="string"?v==="use-credentials"?v:"":void 0):v=null,u.d.C(g,v))},it.prefetchDNS=function(g){typeof g=="string"&&u.d.D(g)},it.preinit=function(g,v){if(typeof g=="string"&&v&&typeof v.as=="string"){var b=v.as,x=m(b,v.crossOrigin),A=typeof v.integrity=="string"?v.integrity:void 0,N=typeof v.fetchPriority=="string"?v.fetchPriority:void 0;b==="style"?u.d.S(g,typeof v.precedence=="string"?v.precedence:void 0,{crossOrigin:x,integrity:A,fetchPriority:N}):b==="script"&&u.d.X(g,{crossOrigin:x,integrity:A,fetchPriority:N,nonce:typeof v.nonce=="string"?v.nonce:void 0})}},it.preinitModule=function(g,v){if(typeof g=="string")if(typeof v=="object"&&v!==null){if(v.as==null||v.as==="script"){var b=m(v.as,v.crossOrigin);u.d.M(g,{crossOrigin:b,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0})}}else v==null&&u.d.M(g)},it.preload=function(g,v){if(typeof g=="string"&&typeof v=="object"&&v!==null&&typeof v.as=="string"){var b=v.as,x=m(b,v.crossOrigin);u.d.L(g,b,{crossOrigin:x,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0,type:typeof v.type=="string"?v.type:void 0,fetchPriority:typeof v.fetchPriority=="string"?v.fetchPriority:void 0,referrerPolicy:typeof v.referrerPolicy=="string"?v.referrerPolicy:void 0,imageSrcSet:typeof v.imageSrcSet=="string"?v.imageSrcSet:void 0,imageSizes:typeof v.imageSizes=="string"?v.imageSizes:void 0,media:typeof v.media=="string"?v.media:void 0})}},it.preloadModule=function(g,v){if(typeof g=="string")if(v){var b=m(v.as,v.crossOrigin);u.d.m(g,{as:typeof v.as=="string"&&v.as!=="script"?v.as:void 0,crossOrigin:b,integrity:typeof v.integrity=="string"?v.integrity:void 0})}else u.d.m(g)},it.requestFormReset=function(g){u.d.r(g)},it.unstable_batchedUpdates=function(g,v){return g(v)},it.useFormState=function(g,v,b){return h.H.useFormState(g,v,b)},it.useFormStatus=function(){return h.H.useHostTransitionStatus()},it.version="19.1.1",it}var sm;function xm(){if(sm)return Zr.exports;sm=1;function c(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(c)}catch(r){console.error(r)}}return c(),Zr.exports=av(),Zr.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var im;function nv(){if(im)return Fl;im=1;var c=tv(),r=lu(),s=xm();function u(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function f(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(a=t.return),e=t.return;while(e)}return t.tag===3?a:null}function h(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function m(e){if(f(e)!==e)throw Error(u(188))}function g(e){var t=e.alternate;if(!t){if(t=f(e),t===null)throw Error(u(188));return t!==e?null:e}for(var a=e,n=t;;){var l=a.return;if(l===null)break;var o=l.alternate;if(o===null){if(n=l.return,n!==null){a=n;continue}break}if(l.child===o.child){for(o=l.child;o;){if(o===a)return m(l),e;if(o===n)return m(l),t;o=o.sibling}throw Error(u(188))}if(a.return!==n.return)a=l,n=o;else{for(var p=!1,y=l.child;y;){if(y===a){p=!0,a=l,n=o;break}if(y===n){p=!0,n=l,a=o;break}y=y.sibling}if(!p){for(y=o.child;y;){if(y===a){p=!0,a=o,n=l;break}if(y===n){p=!0,n=o,a=l;break}y=y.sibling}if(!p)throw Error(u(189))}}if(a.alternate!==n)throw Error(u(190))}if(a.tag!==3)throw Error(u(188));return a.stateNode.current===a?e:t}function v(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=v(e),t!==null)return t;e=e.sibling}return null}var b=Object.assign,x=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),N=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),B=Symbol.for("react.consumer"),V=Symbol.for("react.context"),le=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),ae=Symbol.for("react.suspense_list"),J=Symbol.for("react.memo"),te=Symbol.for("react.lazy"),K=Symbol.for("react.activity"),me=Symbol.for("react.memo_cache_sentinel"),ie=Symbol.iterator;function Ee(e){return e===null||typeof e!="object"?null:(e=ie&&e[ie]||e["@@iterator"],typeof e=="function"?e:null)}var Le=Symbol.for("react.client.reference");function w(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Le?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case C:return"Fragment";case D:return"Profiler";case E:return"StrictMode";case I:return"Suspense";case ae:return"SuspenseList";case K:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case N:return"Portal";case V:return(e.displayName||"Context")+".Provider";case B:return(e._context.displayName||"Context")+".Consumer";case le:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case J:return t=e.displayName||null,t!==null?t:w(e.type)||"Memo";case te:t=e._payload,e=e._init;try{return w(e(t))}catch{}}return null}var $=Array.isArray,j=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X={pending:!1,data:null,method:null,action:null},Q=[],S=-1;function U(e){return{current:e}}function k(e){0>S||(e.current=Q[S],Q[S]=null,S--)}function Z(e,t){S++,Q[S]=e.current,e.current=t}var F=U(null),fe=U(null),ce=U(null),Ze=U(null);function _e(e,t){switch(Z(ce,t),Z(fe,e),Z(F,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Ef(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Ef(t),e=Af(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}k(F),Z(F,e)}function Vt(){k(F),k(fe),k(ce)}function In(e){e.memoizedState!==null&&Z(Ze,e);var t=F.current,a=Af(t,e.type);t!==a&&(Z(fe,e),Z(F,a))}function rn(e){fe.current===e&&(k(F),k(fe)),Ze.current===e&&(k(Ze),Ql._currentValue=X)}var Wn=Object.prototype.hasOwnProperty,Fn=c.unstable_scheduleCallback,el=c.unstable_cancelCallback,nt=c.unstable_shouldYield,yt=c.unstable_requestPaint,Se=c.unstable_now,ct=c.unstable_getCurrentPriorityLevel,Tt=c.unstable_ImmediatePriority,ss=c.unstable_UserBlockingPriority,is=c.unstable_NormalPriority,Om=c.unstable_LowPriority,iu=c.unstable_IdlePriority,zm=c.log,Hm=c.unstable_setDisableYieldValue,tl=null,bt=null;function va(e){if(typeof zm=="function"&&Hm(e),bt&&typeof bt.setStrictMode=="function")try{bt.setStrictMode(tl,e)}catch{}}var xt=Math.clz32?Math.clz32:Um,qm=Math.log,Bm=Math.LN2;function Um(e){return e>>>=0,e===0?32:31-(qm(e)/Bm|0)|0}var cs=256,rs=4194304;function Ga(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function us(e,t,a){var n=e.pendingLanes;if(n===0)return 0;var l=0,o=e.suspendedLanes,p=e.pingedLanes;e=e.warmLanes;var y=n&134217727;return y!==0?(n=y&~o,n!==0?l=Ga(n):(p&=y,p!==0?l=Ga(p):a||(a=y&~e,a!==0&&(l=Ga(a))))):(y=n&~o,y!==0?l=Ga(y):p!==0?l=Ga(p):a||(a=n&~e,a!==0&&(l=Ga(a)))),l===0?0:t!==0&&t!==l&&(t&o)===0&&(o=l&-l,a=t&-t,o>=a||o===32&&(a&4194048)!==0)?t:l}function al(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function wm(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cu(){var e=cs;return cs<<=1,(cs&4194048)===0&&(cs=256),e}function ru(){var e=rs;return rs<<=1,(rs&62914560)===0&&(rs=4194304),e}function Oi(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function nl(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Lm(e,t,a,n,l,o){var p=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var y=e.entanglements,_=e.expirationTimes,z=e.hiddenUpdates;for(a=p&~a;0<a;){var G=31-xt(a),Y=1<<G;y[G]=0,_[G]=-1;var H=z[G];if(H!==null)for(z[G]=null,G=0;G<H.length;G++){var q=H[G];q!==null&&(q.lane&=-536870913)}a&=~Y}n!==0&&uu(e,n,0),o!==0&&l===0&&e.tag!==0&&(e.suspendedLanes|=o&~(p&~t))}function uu(e,t,a){e.pendingLanes|=t,e.suspendedLanes&=~t;var n=31-xt(t);e.entangledLanes|=t,e.entanglements[n]=e.entanglements[n]|1073741824|a&4194090}function ou(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var n=31-xt(a),l=1<<n;l&t|e[n]&t&&(e[n]|=t),a&=~l}}function zi(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Hi(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function du(){var e=L.p;return e!==0?e:(e=window.event,e===void 0?32:kf(e.type))}function $m(e,t){var a=L.p;try{return L.p=e,t()}finally{L.p=a}}var ga=Math.random().toString(36).slice(2),lt="__reactFiber$"+ga,dt="__reactProps$"+ga,un="__reactContainer$"+ga,qi="__reactEvents$"+ga,Gm="__reactListeners$"+ga,Pm="__reactHandles$"+ga,fu="__reactResources$"+ga,ll="__reactMarker$"+ga;function Bi(e){delete e[lt],delete e[dt],delete e[qi],delete e[Gm],delete e[Pm]}function on(e){var t=e[lt];if(t)return t;for(var a=e.parentNode;a;){if(t=a[un]||a[lt]){if(a=t.alternate,t.child!==null||a!==null&&a.child!==null)for(e=Rf(e);e!==null;){if(a=e[lt])return a;e=Rf(e)}return t}e=a,a=e.parentNode}return null}function dn(e){if(e=e[lt]||e[un]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function sl(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(u(33))}function fn(e){var t=e[fu];return t||(t=e[fu]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ke(e){e[ll]=!0}var mu=new Set,pu={};function Pa(e,t){mn(e,t),mn(e+"Capture",t)}function mn(e,t){for(pu[e]=t,e=0;e<t.length;e++)mu.add(t[e])}var Ym=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),hu={},vu={};function Xm(e){return Wn.call(vu,e)?!0:Wn.call(hu,e)?!1:Ym.test(e)?vu[e]=!0:(hu[e]=!0,!1)}function os(e,t,a){if(Xm(t))if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var n=t.toLowerCase().slice(0,5);if(n!=="data-"&&n!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+a)}}function ds(e,t,a){if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+a)}}function Ft(e,t,a,n){if(n===null)e.removeAttribute(a);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(t,a,""+n)}}var Ui,gu;function pn(e){if(Ui===void 0)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);Ui=t&&t[1]||"",gu=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ui+e+gu}var wi=!1;function Li(e,t){if(!e||wi)return"";wi=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var n={DetermineComponentFrameRoot:function(){try{if(t){var Y=function(){throw Error()};if(Object.defineProperty(Y.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Y,[])}catch(q){var H=q}Reflect.construct(e,[],Y)}else{try{Y.call()}catch(q){H=q}e.call(Y.prototype)}}else{try{throw Error()}catch(q){H=q}(Y=e())&&typeof Y.catch=="function"&&Y.catch(function(){})}}catch(q){if(q&&H&&typeof q.stack=="string")return[q.stack,H.stack]}return[null,null]}};n.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var l=Object.getOwnPropertyDescriptor(n.DetermineComponentFrameRoot,"name");l&&l.configurable&&Object.defineProperty(n.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=n.DetermineComponentFrameRoot(),p=o[0],y=o[1];if(p&&y){var _=p.split(`
`),z=y.split(`
`);for(l=n=0;n<_.length&&!_[n].includes("DetermineComponentFrameRoot");)n++;for(;l<z.length&&!z[l].includes("DetermineComponentFrameRoot");)l++;if(n===_.length||l===z.length)for(n=_.length-1,l=z.length-1;1<=n&&0<=l&&_[n]!==z[l];)l--;for(;1<=n&&0<=l;n--,l--)if(_[n]!==z[l]){if(n!==1||l!==1)do if(n--,l--,0>l||_[n]!==z[l]){var G=`
`+_[n].replace(" at new "," at ");return e.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",e.displayName)),G}while(1<=n&&0<=l);break}}}finally{wi=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?pn(a):""}function Vm(e){switch(e.tag){case 26:case 27:case 5:return pn(e.type);case 16:return pn("Lazy");case 13:return pn("Suspense");case 19:return pn("SuspenseList");case 0:case 15:return Li(e.type,!1);case 11:return Li(e.type.render,!1);case 1:return Li(e.type,!0);case 31:return pn("Activity");default:return""}}function yu(e){try{var t="";do t+=Vm(e),e=e.return;while(e);return t}catch(a){return`
Error generating stack: `+a.message+`
`+a.stack}}function Mt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function bu(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function km(e){var t=bu(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var l=a.get,o=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(p){n=""+p,o.call(this,p)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return n},setValue:function(p){n=""+p},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function fs(e){e._valueTracker||(e._valueTracker=km(e))}function xu(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),n="";return e&&(n=bu(e)?e.checked?"true":"false":e.value),e=n,e!==a?(t.setValue(e),!0):!1}function ms(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Qm=/[\n"\\]/g;function Dt(e){return e.replace(Qm,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function $i(e,t,a,n,l,o,p,y){e.name="",p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"?e.type=p:e.removeAttribute("type"),t!=null?p==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Mt(t)):e.value!==""+Mt(t)&&(e.value=""+Mt(t)):p!=="submit"&&p!=="reset"||e.removeAttribute("value"),t!=null?Gi(e,p,Mt(t)):a!=null?Gi(e,p,Mt(a)):n!=null&&e.removeAttribute("value"),l==null&&o!=null&&(e.defaultChecked=!!o),l!=null&&(e.checked=l&&typeof l!="function"&&typeof l!="symbol"),y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.name=""+Mt(y):e.removeAttribute("name")}function Su(e,t,a,n,l,o,p,y){if(o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"&&(e.type=o),t!=null||a!=null){if(!(o!=="submit"&&o!=="reset"||t!=null))return;a=a!=null?""+Mt(a):"",t=t!=null?""+Mt(t):a,y||t===e.value||(e.value=t),e.defaultValue=t}n=n??l,n=typeof n!="function"&&typeof n!="symbol"&&!!n,e.checked=y?e.checked:!!n,e.defaultChecked=!!n,p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(e.name=p)}function Gi(e,t,a){t==="number"&&ms(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function hn(e,t,a,n){if(e=e.options,t){t={};for(var l=0;l<a.length;l++)t["$"+a[l]]=!0;for(a=0;a<e.length;a++)l=t.hasOwnProperty("$"+e[a].value),e[a].selected!==l&&(e[a].selected=l),l&&n&&(e[a].defaultSelected=!0)}else{for(a=""+Mt(a),t=null,l=0;l<e.length;l++){if(e[l].value===a){e[l].selected=!0,n&&(e[l].defaultSelected=!0);return}t!==null||e[l].disabled||(t=e[l])}t!==null&&(t.selected=!0)}}function ju(e,t,a){if(t!=null&&(t=""+Mt(t),t!==e.value&&(e.value=t),a==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=a!=null?""+Mt(a):""}function _u(e,t,a,n){if(t==null){if(n!=null){if(a!=null)throw Error(u(92));if($(n)){if(1<n.length)throw Error(u(93));n=n[0]}a=n}a==null&&(a=""),t=a}a=Mt(t),e.defaultValue=a,n=e.textContent,n===a&&n!==""&&n!==null&&(e.value=n)}function vn(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=t;return}}e.textContent=t}var Zm=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Nu(e,t,a){var n=t.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?n?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":n?e.setProperty(t,a):typeof a!="number"||a===0||Zm.has(t)?t==="float"?e.cssFloat=a:e[t]=(""+a).trim():e[t]=a+"px"}function Cu(e,t,a){if(t!=null&&typeof t!="object")throw Error(u(62));if(e=e.style,a!=null){for(var n in a)!a.hasOwnProperty(n)||t!=null&&t.hasOwnProperty(n)||(n.indexOf("--")===0?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="");for(var l in t)n=t[l],t.hasOwnProperty(l)&&a[l]!==n&&Nu(e,l,n)}else for(var o in t)t.hasOwnProperty(o)&&Nu(e,o,t[o])}function Pi(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Km=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Jm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ps(e){return Jm.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Yi=null;function Xi(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var gn=null,yn=null;function Eu(e){var t=dn(e);if(t&&(e=t.stateNode)){var a=e[dt]||null;e:switch(e=t.stateNode,t.type){case"input":if($i(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),t=a.name,a.type==="radio"&&t!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Dt(""+t)+'"][type="radio"]'),t=0;t<a.length;t++){var n=a[t];if(n!==e&&n.form===e.form){var l=n[dt]||null;if(!l)throw Error(u(90));$i(n,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name)}}for(t=0;t<a.length;t++)n=a[t],n.form===e.form&&xu(n)}break e;case"textarea":ju(e,a.value,a.defaultValue);break e;case"select":t=a.value,t!=null&&hn(e,!!a.multiple,t,!1)}}}var Vi=!1;function Au(e,t,a){if(Vi)return e(t,a);Vi=!0;try{var n=e(t);return n}finally{if(Vi=!1,(gn!==null||yn!==null)&&(Fs(),gn&&(t=gn,e=yn,yn=gn=null,Eu(t),e)))for(t=0;t<e.length;t++)Eu(e[t])}}function il(e,t){var a=e.stateNode;if(a===null)return null;var n=a[dt]||null;if(n===null)return null;a=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(u(231,t,typeof a));return a}var ea=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ki=!1;if(ea)try{var cl={};Object.defineProperty(cl,"passive",{get:function(){ki=!0}}),window.addEventListener("test",cl,cl),window.removeEventListener("test",cl,cl)}catch{ki=!1}var ya=null,Qi=null,hs=null;function Tu(){if(hs)return hs;var e,t=Qi,a=t.length,n,l="value"in ya?ya.value:ya.textContent,o=l.length;for(e=0;e<a&&t[e]===l[e];e++);var p=a-e;for(n=1;n<=p&&t[a-n]===l[o-n];n++);return hs=l.slice(e,1<n?1-n:void 0)}function vs(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function gs(){return!0}function Mu(){return!1}function ft(e){function t(a,n,l,o,p){this._reactName=a,this._targetInst=l,this.type=n,this.nativeEvent=o,this.target=p,this.currentTarget=null;for(var y in e)e.hasOwnProperty(y)&&(a=e[y],this[y]=a?a(o):o[y]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?gs:Mu,this.isPropagationStopped=Mu,this}return b(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=gs)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=gs)},persist:function(){},isPersistent:gs}),t}var Ya={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ys=ft(Ya),rl=b({},Ya,{view:0,detail:0}),Im=ft(rl),Zi,Ki,ul,bs=b({},rl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ii,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ul&&(ul&&e.type==="mousemove"?(Zi=e.screenX-ul.screenX,Ki=e.screenY-ul.screenY):Ki=Zi=0,ul=e),Zi)},movementY:function(e){return"movementY"in e?e.movementY:Ki}}),Du=ft(bs),Wm=b({},bs,{dataTransfer:0}),Fm=ft(Wm),ep=b({},rl,{relatedTarget:0}),Ji=ft(ep),tp=b({},Ya,{animationName:0,elapsedTime:0,pseudoElement:0}),ap=ft(tp),np=b({},Ya,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),lp=ft(np),sp=b({},Ya,{data:0}),Ru=ft(sp),ip={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function up(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=rp[e])?!!t[e]:!1}function Ii(){return up}var op=b({},rl,{key:function(e){if(e.key){var t=ip[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=vs(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?cp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ii,charCode:function(e){return e.type==="keypress"?vs(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?vs(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),dp=ft(op),fp=b({},bs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ou=ft(fp),mp=b({},rl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ii}),pp=ft(mp),hp=b({},Ya,{propertyName:0,elapsedTime:0,pseudoElement:0}),vp=ft(hp),gp=b({},bs,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),yp=ft(gp),bp=b({},Ya,{newState:0,oldState:0}),xp=ft(bp),Sp=[9,13,27,32],Wi=ea&&"CompositionEvent"in window,ol=null;ea&&"documentMode"in document&&(ol=document.documentMode);var jp=ea&&"TextEvent"in window&&!ol,zu=ea&&(!Wi||ol&&8<ol&&11>=ol),Hu=" ",qu=!1;function Bu(e,t){switch(e){case"keyup":return Sp.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Uu(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var bn=!1;function _p(e,t){switch(e){case"compositionend":return Uu(t);case"keypress":return t.which!==32?null:(qu=!0,Hu);case"textInput":return e=t.data,e===Hu&&qu?null:e;default:return null}}function Np(e,t){if(bn)return e==="compositionend"||!Wi&&Bu(e,t)?(e=Tu(),hs=Qi=ya=null,bn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return zu&&t.locale!=="ko"?null:t.data;default:return null}}var Cp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Cp[e.type]:t==="textarea"}function Lu(e,t,a,n){gn?yn?yn.push(n):yn=[n]:gn=n,t=si(t,"onChange"),0<t.length&&(a=new ys("onChange","change",null,a,n),e.push({event:a,listeners:t}))}var dl=null,fl=null;function Ep(e){Sf(e,0)}function xs(e){var t=sl(e);if(xu(t))return e}function $u(e,t){if(e==="change")return t}var Gu=!1;if(ea){var Fi;if(ea){var ec="oninput"in document;if(!ec){var Pu=document.createElement("div");Pu.setAttribute("oninput","return;"),ec=typeof Pu.oninput=="function"}Fi=ec}else Fi=!1;Gu=Fi&&(!document.documentMode||9<document.documentMode)}function Yu(){dl&&(dl.detachEvent("onpropertychange",Xu),fl=dl=null)}function Xu(e){if(e.propertyName==="value"&&xs(fl)){var t=[];Lu(t,fl,e,Xi(e)),Au(Ep,t)}}function Ap(e,t,a){e==="focusin"?(Yu(),dl=t,fl=a,dl.attachEvent("onpropertychange",Xu)):e==="focusout"&&Yu()}function Tp(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return xs(fl)}function Mp(e,t){if(e==="click")return xs(t)}function Dp(e,t){if(e==="input"||e==="change")return xs(t)}function Rp(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var St=typeof Object.is=="function"?Object.is:Rp;function ml(e,t){if(St(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var a=Object.keys(e),n=Object.keys(t);if(a.length!==n.length)return!1;for(n=0;n<a.length;n++){var l=a[n];if(!Wn.call(t,l)||!St(e[l],t[l]))return!1}return!0}function Vu(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ku(e,t){var a=Vu(e);e=0;for(var n;a;){if(a.nodeType===3){if(n=e+a.textContent.length,e<=t&&n>=t)return{node:a,offset:t-e};e=n}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Vu(a)}}function Qu(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Qu(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Zu(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=ms(e.document);t instanceof e.HTMLIFrameElement;){try{var a=typeof t.contentWindow.location.href=="string"}catch{a=!1}if(a)e=t.contentWindow;else break;t=ms(e.document)}return t}function tc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Op=ea&&"documentMode"in document&&11>=document.documentMode,xn=null,ac=null,pl=null,nc=!1;function Ku(e,t,a){var n=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;nc||xn==null||xn!==ms(n)||(n=xn,"selectionStart"in n&&tc(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),pl&&ml(pl,n)||(pl=n,n=si(ac,"onSelect"),0<n.length&&(t=new ys("onSelect","select",null,t,a),e.push({event:t,listeners:n}),t.target=xn)))}function Xa(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var Sn={animationend:Xa("Animation","AnimationEnd"),animationiteration:Xa("Animation","AnimationIteration"),animationstart:Xa("Animation","AnimationStart"),transitionrun:Xa("Transition","TransitionRun"),transitionstart:Xa("Transition","TransitionStart"),transitioncancel:Xa("Transition","TransitionCancel"),transitionend:Xa("Transition","TransitionEnd")},lc={},Ju={};ea&&(Ju=document.createElement("div").style,"AnimationEvent"in window||(delete Sn.animationend.animation,delete Sn.animationiteration.animation,delete Sn.animationstart.animation),"TransitionEvent"in window||delete Sn.transitionend.transition);function Va(e){if(lc[e])return lc[e];if(!Sn[e])return e;var t=Sn[e],a;for(a in t)if(t.hasOwnProperty(a)&&a in Ju)return lc[e]=t[a];return e}var Iu=Va("animationend"),Wu=Va("animationiteration"),Fu=Va("animationstart"),zp=Va("transitionrun"),Hp=Va("transitionstart"),qp=Va("transitioncancel"),eo=Va("transitionend"),to=new Map,sc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");sc.push("scrollEnd");function Pt(e,t){to.set(e,t),Pa(t,[e])}var ao=new WeakMap;function Rt(e,t){if(typeof e=="object"&&e!==null){var a=ao.get(e);return a!==void 0?a:(t={value:e,source:t,stack:yu(t)},ao.set(e,t),t)}return{value:e,source:t,stack:yu(t)}}var Ot=[],jn=0,ic=0;function Ss(){for(var e=jn,t=ic=jn=0;t<e;){var a=Ot[t];Ot[t++]=null;var n=Ot[t];Ot[t++]=null;var l=Ot[t];Ot[t++]=null;var o=Ot[t];if(Ot[t++]=null,n!==null&&l!==null){var p=n.pending;p===null?l.next=l:(l.next=p.next,p.next=l),n.pending=l}o!==0&&no(a,l,o)}}function js(e,t,a,n){Ot[jn++]=e,Ot[jn++]=t,Ot[jn++]=a,Ot[jn++]=n,ic|=n,e.lanes|=n,e=e.alternate,e!==null&&(e.lanes|=n)}function cc(e,t,a,n){return js(e,t,a,n),_s(e)}function _n(e,t){return js(e,null,null,t),_s(e)}function no(e,t,a){e.lanes|=a;var n=e.alternate;n!==null&&(n.lanes|=a);for(var l=!1,o=e.return;o!==null;)o.childLanes|=a,n=o.alternate,n!==null&&(n.childLanes|=a),o.tag===22&&(e=o.stateNode,e===null||e._visibility&1||(l=!0)),e=o,o=o.return;return e.tag===3?(o=e.stateNode,l&&t!==null&&(l=31-xt(a),e=o.hiddenUpdates,n=e[l],n===null?e[l]=[t]:n.push(t),t.lane=a|536870912),o):null}function _s(e){if(50<Ll)throw Ll=0,mr=null,Error(u(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Nn={};function Bp(e,t,a,n){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jt(e,t,a,n){return new Bp(e,t,a,n)}function rc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ta(e,t){var a=e.alternate;return a===null?(a=jt(e.tag,t,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function lo(e,t){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,t=a.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ns(e,t,a,n,l,o){var p=0;if(n=e,typeof e=="function")rc(e)&&(p=1);else if(typeof e=="string")p=wh(e,a,F.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case K:return e=jt(31,a,t,l),e.elementType=K,e.lanes=o,e;case C:return ka(a.children,l,o,t);case E:p=8,l|=24;break;case D:return e=jt(12,a,t,l|2),e.elementType=D,e.lanes=o,e;case I:return e=jt(13,a,t,l),e.elementType=I,e.lanes=o,e;case ae:return e=jt(19,a,t,l),e.elementType=ae,e.lanes=o,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case M:case V:p=10;break e;case B:p=9;break e;case le:p=11;break e;case J:p=14;break e;case te:p=16,n=null;break e}p=29,a=Error(u(130,e===null?"null":typeof e,"")),n=null}return t=jt(p,a,t,l),t.elementType=e,t.type=n,t.lanes=o,t}function ka(e,t,a,n){return e=jt(7,e,n,t),e.lanes=a,e}function uc(e,t,a){return e=jt(6,e,null,t),e.lanes=a,e}function oc(e,t,a){return t=jt(4,e.children!==null?e.children:[],e.key,t),t.lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Cn=[],En=0,Cs=null,Es=0,zt=[],Ht=0,Qa=null,aa=1,na="";function Za(e,t){Cn[En++]=Es,Cn[En++]=Cs,Cs=e,Es=t}function so(e,t,a){zt[Ht++]=aa,zt[Ht++]=na,zt[Ht++]=Qa,Qa=e;var n=aa;e=na;var l=32-xt(n)-1;n&=~(1<<l),a+=1;var o=32-xt(t)+l;if(30<o){var p=l-l%5;o=(n&(1<<p)-1).toString(32),n>>=p,l-=p,aa=1<<32-xt(t)+l|a<<l|n,na=o+e}else aa=1<<o|a<<l|n,na=e}function dc(e){e.return!==null&&(Za(e,1),so(e,1,0))}function fc(e){for(;e===Cs;)Cs=Cn[--En],Cn[En]=null,Es=Cn[--En],Cn[En]=null;for(;e===Qa;)Qa=zt[--Ht],zt[Ht]=null,na=zt[--Ht],zt[Ht]=null,aa=zt[--Ht],zt[Ht]=null}var rt=null,Ue=null,je=!1,Ka=null,kt=!1,mc=Error(u(519));function Ja(e){var t=Error(u(418,""));throw gl(Rt(t,e)),mc}function io(e){var t=e.stateNode,a=e.type,n=e.memoizedProps;switch(t[lt]=e,t[dt]=n,a){case"dialog":ge("cancel",t),ge("close",t);break;case"iframe":case"object":case"embed":ge("load",t);break;case"video":case"audio":for(a=0;a<Gl.length;a++)ge(Gl[a],t);break;case"source":ge("error",t);break;case"img":case"image":case"link":ge("error",t),ge("load",t);break;case"details":ge("toggle",t);break;case"input":ge("invalid",t),Su(t,n.value,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name,!0),fs(t);break;case"select":ge("invalid",t);break;case"textarea":ge("invalid",t),_u(t,n.value,n.defaultValue,n.children),fs(t)}a=n.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||t.textContent===""+a||n.suppressHydrationWarning===!0||Cf(t.textContent,a)?(n.popover!=null&&(ge("beforetoggle",t),ge("toggle",t)),n.onScroll!=null&&ge("scroll",t),n.onScrollEnd!=null&&ge("scrollend",t),n.onClick!=null&&(t.onclick=ii),t=!0):t=!1,t||Ja(e)}function co(e){for(rt=e.return;rt;)switch(rt.tag){case 5:case 13:kt=!1;return;case 27:case 3:kt=!0;return;default:rt=rt.return}}function hl(e){if(e!==rt)return!1;if(!je)return co(e),je=!0,!1;var t=e.tag,a;if((a=t!==3&&t!==27)&&((a=t===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||Mr(e.type,e.memoizedProps)),a=!a),a&&Ue&&Ja(e),co(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(u(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(a=e.data,a==="/$"){if(t===0){Ue=Xt(e.nextSibling);break e}t--}else a!=="$"&&a!=="$!"&&a!=="$?"||t++;e=e.nextSibling}Ue=null}}else t===27?(t=Ue,Ha(e.type)?(e=zr,zr=null,Ue=e):Ue=t):Ue=rt?Xt(e.stateNode.nextSibling):null;return!0}function vl(){Ue=rt=null,je=!1}function ro(){var e=Ka;return e!==null&&(ht===null?ht=e:ht.push.apply(ht,e),Ka=null),e}function gl(e){Ka===null?Ka=[e]:Ka.push(e)}var pc=U(null),Ia=null,la=null;function ba(e,t,a){Z(pc,t._currentValue),t._currentValue=a}function sa(e){e._currentValue=pc.current,k(pc)}function hc(e,t,a){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===a)break;e=e.return}}function vc(e,t,a,n){var l=e.child;for(l!==null&&(l.return=e);l!==null;){var o=l.dependencies;if(o!==null){var p=l.child;o=o.firstContext;e:for(;o!==null;){var y=o;o=l;for(var _=0;_<t.length;_++)if(y.context===t[_]){o.lanes|=a,y=o.alternate,y!==null&&(y.lanes|=a),hc(o.return,a,e),n||(p=null);break e}o=y.next}}else if(l.tag===18){if(p=l.return,p===null)throw Error(u(341));p.lanes|=a,o=p.alternate,o!==null&&(o.lanes|=a),hc(p,a,e),p=null}else p=l.child;if(p!==null)p.return=l;else for(p=l;p!==null;){if(p===e){p=null;break}if(l=p.sibling,l!==null){l.return=p.return,p=l;break}p=p.return}l=p}}function yl(e,t,a,n){e=null;for(var l=t,o=!1;l!==null;){if(!o){if((l.flags&524288)!==0)o=!0;else if((l.flags&262144)!==0)break}if(l.tag===10){var p=l.alternate;if(p===null)throw Error(u(387));if(p=p.memoizedProps,p!==null){var y=l.type;St(l.pendingProps.value,p.value)||(e!==null?e.push(y):e=[y])}}else if(l===Ze.current){if(p=l.alternate,p===null)throw Error(u(387));p.memoizedState.memoizedState!==l.memoizedState.memoizedState&&(e!==null?e.push(Ql):e=[Ql])}l=l.return}e!==null&&vc(t,e,a,n),t.flags|=262144}function As(e){for(e=e.firstContext;e!==null;){if(!St(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Wa(e){Ia=e,la=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function st(e){return uo(Ia,e)}function Ts(e,t){return Ia===null&&Wa(e),uo(e,t)}function uo(e,t){var a=t._currentValue;if(t={context:t,memoizedValue:a,next:null},la===null){if(e===null)throw Error(u(308));la=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else la=la.next=t;return a}var Up=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(a,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(a){return a()})}},wp=c.unstable_scheduleCallback,Lp=c.unstable_NormalPriority,Ve={$$typeof:V,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function gc(){return{controller:new Up,data:new Map,refCount:0}}function bl(e){e.refCount--,e.refCount===0&&wp(Lp,function(){e.controller.abort()})}var xl=null,yc=0,An=0,Tn=null;function $p(e,t){if(xl===null){var a=xl=[];yc=0,An=xr(),Tn={status:"pending",value:void 0,then:function(n){a.push(n)}}}return yc++,t.then(oo,oo),t}function oo(){if(--yc===0&&xl!==null){Tn!==null&&(Tn.status="fulfilled");var e=xl;xl=null,An=0,Tn=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Gp(e,t){var a=[],n={status:"pending",value:null,reason:null,then:function(l){a.push(l)}};return e.then(function(){n.status="fulfilled",n.value=t;for(var l=0;l<a.length;l++)(0,a[l])(t)},function(l){for(n.status="rejected",n.reason=l,l=0;l<a.length;l++)(0,a[l])(void 0)}),n}var fo=j.S;j.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&$p(e,t),fo!==null&&fo(e,t)};var Fa=U(null);function bc(){var e=Fa.current;return e!==null?e:Re.pooledCache}function Ms(e,t){t===null?Z(Fa,Fa.current):Z(Fa,t.pool)}function mo(){var e=bc();return e===null?null:{parent:Ve._currentValue,pool:e}}var Sl=Error(u(460)),po=Error(u(474)),Ds=Error(u(542)),xc={then:function(){}};function ho(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Rs(){}function vo(e,t,a){switch(a=e[a],a===void 0?e.push(t):a!==t&&(t.then(Rs,Rs),t=a),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,yo(e),e;default:if(typeof t.status=="string")t.then(Rs,Rs);else{if(e=Re,e!==null&&100<e.shellSuspendCounter)throw Error(u(482));e=t,e.status="pending",e.then(function(n){if(t.status==="pending"){var l=t;l.status="fulfilled",l.value=n}},function(n){if(t.status==="pending"){var l=t;l.status="rejected",l.reason=n}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,yo(e),e}throw jl=t,Sl}}var jl=null;function go(){if(jl===null)throw Error(u(459));var e=jl;return jl=null,e}function yo(e){if(e===Sl||e===Ds)throw Error(u(483))}var xa=!1;function Sc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function jc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Sa(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ja(e,t,a){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,(Ne&2)!==0){var l=n.pending;return l===null?t.next=t:(t.next=l.next,l.next=t),n.pending=t,t=_s(e),no(e,null,a),t}return js(e,n,t,a),_s(e)}function _l(e,t,a){if(t=t.updateQueue,t!==null&&(t=t.shared,(a&4194048)!==0)){var n=t.lanes;n&=e.pendingLanes,a|=n,t.lanes=a,ou(e,a)}}function _c(e,t){var a=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,a===n)){var l=null,o=null;if(a=a.firstBaseUpdate,a!==null){do{var p={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};o===null?l=o=p:o=o.next=p,a=a.next}while(a!==null);o===null?l=o=t:o=o.next=t}else l=o=t;a={baseState:n.baseState,firstBaseUpdate:l,lastBaseUpdate:o,shared:n.shared,callbacks:n.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}var Nc=!1;function Nl(){if(Nc){var e=Tn;if(e!==null)throw e}}function Cl(e,t,a,n){Nc=!1;var l=e.updateQueue;xa=!1;var o=l.firstBaseUpdate,p=l.lastBaseUpdate,y=l.shared.pending;if(y!==null){l.shared.pending=null;var _=y,z=_.next;_.next=null,p===null?o=z:p.next=z,p=_;var G=e.alternate;G!==null&&(G=G.updateQueue,y=G.lastBaseUpdate,y!==p&&(y===null?G.firstBaseUpdate=z:y.next=z,G.lastBaseUpdate=_))}if(o!==null){var Y=l.baseState;p=0,G=z=_=null,y=o;do{var H=y.lane&-536870913,q=H!==y.lane;if(q?(ye&H)===H:(n&H)===H){H!==0&&H===An&&(Nc=!0),G!==null&&(G=G.next={lane:0,tag:y.tag,payload:y.payload,callback:null,next:null});e:{var oe=e,re=y;H=t;var Me=a;switch(re.tag){case 1:if(oe=re.payload,typeof oe=="function"){Y=oe.call(Me,Y,H);break e}Y=oe;break e;case 3:oe.flags=oe.flags&-65537|128;case 0:if(oe=re.payload,H=typeof oe=="function"?oe.call(Me,Y,H):oe,H==null)break e;Y=b({},Y,H);break e;case 2:xa=!0}}H=y.callback,H!==null&&(e.flags|=64,q&&(e.flags|=8192),q=l.callbacks,q===null?l.callbacks=[H]:q.push(H))}else q={lane:H,tag:y.tag,payload:y.payload,callback:y.callback,next:null},G===null?(z=G=q,_=Y):G=G.next=q,p|=H;if(y=y.next,y===null){if(y=l.shared.pending,y===null)break;q=y,y=q.next,q.next=null,l.lastBaseUpdate=q,l.shared.pending=null}}while(!0);G===null&&(_=Y),l.baseState=_,l.firstBaseUpdate=z,l.lastBaseUpdate=G,o===null&&(l.shared.lanes=0),Da|=p,e.lanes=p,e.memoizedState=Y}}function bo(e,t){if(typeof e!="function")throw Error(u(191,e));e.call(t)}function xo(e,t){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)bo(a[e],t)}var Mn=U(null),Os=U(0);function So(e,t){e=fa,Z(Os,e),Z(Mn,t),fa=e|t.baseLanes}function Cc(){Z(Os,fa),Z(Mn,Mn.current)}function Ec(){fa=Os.current,k(Mn),k(Os)}var _a=0,pe=null,Ae=null,Pe=null,zs=!1,Dn=!1,en=!1,Hs=0,El=0,Rn=null,Pp=0;function $e(){throw Error(u(321))}function Ac(e,t){if(t===null)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!St(e[a],t[a]))return!1;return!0}function Tc(e,t,a,n,l,o){return _a=o,pe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,j.H=e===null||e.memoizedState===null?ld:sd,en=!1,o=a(n,l),en=!1,Dn&&(o=_o(t,a,n,l)),jo(e),o}function jo(e){j.H=$s;var t=Ae!==null&&Ae.next!==null;if(_a=0,Pe=Ae=pe=null,zs=!1,El=0,Rn=null,t)throw Error(u(300));e===null||Je||(e=e.dependencies,e!==null&&As(e)&&(Je=!0))}function _o(e,t,a,n){pe=e;var l=0;do{if(Dn&&(Rn=null),El=0,Dn=!1,25<=l)throw Error(u(301));if(l+=1,Pe=Ae=null,e.updateQueue!=null){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,o.memoCache!=null&&(o.memoCache.index=0)}j.H=Kp,o=t(a,n)}while(Dn);return o}function Yp(){var e=j.H,t=e.useState()[0];return t=typeof t.then=="function"?Al(t):t,e=e.useState()[0],(Ae!==null?Ae.memoizedState:null)!==e&&(pe.flags|=1024),t}function Mc(){var e=Hs!==0;return Hs=0,e}function Dc(e,t,a){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a}function Rc(e){if(zs){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}zs=!1}_a=0,Pe=Ae=pe=null,Dn=!1,El=Hs=0,Rn=null}function mt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pe===null?pe.memoizedState=Pe=e:Pe=Pe.next=e,Pe}function Ye(){if(Ae===null){var e=pe.alternate;e=e!==null?e.memoizedState:null}else e=Ae.next;var t=Pe===null?pe.memoizedState:Pe.next;if(t!==null)Pe=t,Ae=e;else{if(e===null)throw pe.alternate===null?Error(u(467)):Error(u(310));Ae=e,e={memoizedState:Ae.memoizedState,baseState:Ae.baseState,baseQueue:Ae.baseQueue,queue:Ae.queue,next:null},Pe===null?pe.memoizedState=Pe=e:Pe=Pe.next=e}return Pe}function Oc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Al(e){var t=El;return El+=1,Rn===null&&(Rn=[]),e=vo(Rn,e,t),t=pe,(Pe===null?t.memoizedState:Pe.next)===null&&(t=t.alternate,j.H=t===null||t.memoizedState===null?ld:sd),e}function qs(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Al(e);if(e.$$typeof===V)return st(e)}throw Error(u(438,String(e)))}function zc(e){var t=null,a=pe.updateQueue;if(a!==null&&(t=a.memoCache),t==null){var n=pe.alternate;n!==null&&(n=n.updateQueue,n!==null&&(n=n.memoCache,n!=null&&(t={data:n.data.map(function(l){return l.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),a===null&&(a=Oc(),pe.updateQueue=a),a.memoCache=t,a=t.data[t.index],a===void 0)for(a=t.data[t.index]=Array(e),n=0;n<e;n++)a[n]=me;return t.index++,a}function ia(e,t){return typeof t=="function"?t(e):t}function Bs(e){var t=Ye();return Hc(t,Ae,e)}function Hc(e,t,a){var n=e.queue;if(n===null)throw Error(u(311));n.lastRenderedReducer=a;var l=e.baseQueue,o=n.pending;if(o!==null){if(l!==null){var p=l.next;l.next=o.next,o.next=p}t.baseQueue=l=o,n.pending=null}if(o=e.baseState,l===null)e.memoizedState=o;else{t=l.next;var y=p=null,_=null,z=t,G=!1;do{var Y=z.lane&-536870913;if(Y!==z.lane?(ye&Y)===Y:(_a&Y)===Y){var H=z.revertLane;if(H===0)_!==null&&(_=_.next={lane:0,revertLane:0,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null}),Y===An&&(G=!0);else if((_a&H)===H){z=z.next,H===An&&(G=!0);continue}else Y={lane:0,revertLane:z.revertLane,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null},_===null?(y=_=Y,p=o):_=_.next=Y,pe.lanes|=H,Da|=H;Y=z.action,en&&a(o,Y),o=z.hasEagerState?z.eagerState:a(o,Y)}else H={lane:Y,revertLane:z.revertLane,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null},_===null?(y=_=H,p=o):_=_.next=H,pe.lanes|=Y,Da|=Y;z=z.next}while(z!==null&&z!==t);if(_===null?p=o:_.next=y,!St(o,e.memoizedState)&&(Je=!0,G&&(a=Tn,a!==null)))throw a;e.memoizedState=o,e.baseState=p,e.baseQueue=_,n.lastRenderedState=o}return l===null&&(n.lanes=0),[e.memoizedState,n.dispatch]}function qc(e){var t=Ye(),a=t.queue;if(a===null)throw Error(u(311));a.lastRenderedReducer=e;var n=a.dispatch,l=a.pending,o=t.memoizedState;if(l!==null){a.pending=null;var p=l=l.next;do o=e(o,p.action),p=p.next;while(p!==l);St(o,t.memoizedState)||(Je=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),a.lastRenderedState=o}return[o,n]}function No(e,t,a){var n=pe,l=Ye(),o=je;if(o){if(a===void 0)throw Error(u(407));a=a()}else a=t();var p=!St((Ae||l).memoizedState,a);p&&(l.memoizedState=a,Je=!0),l=l.queue;var y=Ao.bind(null,n,l,e);if(Tl(2048,8,y,[e]),l.getSnapshot!==t||p||Pe!==null&&Pe.memoizedState.tag&1){if(n.flags|=2048,On(9,Us(),Eo.bind(null,n,l,a,t),null),Re===null)throw Error(u(349));o||(_a&124)!==0||Co(n,t,a)}return a}function Co(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},t=pe.updateQueue,t===null?(t=Oc(),pe.updateQueue=t,t.stores=[e]):(a=t.stores,a===null?t.stores=[e]:a.push(e))}function Eo(e,t,a,n){t.value=a,t.getSnapshot=n,To(t)&&Mo(e)}function Ao(e,t,a){return a(function(){To(t)&&Mo(e)})}function To(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!St(e,a)}catch{return!0}}function Mo(e){var t=_n(e,2);t!==null&&At(t,e,2)}function Bc(e){var t=mt();if(typeof e=="function"){var a=e;if(e=a(),en){va(!0);try{a()}finally{va(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ia,lastRenderedState:e},t}function Do(e,t,a,n){return e.baseState=a,Hc(e,Ae,typeof n=="function"?n:ia)}function Xp(e,t,a,n,l){if(Ls(e))throw Error(u(485));if(e=t.action,e!==null){var o={payload:l,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(p){o.listeners.push(p)}};j.T!==null?a(!0):o.isTransition=!1,n(o),a=t.pending,a===null?(o.next=t.pending=o,Ro(t,o)):(o.next=a.next,t.pending=a.next=o)}}function Ro(e,t){var a=t.action,n=t.payload,l=e.state;if(t.isTransition){var o=j.T,p={};j.T=p;try{var y=a(l,n),_=j.S;_!==null&&_(p,y),Oo(e,t,y)}catch(z){Uc(e,t,z)}finally{j.T=o}}else try{o=a(l,n),Oo(e,t,o)}catch(z){Uc(e,t,z)}}function Oo(e,t,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(n){zo(e,t,n)},function(n){return Uc(e,t,n)}):zo(e,t,a)}function zo(e,t,a){t.status="fulfilled",t.value=a,Ho(t),e.state=a,t=e.pending,t!==null&&(a=t.next,a===t?e.pending=null:(a=a.next,t.next=a,Ro(e,a)))}function Uc(e,t,a){var n=e.pending;if(e.pending=null,n!==null){n=n.next;do t.status="rejected",t.reason=a,Ho(t),t=t.next;while(t!==n)}e.action=null}function Ho(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function qo(e,t){return t}function Bo(e,t){if(je){var a=Re.formState;if(a!==null){e:{var n=pe;if(je){if(Ue){t:{for(var l=Ue,o=kt;l.nodeType!==8;){if(!o){l=null;break t}if(l=Xt(l.nextSibling),l===null){l=null;break t}}o=l.data,l=o==="F!"||o==="F"?l:null}if(l){Ue=Xt(l.nextSibling),n=l.data==="F!";break e}}Ja(n)}n=!1}n&&(t=a[0])}}return a=mt(),a.memoizedState=a.baseState=t,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qo,lastRenderedState:t},a.queue=n,a=td.bind(null,pe,n),n.dispatch=a,n=Bc(!1),o=Pc.bind(null,pe,!1,n.queue),n=mt(),l={state:t,dispatch:null,action:e,pending:null},n.queue=l,a=Xp.bind(null,pe,l,o,a),l.dispatch=a,n.memoizedState=e,[t,a,!1]}function Uo(e){var t=Ye();return wo(t,Ae,e)}function wo(e,t,a){if(t=Hc(e,t,qo)[0],e=Bs(ia)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var n=Al(t)}catch(p){throw p===Sl?Ds:p}else n=t;t=Ye();var l=t.queue,o=l.dispatch;return a!==t.memoizedState&&(pe.flags|=2048,On(9,Us(),Vp.bind(null,l,a),null)),[n,o,e]}function Vp(e,t){e.action=t}function Lo(e){var t=Ye(),a=Ae;if(a!==null)return wo(t,a,e);Ye(),t=t.memoizedState,a=Ye();var n=a.queue.dispatch;return a.memoizedState=e,[t,n,!1]}function On(e,t,a,n){return e={tag:e,create:a,deps:n,inst:t,next:null},t=pe.updateQueue,t===null&&(t=Oc(),pe.updateQueue=t),a=t.lastEffect,a===null?t.lastEffect=e.next=e:(n=a.next,a.next=e,e.next=n,t.lastEffect=e),e}function Us(){return{destroy:void 0,resource:void 0}}function $o(){return Ye().memoizedState}function ws(e,t,a,n){var l=mt();n=n===void 0?null:n,pe.flags|=e,l.memoizedState=On(1|t,Us(),a,n)}function Tl(e,t,a,n){var l=Ye();n=n===void 0?null:n;var o=l.memoizedState.inst;Ae!==null&&n!==null&&Ac(n,Ae.memoizedState.deps)?l.memoizedState=On(t,o,a,n):(pe.flags|=e,l.memoizedState=On(1|t,o,a,n))}function Go(e,t){ws(8390656,8,e,t)}function Po(e,t){Tl(2048,8,e,t)}function Yo(e,t){return Tl(4,2,e,t)}function Xo(e,t){return Tl(4,4,e,t)}function Vo(e,t){if(typeof t=="function"){e=e();var a=t(e);return function(){typeof a=="function"?a():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ko(e,t,a){a=a!=null?a.concat([e]):null,Tl(4,4,Vo.bind(null,t,e),a)}function wc(){}function Qo(e,t){var a=Ye();t=t===void 0?null:t;var n=a.memoizedState;return t!==null&&Ac(t,n[1])?n[0]:(a.memoizedState=[e,t],e)}function Zo(e,t){var a=Ye();t=t===void 0?null:t;var n=a.memoizedState;if(t!==null&&Ac(t,n[1]))return n[0];if(n=e(),en){va(!0);try{e()}finally{va(!1)}}return a.memoizedState=[n,t],n}function Lc(e,t,a){return a===void 0||(_a&1073741824)!==0?e.memoizedState=t:(e.memoizedState=a,e=Id(),pe.lanes|=e,Da|=e,a)}function Ko(e,t,a,n){return St(a,t)?a:Mn.current!==null?(e=Lc(e,a,n),St(e,t)||(Je=!0),e):(_a&42)===0?(Je=!0,e.memoizedState=a):(e=Id(),pe.lanes|=e,Da|=e,t)}function Jo(e,t,a,n,l){var o=L.p;L.p=o!==0&&8>o?o:8;var p=j.T,y={};j.T=y,Pc(e,!1,t,a);try{var _=l(),z=j.S;if(z!==null&&z(y,_),_!==null&&typeof _=="object"&&typeof _.then=="function"){var G=Gp(_,n);Ml(e,t,G,Et(e))}else Ml(e,t,n,Et(e))}catch(Y){Ml(e,t,{then:function(){},status:"rejected",reason:Y},Et())}finally{L.p=o,j.T=p}}function kp(){}function $c(e,t,a,n){if(e.tag!==5)throw Error(u(476));var l=Io(e).queue;Jo(e,l,t,X,a===null?kp:function(){return Wo(e),a(n)})}function Io(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:X,baseState:X,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ia,lastRenderedState:X},next:null};var a={};return t.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ia,lastRenderedState:a},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function Wo(e){var t=Io(e).next.queue;Ml(e,t,{},Et())}function Gc(){return st(Ql)}function Fo(){return Ye().memoizedState}function ed(){return Ye().memoizedState}function Qp(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var a=Et();e=Sa(a);var n=ja(t,e,a);n!==null&&(At(n,t,a),_l(n,t,a)),t={cache:gc()},e.payload=t;return}t=t.return}}function Zp(e,t,a){var n=Et();a={lane:n,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null},Ls(e)?ad(t,a):(a=cc(e,t,a,n),a!==null&&(At(a,e,n),nd(a,t,n)))}function td(e,t,a){var n=Et();Ml(e,t,a,n)}function Ml(e,t,a,n){var l={lane:n,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null};if(Ls(e))ad(t,l);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var p=t.lastRenderedState,y=o(p,a);if(l.hasEagerState=!0,l.eagerState=y,St(y,p))return js(e,t,l,0),Re===null&&Ss(),!1}catch{}finally{}if(a=cc(e,t,l,n),a!==null)return At(a,e,n),nd(a,t,n),!0}return!1}function Pc(e,t,a,n){if(n={lane:2,revertLane:xr(),action:n,hasEagerState:!1,eagerState:null,next:null},Ls(e)){if(t)throw Error(u(479))}else t=cc(e,a,n,2),t!==null&&At(t,e,2)}function Ls(e){var t=e.alternate;return e===pe||t!==null&&t===pe}function ad(e,t){Dn=zs=!0;var a=e.pending;a===null?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function nd(e,t,a){if((a&4194048)!==0){var n=t.lanes;n&=e.pendingLanes,a|=n,t.lanes=a,ou(e,a)}}var $s={readContext:st,use:qs,useCallback:$e,useContext:$e,useEffect:$e,useImperativeHandle:$e,useLayoutEffect:$e,useInsertionEffect:$e,useMemo:$e,useReducer:$e,useRef:$e,useState:$e,useDebugValue:$e,useDeferredValue:$e,useTransition:$e,useSyncExternalStore:$e,useId:$e,useHostTransitionStatus:$e,useFormState:$e,useActionState:$e,useOptimistic:$e,useMemoCache:$e,useCacheRefresh:$e},ld={readContext:st,use:qs,useCallback:function(e,t){return mt().memoizedState=[e,t===void 0?null:t],e},useContext:st,useEffect:Go,useImperativeHandle:function(e,t,a){a=a!=null?a.concat([e]):null,ws(4194308,4,Vo.bind(null,t,e),a)},useLayoutEffect:function(e,t){return ws(4194308,4,e,t)},useInsertionEffect:function(e,t){ws(4,2,e,t)},useMemo:function(e,t){var a=mt();t=t===void 0?null:t;var n=e();if(en){va(!0);try{e()}finally{va(!1)}}return a.memoizedState=[n,t],n},useReducer:function(e,t,a){var n=mt();if(a!==void 0){var l=a(t);if(en){va(!0);try{a(t)}finally{va(!1)}}}else l=t;return n.memoizedState=n.baseState=l,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:l},n.queue=e,e=e.dispatch=Zp.bind(null,pe,e),[n.memoizedState,e]},useRef:function(e){var t=mt();return e={current:e},t.memoizedState=e},useState:function(e){e=Bc(e);var t=e.queue,a=td.bind(null,pe,t);return t.dispatch=a,[e.memoizedState,a]},useDebugValue:wc,useDeferredValue:function(e,t){var a=mt();return Lc(a,e,t)},useTransition:function(){var e=Bc(!1);return e=Jo.bind(null,pe,e.queue,!0,!1),mt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,a){var n=pe,l=mt();if(je){if(a===void 0)throw Error(u(407));a=a()}else{if(a=t(),Re===null)throw Error(u(349));(ye&124)!==0||Co(n,t,a)}l.memoizedState=a;var o={value:a,getSnapshot:t};return l.queue=o,Go(Ao.bind(null,n,o,e),[e]),n.flags|=2048,On(9,Us(),Eo.bind(null,n,o,a,t),null),a},useId:function(){var e=mt(),t=Re.identifierPrefix;if(je){var a=na,n=aa;a=(n&~(1<<32-xt(n)-1)).toString(32)+a,t="«"+t+"R"+a,a=Hs++,0<a&&(t+="H"+a.toString(32)),t+="»"}else a=Pp++,t="«"+t+"r"+a.toString(32)+"»";return e.memoizedState=t},useHostTransitionStatus:Gc,useFormState:Bo,useActionState:Bo,useOptimistic:function(e){var t=mt();t.memoizedState=t.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=a,t=Pc.bind(null,pe,!0,a),a.dispatch=t,[e,t]},useMemoCache:zc,useCacheRefresh:function(){return mt().memoizedState=Qp.bind(null,pe)}},sd={readContext:st,use:qs,useCallback:Qo,useContext:st,useEffect:Po,useImperativeHandle:ko,useInsertionEffect:Yo,useLayoutEffect:Xo,useMemo:Zo,useReducer:Bs,useRef:$o,useState:function(){return Bs(ia)},useDebugValue:wc,useDeferredValue:function(e,t){var a=Ye();return Ko(a,Ae.memoizedState,e,t)},useTransition:function(){var e=Bs(ia)[0],t=Ye().memoizedState;return[typeof e=="boolean"?e:Al(e),t]},useSyncExternalStore:No,useId:Fo,useHostTransitionStatus:Gc,useFormState:Uo,useActionState:Uo,useOptimistic:function(e,t){var a=Ye();return Do(a,Ae,e,t)},useMemoCache:zc,useCacheRefresh:ed},Kp={readContext:st,use:qs,useCallback:Qo,useContext:st,useEffect:Po,useImperativeHandle:ko,useInsertionEffect:Yo,useLayoutEffect:Xo,useMemo:Zo,useReducer:qc,useRef:$o,useState:function(){return qc(ia)},useDebugValue:wc,useDeferredValue:function(e,t){var a=Ye();return Ae===null?Lc(a,e,t):Ko(a,Ae.memoizedState,e,t)},useTransition:function(){var e=qc(ia)[0],t=Ye().memoizedState;return[typeof e=="boolean"?e:Al(e),t]},useSyncExternalStore:No,useId:Fo,useHostTransitionStatus:Gc,useFormState:Lo,useActionState:Lo,useOptimistic:function(e,t){var a=Ye();return Ae!==null?Do(a,Ae,e,t):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:zc,useCacheRefresh:ed},zn=null,Dl=0;function Gs(e){var t=Dl;return Dl+=1,zn===null&&(zn=[]),vo(zn,e,t)}function Rl(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Ps(e,t){throw t.$$typeof===x?Error(u(525)):(e=Object.prototype.toString.call(t),Error(u(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function id(e){var t=e._init;return t(e._payload)}function cd(e){function t(R,T){if(e){var O=R.deletions;O===null?(R.deletions=[T],R.flags|=16):O.push(T)}}function a(R,T){if(!e)return null;for(;T!==null;)t(R,T),T=T.sibling;return null}function n(R){for(var T=new Map;R!==null;)R.key!==null?T.set(R.key,R):T.set(R.index,R),R=R.sibling;return T}function l(R,T){return R=ta(R,T),R.index=0,R.sibling=null,R}function o(R,T,O){return R.index=O,e?(O=R.alternate,O!==null?(O=O.index,O<T?(R.flags|=67108866,T):O):(R.flags|=67108866,T)):(R.flags|=1048576,T)}function p(R){return e&&R.alternate===null&&(R.flags|=67108866),R}function y(R,T,O,P){return T===null||T.tag!==6?(T=uc(O,R.mode,P),T.return=R,T):(T=l(T,O),T.return=R,T)}function _(R,T,O,P){var W=O.type;return W===C?G(R,T,O.props.children,P,O.key):T!==null&&(T.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===te&&id(W)===T.type)?(T=l(T,O.props),Rl(T,O),T.return=R,T):(T=Ns(O.type,O.key,O.props,null,R.mode,P),Rl(T,O),T.return=R,T)}function z(R,T,O,P){return T===null||T.tag!==4||T.stateNode.containerInfo!==O.containerInfo||T.stateNode.implementation!==O.implementation?(T=oc(O,R.mode,P),T.return=R,T):(T=l(T,O.children||[]),T.return=R,T)}function G(R,T,O,P,W){return T===null||T.tag!==7?(T=ka(O,R.mode,P,W),T.return=R,T):(T=l(T,O),T.return=R,T)}function Y(R,T,O){if(typeof T=="string"&&T!==""||typeof T=="number"||typeof T=="bigint")return T=uc(""+T,R.mode,O),T.return=R,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case A:return O=Ns(T.type,T.key,T.props,null,R.mode,O),Rl(O,T),O.return=R,O;case N:return T=oc(T,R.mode,O),T.return=R,T;case te:var P=T._init;return T=P(T._payload),Y(R,T,O)}if($(T)||Ee(T))return T=ka(T,R.mode,O,null),T.return=R,T;if(typeof T.then=="function")return Y(R,Gs(T),O);if(T.$$typeof===V)return Y(R,Ts(R,T),O);Ps(R,T)}return null}function H(R,T,O,P){var W=T!==null?T.key:null;if(typeof O=="string"&&O!==""||typeof O=="number"||typeof O=="bigint")return W!==null?null:y(R,T,""+O,P);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case A:return O.key===W?_(R,T,O,P):null;case N:return O.key===W?z(R,T,O,P):null;case te:return W=O._init,O=W(O._payload),H(R,T,O,P)}if($(O)||Ee(O))return W!==null?null:G(R,T,O,P,null);if(typeof O.then=="function")return H(R,T,Gs(O),P);if(O.$$typeof===V)return H(R,T,Ts(R,O),P);Ps(R,O)}return null}function q(R,T,O,P,W){if(typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint")return R=R.get(O)||null,y(T,R,""+P,W);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case A:return R=R.get(P.key===null?O:P.key)||null,_(T,R,P,W);case N:return R=R.get(P.key===null?O:P.key)||null,z(T,R,P,W);case te:var he=P._init;return P=he(P._payload),q(R,T,O,P,W)}if($(P)||Ee(P))return R=R.get(O)||null,G(T,R,P,W,null);if(typeof P.then=="function")return q(R,T,O,Gs(P),W);if(P.$$typeof===V)return q(R,T,O,Ts(T,P),W);Ps(T,P)}return null}function oe(R,T,O,P){for(var W=null,he=null,ne=T,ue=T=0,We=null;ne!==null&&ue<O.length;ue++){ne.index>ue?(We=ne,ne=null):We=ne.sibling;var be=H(R,ne,O[ue],P);if(be===null){ne===null&&(ne=We);break}e&&ne&&be.alternate===null&&t(R,ne),T=o(be,T,ue),he===null?W=be:he.sibling=be,he=be,ne=We}if(ue===O.length)return a(R,ne),je&&Za(R,ue),W;if(ne===null){for(;ue<O.length;ue++)ne=Y(R,O[ue],P),ne!==null&&(T=o(ne,T,ue),he===null?W=ne:he.sibling=ne,he=ne);return je&&Za(R,ue),W}for(ne=n(ne);ue<O.length;ue++)We=q(ne,R,ue,O[ue],P),We!==null&&(e&&We.alternate!==null&&ne.delete(We.key===null?ue:We.key),T=o(We,T,ue),he===null?W=We:he.sibling=We,he=We);return e&&ne.forEach(function(La){return t(R,La)}),je&&Za(R,ue),W}function re(R,T,O,P){if(O==null)throw Error(u(151));for(var W=null,he=null,ne=T,ue=T=0,We=null,be=O.next();ne!==null&&!be.done;ue++,be=O.next()){ne.index>ue?(We=ne,ne=null):We=ne.sibling;var La=H(R,ne,be.value,P);if(La===null){ne===null&&(ne=We);break}e&&ne&&La.alternate===null&&t(R,ne),T=o(La,T,ue),he===null?W=La:he.sibling=La,he=La,ne=We}if(be.done)return a(R,ne),je&&Za(R,ue),W;if(ne===null){for(;!be.done;ue++,be=O.next())be=Y(R,be.value,P),be!==null&&(T=o(be,T,ue),he===null?W=be:he.sibling=be,he=be);return je&&Za(R,ue),W}for(ne=n(ne);!be.done;ue++,be=O.next())be=q(ne,R,ue,be.value,P),be!==null&&(e&&be.alternate!==null&&ne.delete(be.key===null?ue:be.key),T=o(be,T,ue),he===null?W=be:he.sibling=be,he=be);return e&&ne.forEach(function(Jh){return t(R,Jh)}),je&&Za(R,ue),W}function Me(R,T,O,P){if(typeof O=="object"&&O!==null&&O.type===C&&O.key===null&&(O=O.props.children),typeof O=="object"&&O!==null){switch(O.$$typeof){case A:e:{for(var W=O.key;T!==null;){if(T.key===W){if(W=O.type,W===C){if(T.tag===7){a(R,T.sibling),P=l(T,O.props.children),P.return=R,R=P;break e}}else if(T.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===te&&id(W)===T.type){a(R,T.sibling),P=l(T,O.props),Rl(P,O),P.return=R,R=P;break e}a(R,T);break}else t(R,T);T=T.sibling}O.type===C?(P=ka(O.props.children,R.mode,P,O.key),P.return=R,R=P):(P=Ns(O.type,O.key,O.props,null,R.mode,P),Rl(P,O),P.return=R,R=P)}return p(R);case N:e:{for(W=O.key;T!==null;){if(T.key===W)if(T.tag===4&&T.stateNode.containerInfo===O.containerInfo&&T.stateNode.implementation===O.implementation){a(R,T.sibling),P=l(T,O.children||[]),P.return=R,R=P;break e}else{a(R,T);break}else t(R,T);T=T.sibling}P=oc(O,R.mode,P),P.return=R,R=P}return p(R);case te:return W=O._init,O=W(O._payload),Me(R,T,O,P)}if($(O))return oe(R,T,O,P);if(Ee(O)){if(W=Ee(O),typeof W!="function")throw Error(u(150));return O=W.call(O),re(R,T,O,P)}if(typeof O.then=="function")return Me(R,T,Gs(O),P);if(O.$$typeof===V)return Me(R,T,Ts(R,O),P);Ps(R,O)}return typeof O=="string"&&O!==""||typeof O=="number"||typeof O=="bigint"?(O=""+O,T!==null&&T.tag===6?(a(R,T.sibling),P=l(T,O),P.return=R,R=P):(a(R,T),P=uc(O,R.mode,P),P.return=R,R=P),p(R)):a(R,T)}return function(R,T,O,P){try{Dl=0;var W=Me(R,T,O,P);return zn=null,W}catch(ne){if(ne===Sl||ne===Ds)throw ne;var he=jt(29,ne,null,R.mode);return he.lanes=P,he.return=R,he}finally{}}}var Hn=cd(!0),rd=cd(!1),qt=U(null),Qt=null;function Na(e){var t=e.alternate;Z(ke,ke.current&1),Z(qt,e),Qt===null&&(t===null||Mn.current!==null||t.memoizedState!==null)&&(Qt=e)}function ud(e){if(e.tag===22){if(Z(ke,ke.current),Z(qt,e),Qt===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(Qt=e)}}else Ca()}function Ca(){Z(ke,ke.current),Z(qt,qt.current)}function ca(e){k(qt),Qt===e&&(Qt=null),k(ke)}var ke=U(0);function Ys(e){for(var t=e;t!==null;){if(t.tag===13){var a=t.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||Or(a)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Yc(e,t,a,n){t=e.memoizedState,a=a(n,t),a=a==null?t:b({},t,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var Xc={enqueueSetState:function(e,t,a){e=e._reactInternals;var n=Et(),l=Sa(n);l.payload=t,a!=null&&(l.callback=a),t=ja(e,l,n),t!==null&&(At(t,e,n),_l(t,e,n))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var n=Et(),l=Sa(n);l.tag=1,l.payload=t,a!=null&&(l.callback=a),t=ja(e,l,n),t!==null&&(At(t,e,n),_l(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=Et(),n=Sa(a);n.tag=2,t!=null&&(n.callback=t),t=ja(e,n,a),t!==null&&(At(t,e,a),_l(t,e,a))}};function od(e,t,a,n,l,o,p){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,o,p):t.prototype&&t.prototype.isPureReactComponent?!ml(a,n)||!ml(l,o):!0}function dd(e,t,a,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(a,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(a,n),t.state!==e&&Xc.enqueueReplaceState(t,t.state,null)}function tn(e,t){var a=t;if("ref"in t){a={};for(var n in t)n!=="ref"&&(a[n]=t[n])}if(e=e.defaultProps){a===t&&(a=b({},a));for(var l in e)a[l]===void 0&&(a[l]=e[l])}return a}var Xs=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function fd(e){Xs(e)}function md(e){console.error(e)}function pd(e){Xs(e)}function Vs(e,t){try{var a=e.onUncaughtError;a(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function hd(e,t,a){try{var n=e.onCaughtError;n(a.value,{componentStack:a.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(l){setTimeout(function(){throw l})}}function Vc(e,t,a){return a=Sa(a),a.tag=3,a.payload={element:null},a.callback=function(){Vs(e,t)},a}function vd(e){return e=Sa(e),e.tag=3,e}function gd(e,t,a,n){var l=a.type.getDerivedStateFromError;if(typeof l=="function"){var o=n.value;e.payload=function(){return l(o)},e.callback=function(){hd(t,a,n)}}var p=a.stateNode;p!==null&&typeof p.componentDidCatch=="function"&&(e.callback=function(){hd(t,a,n),typeof l!="function"&&(Ra===null?Ra=new Set([this]):Ra.add(this));var y=n.stack;this.componentDidCatch(n.value,{componentStack:y!==null?y:""})})}function Jp(e,t,a,n,l){if(a.flags|=32768,n!==null&&typeof n=="object"&&typeof n.then=="function"){if(t=a.alternate,t!==null&&yl(t,a,l,!0),a=qt.current,a!==null){switch(a.tag){case 13:return Qt===null?hr():a.alternate===null&&we===0&&(we=3),a.flags&=-257,a.flags|=65536,a.lanes=l,n===xc?a.flags|=16384:(t=a.updateQueue,t===null?a.updateQueue=new Set([n]):t.add(n),gr(e,n,l)),!1;case 22:return a.flags|=65536,n===xc?a.flags|=16384:(t=a.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([n])},a.updateQueue=t):(a=t.retryQueue,a===null?t.retryQueue=new Set([n]):a.add(n)),gr(e,n,l)),!1}throw Error(u(435,a.tag))}return gr(e,n,l),hr(),!1}if(je)return t=qt.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=l,n!==mc&&(e=Error(u(422),{cause:n}),gl(Rt(e,a)))):(n!==mc&&(t=Error(u(423),{cause:n}),gl(Rt(t,a))),e=e.current.alternate,e.flags|=65536,l&=-l,e.lanes|=l,n=Rt(n,a),l=Vc(e.stateNode,n,l),_c(e,l),we!==4&&(we=2)),!1;var o=Error(u(520),{cause:n});if(o=Rt(o,a),wl===null?wl=[o]:wl.push(o),we!==4&&(we=2),t===null)return!0;n=Rt(n,a),a=t;do{switch(a.tag){case 3:return a.flags|=65536,e=l&-l,a.lanes|=e,e=Vc(a.stateNode,n,e),_c(a,e),!1;case 1:if(t=a.type,o=a.stateNode,(a.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||o!==null&&typeof o.componentDidCatch=="function"&&(Ra===null||!Ra.has(o))))return a.flags|=65536,l&=-l,a.lanes|=l,l=vd(l),gd(l,e,a,n),_c(a,l),!1}a=a.return}while(a!==null);return!1}var yd=Error(u(461)),Je=!1;function et(e,t,a,n){t.child=e===null?rd(t,null,a,n):Hn(t,e.child,a,n)}function bd(e,t,a,n,l){a=a.render;var o=t.ref;if("ref"in n){var p={};for(var y in n)y!=="ref"&&(p[y]=n[y])}else p=n;return Wa(t),n=Tc(e,t,a,p,o,l),y=Mc(),e!==null&&!Je?(Dc(e,t,l),ra(e,t,l)):(je&&y&&dc(t),t.flags|=1,et(e,t,n,l),t.child)}function xd(e,t,a,n,l){if(e===null){var o=a.type;return typeof o=="function"&&!rc(o)&&o.defaultProps===void 0&&a.compare===null?(t.tag=15,t.type=o,Sd(e,t,o,n,l)):(e=Ns(a.type,null,n,t,t.mode,l),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!Fc(e,l)){var p=o.memoizedProps;if(a=a.compare,a=a!==null?a:ml,a(p,n)&&e.ref===t.ref)return ra(e,t,l)}return t.flags|=1,e=ta(o,n),e.ref=t.ref,e.return=t,t.child=e}function Sd(e,t,a,n,l){if(e!==null){var o=e.memoizedProps;if(ml(o,n)&&e.ref===t.ref)if(Je=!1,t.pendingProps=n=o,Fc(e,l))(e.flags&131072)!==0&&(Je=!0);else return t.lanes=e.lanes,ra(e,t,l)}return kc(e,t,a,n,l)}function jd(e,t,a){var n=t.pendingProps,l=n.children,o=e!==null?e.memoizedState:null;if(n.mode==="hidden"){if((t.flags&128)!==0){if(n=o!==null?o.baseLanes|a:a,e!==null){for(l=t.child=e.child,o=0;l!==null;)o=o|l.lanes|l.childLanes,l=l.sibling;t.childLanes=o&~n}else t.childLanes=0,t.child=null;return _d(e,t,n,a)}if((a&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Ms(t,o!==null?o.cachePool:null),o!==null?So(t,o):Cc(),ud(t);else return t.lanes=t.childLanes=536870912,_d(e,t,o!==null?o.baseLanes|a:a,a)}else o!==null?(Ms(t,o.cachePool),So(t,o),Ca(),t.memoizedState=null):(e!==null&&Ms(t,null),Cc(),Ca());return et(e,t,l,a),t.child}function _d(e,t,a,n){var l=bc();return l=l===null?null:{parent:Ve._currentValue,pool:l},t.memoizedState={baseLanes:a,cachePool:l},e!==null&&Ms(t,null),Cc(),ud(t),e!==null&&yl(e,t,n,!0),null}function ks(e,t){var a=t.ref;if(a===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(u(284));(e===null||e.ref!==a)&&(t.flags|=4194816)}}function kc(e,t,a,n,l){return Wa(t),a=Tc(e,t,a,n,void 0,l),n=Mc(),e!==null&&!Je?(Dc(e,t,l),ra(e,t,l)):(je&&n&&dc(t),t.flags|=1,et(e,t,a,l),t.child)}function Nd(e,t,a,n,l,o){return Wa(t),t.updateQueue=null,a=_o(t,n,a,l),jo(e),n=Mc(),e!==null&&!Je?(Dc(e,t,o),ra(e,t,o)):(je&&n&&dc(t),t.flags|=1,et(e,t,a,o),t.child)}function Cd(e,t,a,n,l){if(Wa(t),t.stateNode===null){var o=Nn,p=a.contextType;typeof p=="object"&&p!==null&&(o=st(p)),o=new a(n,o),t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Xc,t.stateNode=o,o._reactInternals=t,o=t.stateNode,o.props=n,o.state=t.memoizedState,o.refs={},Sc(t),p=a.contextType,o.context=typeof p=="object"&&p!==null?st(p):Nn,o.state=t.memoizedState,p=a.getDerivedStateFromProps,typeof p=="function"&&(Yc(t,a,p,n),o.state=t.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(p=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),p!==o.state&&Xc.enqueueReplaceState(o,o.state,null),Cl(t,n,o,l),Nl(),o.state=t.memoizedState),typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!0}else if(e===null){o=t.stateNode;var y=t.memoizedProps,_=tn(a,y);o.props=_;var z=o.context,G=a.contextType;p=Nn,typeof G=="object"&&G!==null&&(p=st(G));var Y=a.getDerivedStateFromProps;G=typeof Y=="function"||typeof o.getSnapshotBeforeUpdate=="function",y=t.pendingProps!==y,G||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(y||z!==p)&&dd(t,o,n,p),xa=!1;var H=t.memoizedState;o.state=H,Cl(t,n,o,l),Nl(),z=t.memoizedState,y||H!==z||xa?(typeof Y=="function"&&(Yc(t,a,Y,n),z=t.memoizedState),(_=xa||od(t,a,_,n,H,z,p))?(G||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=z),o.props=n,o.state=z,o.context=p,n=_):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,jc(e,t),p=t.memoizedProps,G=tn(a,p),o.props=G,Y=t.pendingProps,H=o.context,z=a.contextType,_=Nn,typeof z=="object"&&z!==null&&(_=st(z)),y=a.getDerivedStateFromProps,(z=typeof y=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(p!==Y||H!==_)&&dd(t,o,n,_),xa=!1,H=t.memoizedState,o.state=H,Cl(t,n,o,l),Nl();var q=t.memoizedState;p!==Y||H!==q||xa||e!==null&&e.dependencies!==null&&As(e.dependencies)?(typeof y=="function"&&(Yc(t,a,y,n),q=t.memoizedState),(G=xa||od(t,a,G,n,H,q,_)||e!==null&&e.dependencies!==null&&As(e.dependencies))?(z||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,q,_),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,q,_)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||p===e.memoizedProps&&H===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||p===e.memoizedProps&&H===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=q),o.props=n,o.state=q,o.context=_,n=G):(typeof o.componentDidUpdate!="function"||p===e.memoizedProps&&H===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||p===e.memoizedProps&&H===e.memoizedState||(t.flags|=1024),n=!1)}return o=n,ks(e,t),n=(t.flags&128)!==0,o||n?(o=t.stateNode,a=n&&typeof a.getDerivedStateFromError!="function"?null:o.render(),t.flags|=1,e!==null&&n?(t.child=Hn(t,e.child,null,l),t.child=Hn(t,null,a,l)):et(e,t,a,l),t.memoizedState=o.state,e=t.child):e=ra(e,t,l),e}function Ed(e,t,a,n){return vl(),t.flags|=256,et(e,t,a,n),t.child}var Qc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Zc(e){return{baseLanes:e,cachePool:mo()}}function Kc(e,t,a){return e=e!==null?e.childLanes&~a:0,t&&(e|=Bt),e}function Ad(e,t,a){var n=t.pendingProps,l=!1,o=(t.flags&128)!==0,p;if((p=o)||(p=e!==null&&e.memoizedState===null?!1:(ke.current&2)!==0),p&&(l=!0,t.flags&=-129),p=(t.flags&32)!==0,t.flags&=-33,e===null){if(je){if(l?Na(t):Ca(),je){var y=Ue,_;if(_=y){e:{for(_=y,y=kt;_.nodeType!==8;){if(!y){y=null;break e}if(_=Xt(_.nextSibling),_===null){y=null;break e}}y=_}y!==null?(t.memoizedState={dehydrated:y,treeContext:Qa!==null?{id:aa,overflow:na}:null,retryLane:536870912,hydrationErrors:null},_=jt(18,null,null,0),_.stateNode=y,_.return=t,t.child=_,rt=t,Ue=null,_=!0):_=!1}_||Ja(t)}if(y=t.memoizedState,y!==null&&(y=y.dehydrated,y!==null))return Or(y)?t.lanes=32:t.lanes=536870912,null;ca(t)}return y=n.children,n=n.fallback,l?(Ca(),l=t.mode,y=Qs({mode:"hidden",children:y},l),n=ka(n,l,a,null),y.return=t,n.return=t,y.sibling=n,t.child=y,l=t.child,l.memoizedState=Zc(a),l.childLanes=Kc(e,p,a),t.memoizedState=Qc,n):(Na(t),Jc(t,y))}if(_=e.memoizedState,_!==null&&(y=_.dehydrated,y!==null)){if(o)t.flags&256?(Na(t),t.flags&=-257,t=Ic(e,t,a)):t.memoizedState!==null?(Ca(),t.child=e.child,t.flags|=128,t=null):(Ca(),l=n.fallback,y=t.mode,n=Qs({mode:"visible",children:n.children},y),l=ka(l,y,a,null),l.flags|=2,n.return=t,l.return=t,n.sibling=l,t.child=n,Hn(t,e.child,null,a),n=t.child,n.memoizedState=Zc(a),n.childLanes=Kc(e,p,a),t.memoizedState=Qc,t=l);else if(Na(t),Or(y)){if(p=y.nextSibling&&y.nextSibling.dataset,p)var z=p.dgst;p=z,n=Error(u(419)),n.stack="",n.digest=p,gl({value:n,source:null,stack:null}),t=Ic(e,t,a)}else if(Je||yl(e,t,a,!1),p=(a&e.childLanes)!==0,Je||p){if(p=Re,p!==null&&(n=a&-a,n=(n&42)!==0?1:zi(n),n=(n&(p.suspendedLanes|a))!==0?0:n,n!==0&&n!==_.retryLane))throw _.retryLane=n,_n(e,n),At(p,e,n),yd;y.data==="$?"||hr(),t=Ic(e,t,a)}else y.data==="$?"?(t.flags|=192,t.child=e.child,t=null):(e=_.treeContext,Ue=Xt(y.nextSibling),rt=t,je=!0,Ka=null,kt=!1,e!==null&&(zt[Ht++]=aa,zt[Ht++]=na,zt[Ht++]=Qa,aa=e.id,na=e.overflow,Qa=t),t=Jc(t,n.children),t.flags|=4096);return t}return l?(Ca(),l=n.fallback,y=t.mode,_=e.child,z=_.sibling,n=ta(_,{mode:"hidden",children:n.children}),n.subtreeFlags=_.subtreeFlags&65011712,z!==null?l=ta(z,l):(l=ka(l,y,a,null),l.flags|=2),l.return=t,n.return=t,n.sibling=l,t.child=n,n=l,l=t.child,y=e.child.memoizedState,y===null?y=Zc(a):(_=y.cachePool,_!==null?(z=Ve._currentValue,_=_.parent!==z?{parent:z,pool:z}:_):_=mo(),y={baseLanes:y.baseLanes|a,cachePool:_}),l.memoizedState=y,l.childLanes=Kc(e,p,a),t.memoizedState=Qc,n):(Na(t),a=e.child,e=a.sibling,a=ta(a,{mode:"visible",children:n.children}),a.return=t,a.sibling=null,e!==null&&(p=t.deletions,p===null?(t.deletions=[e],t.flags|=16):p.push(e)),t.child=a,t.memoizedState=null,a)}function Jc(e,t){return t=Qs({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Qs(e,t){return e=jt(22,e,null,t),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Ic(e,t,a){return Hn(t,e.child,null,a),e=Jc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Td(e,t,a){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),hc(e.return,t,a)}function Wc(e,t,a,n,l){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:a,tailMode:l}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=a,o.tailMode=l)}function Md(e,t,a){var n=t.pendingProps,l=n.revealOrder,o=n.tail;if(et(e,t,n.children,a),n=ke.current,(n&2)!==0)n=n&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Td(e,a,t);else if(e.tag===19)Td(e,a,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}switch(Z(ke,n),l){case"forwards":for(a=t.child,l=null;a!==null;)e=a.alternate,e!==null&&Ys(e)===null&&(l=a),a=a.sibling;a=l,a===null?(l=t.child,t.child=null):(l=a.sibling,a.sibling=null),Wc(t,!1,l,a,o);break;case"backwards":for(a=null,l=t.child,t.child=null;l!==null;){if(e=l.alternate,e!==null&&Ys(e)===null){t.child=l;break}e=l.sibling,l.sibling=a,a=l,l=e}Wc(t,!0,a,null,o);break;case"together":Wc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ra(e,t,a){if(e!==null&&(t.dependencies=e.dependencies),Da|=t.lanes,(a&t.childLanes)===0)if(e!==null){if(yl(e,t,a,!1),(a&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(u(153));if(t.child!==null){for(e=t.child,a=ta(e,e.pendingProps),t.child=a,a.return=t;e.sibling!==null;)e=e.sibling,a=a.sibling=ta(e,e.pendingProps),a.return=t;a.sibling=null}return t.child}function Fc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&As(e)))}function Ip(e,t,a){switch(t.tag){case 3:_e(t,t.stateNode.containerInfo),ba(t,Ve,e.memoizedState.cache),vl();break;case 27:case 5:In(t);break;case 4:_e(t,t.stateNode.containerInfo);break;case 10:ba(t,t.type,t.memoizedProps.value);break;case 13:var n=t.memoizedState;if(n!==null)return n.dehydrated!==null?(Na(t),t.flags|=128,null):(a&t.child.childLanes)!==0?Ad(e,t,a):(Na(t),e=ra(e,t,a),e!==null?e.sibling:null);Na(t);break;case 19:var l=(e.flags&128)!==0;if(n=(a&t.childLanes)!==0,n||(yl(e,t,a,!1),n=(a&t.childLanes)!==0),l){if(n)return Md(e,t,a);t.flags|=128}if(l=t.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),Z(ke,ke.current),n)break;return null;case 22:case 23:return t.lanes=0,jd(e,t,a);case 24:ba(t,Ve,e.memoizedState.cache)}return ra(e,t,a)}function Dd(e,t,a){if(e!==null)if(e.memoizedProps!==t.pendingProps)Je=!0;else{if(!Fc(e,a)&&(t.flags&128)===0)return Je=!1,Ip(e,t,a);Je=(e.flags&131072)!==0}else Je=!1,je&&(t.flags&1048576)!==0&&so(t,Es,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var n=t.elementType,l=n._init;if(n=l(n._payload),t.type=n,typeof n=="function")rc(n)?(e=tn(n,e),t.tag=1,t=Cd(null,t,n,e,a)):(t.tag=0,t=kc(null,t,n,e,a));else{if(n!=null){if(l=n.$$typeof,l===le){t.tag=11,t=bd(null,t,n,e,a);break e}else if(l===J){t.tag=14,t=xd(null,t,n,e,a);break e}}throw t=w(n)||n,Error(u(306,t,""))}}return t;case 0:return kc(e,t,t.type,t.pendingProps,a);case 1:return n=t.type,l=tn(n,t.pendingProps),Cd(e,t,n,l,a);case 3:e:{if(_e(t,t.stateNode.containerInfo),e===null)throw Error(u(387));n=t.pendingProps;var o=t.memoizedState;l=o.element,jc(e,t),Cl(t,n,null,a);var p=t.memoizedState;if(n=p.cache,ba(t,Ve,n),n!==o.cache&&vc(t,[Ve],a,!0),Nl(),n=p.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:p.cache},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){t=Ed(e,t,n,a);break e}else if(n!==l){l=Rt(Error(u(424)),t),gl(l),t=Ed(e,t,n,a);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Ue=Xt(e.firstChild),rt=t,je=!0,Ka=null,kt=!0,a=rd(t,null,n,a),t.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(vl(),n===l){t=ra(e,t,a);break e}et(e,t,n,a)}t=t.child}return t;case 26:return ks(e,t),e===null?(a=qf(t.type,null,t.pendingProps,null))?t.memoizedState=a:je||(a=t.type,e=t.pendingProps,n=ci(ce.current).createElement(a),n[lt]=t,n[dt]=e,at(n,a,e),Ke(n),t.stateNode=n):t.memoizedState=qf(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return In(t),e===null&&je&&(n=t.stateNode=Of(t.type,t.pendingProps,ce.current),rt=t,kt=!0,l=Ue,Ha(t.type)?(zr=l,Ue=Xt(n.firstChild)):Ue=l),et(e,t,t.pendingProps.children,a),ks(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&je&&((l=n=Ue)&&(n=Ch(n,t.type,t.pendingProps,kt),n!==null?(t.stateNode=n,rt=t,Ue=Xt(n.firstChild),kt=!1,l=!0):l=!1),l||Ja(t)),In(t),l=t.type,o=t.pendingProps,p=e!==null?e.memoizedProps:null,n=o.children,Mr(l,o)?n=null:p!==null&&Mr(l,p)&&(t.flags|=32),t.memoizedState!==null&&(l=Tc(e,t,Yp,null,null,a),Ql._currentValue=l),ks(e,t),et(e,t,n,a),t.child;case 6:return e===null&&je&&((e=a=Ue)&&(a=Eh(a,t.pendingProps,kt),a!==null?(t.stateNode=a,rt=t,Ue=null,e=!0):e=!1),e||Ja(t)),null;case 13:return Ad(e,t,a);case 4:return _e(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Hn(t,null,n,a):et(e,t,n,a),t.child;case 11:return bd(e,t,t.type,t.pendingProps,a);case 7:return et(e,t,t.pendingProps,a),t.child;case 8:return et(e,t,t.pendingProps.children,a),t.child;case 12:return et(e,t,t.pendingProps.children,a),t.child;case 10:return n=t.pendingProps,ba(t,t.type,n.value),et(e,t,n.children,a),t.child;case 9:return l=t.type._context,n=t.pendingProps.children,Wa(t),l=st(l),n=n(l),t.flags|=1,et(e,t,n,a),t.child;case 14:return xd(e,t,t.type,t.pendingProps,a);case 15:return Sd(e,t,t.type,t.pendingProps,a);case 19:return Md(e,t,a);case 31:return n=t.pendingProps,a=t.mode,n={mode:n.mode,children:n.children},e===null?(a=Qs(n,a),a.ref=t.ref,t.child=a,a.return=t,t=a):(a=ta(e.child,n),a.ref=t.ref,t.child=a,a.return=t,t=a),t;case 22:return jd(e,t,a);case 24:return Wa(t),n=st(Ve),e===null?(l=bc(),l===null&&(l=Re,o=gc(),l.pooledCache=o,o.refCount++,o!==null&&(l.pooledCacheLanes|=a),l=o),t.memoizedState={parent:n,cache:l},Sc(t),ba(t,Ve,l)):((e.lanes&a)!==0&&(jc(e,t),Cl(t,null,null,a),Nl()),l=e.memoizedState,o=t.memoizedState,l.parent!==n?(l={parent:n,cache:n},t.memoizedState=l,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=l),ba(t,Ve,n)):(n=o.cache,ba(t,Ve,n),n!==l.cache&&vc(t,[Ve],a,!0))),et(e,t,t.pendingProps.children,a),t.child;case 29:throw t.pendingProps}throw Error(u(156,t.tag))}function ua(e){e.flags|=4}function Rd(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!$f(t)){if(t=qt.current,t!==null&&((ye&4194048)===ye?Qt!==null:(ye&62914560)!==ye&&(ye&536870912)===0||t!==Qt))throw jl=xc,po;e.flags|=8192}}function Zs(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?ru():536870912,e.lanes|=t,wn|=t)}function Ol(e,t){if(!je)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;t!==null;)t.alternate!==null&&(a=t),t=t.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var n=null;a!==null;)a.alternate!==null&&(n=a),a=a.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Be(e){var t=e.alternate!==null&&e.alternate.child===e.child,a=0,n=0;if(t)for(var l=e.child;l!==null;)a|=l.lanes|l.childLanes,n|=l.subtreeFlags&65011712,n|=l.flags&65011712,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)a|=l.lanes|l.childLanes,n|=l.subtreeFlags,n|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=n,e.childLanes=a,t}function Wp(e,t,a){var n=t.pendingProps;switch(fc(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Be(t),null;case 1:return Be(t),null;case 3:return a=t.stateNode,n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),sa(Ve),Vt(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(hl(t)?ua(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,ro())),Be(t),null;case 26:return a=t.memoizedState,e===null?(ua(t),a!==null?(Be(t),Rd(t,a)):(Be(t),t.flags&=-16777217)):a?a!==e.memoizedState?(ua(t),Be(t),Rd(t,a)):(Be(t),t.flags&=-16777217):(e.memoizedProps!==n&&ua(t),Be(t),t.flags&=-16777217),null;case 27:rn(t),a=ce.current;var l=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==n&&ua(t);else{if(!n){if(t.stateNode===null)throw Error(u(166));return Be(t),null}e=F.current,hl(t)?io(t):(e=Of(l,n,a),t.stateNode=e,ua(t))}return Be(t),null;case 5:if(rn(t),a=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==n&&ua(t);else{if(!n){if(t.stateNode===null)throw Error(u(166));return Be(t),null}if(e=F.current,hl(t))io(t);else{switch(l=ci(ce.current),e){case 1:e=l.createElementNS("http://www.w3.org/2000/svg",a);break;case 2:e=l.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;default:switch(a){case"svg":e=l.createElementNS("http://www.w3.org/2000/svg",a);break;case"math":e=l.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;case"script":e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof n.is=="string"?l.createElement("select",{is:n.is}):l.createElement("select"),n.multiple?e.multiple=!0:n.size&&(e.size=n.size);break;default:e=typeof n.is=="string"?l.createElement(a,{is:n.is}):l.createElement(a)}}e[lt]=t,e[dt]=n;e:for(l=t.child;l!==null;){if(l.tag===5||l.tag===6)e.appendChild(l.stateNode);else if(l.tag!==4&&l.tag!==27&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===t)break e;for(;l.sibling===null;){if(l.return===null||l.return===t)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}t.stateNode=e;e:switch(at(e,a,n),a){case"button":case"input":case"select":case"textarea":e=!!n.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&ua(t)}}return Be(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==n&&ua(t);else{if(typeof n!="string"&&t.stateNode===null)throw Error(u(166));if(e=ce.current,hl(t)){if(e=t.stateNode,a=t.memoizedProps,n=null,l=rt,l!==null)switch(l.tag){case 27:case 5:n=l.memoizedProps}e[lt]=t,e=!!(e.nodeValue===a||n!==null&&n.suppressHydrationWarning===!0||Cf(e.nodeValue,a)),e||Ja(t)}else e=ci(e).createTextNode(n),e[lt]=t,t.stateNode=e}return Be(t),null;case 13:if(n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(l=hl(t),n!==null&&n.dehydrated!==null){if(e===null){if(!l)throw Error(u(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(u(317));l[lt]=t}else vl(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Be(t),l=!1}else l=ro(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=l),l=!0;if(!l)return t.flags&256?(ca(t),t):(ca(t),null)}if(ca(t),(t.flags&128)!==0)return t.lanes=a,t;if(a=n!==null,e=e!==null&&e.memoizedState!==null,a){n=t.child,l=null,n.alternate!==null&&n.alternate.memoizedState!==null&&n.alternate.memoizedState.cachePool!==null&&(l=n.alternate.memoizedState.cachePool.pool);var o=null;n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),o!==l&&(n.flags|=2048)}return a!==e&&a&&(t.child.flags|=8192),Zs(t,t.updateQueue),Be(t),null;case 4:return Vt(),e===null&&Nr(t.stateNode.containerInfo),Be(t),null;case 10:return sa(t.type),Be(t),null;case 19:if(k(ke),l=t.memoizedState,l===null)return Be(t),null;if(n=(t.flags&128)!==0,o=l.rendering,o===null)if(n)Ol(l,!1);else{if(we!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(o=Ys(e),o!==null){for(t.flags|=128,Ol(l,!1),e=o.updateQueue,t.updateQueue=e,Zs(t,e),t.subtreeFlags=0,e=a,a=t.child;a!==null;)lo(a,e),a=a.sibling;return Z(ke,ke.current&1|2),t.child}e=e.sibling}l.tail!==null&&Se()>Is&&(t.flags|=128,n=!0,Ol(l,!1),t.lanes=4194304)}else{if(!n)if(e=Ys(o),e!==null){if(t.flags|=128,n=!0,e=e.updateQueue,t.updateQueue=e,Zs(t,e),Ol(l,!0),l.tail===null&&l.tailMode==="hidden"&&!o.alternate&&!je)return Be(t),null}else 2*Se()-l.renderingStartTime>Is&&a!==536870912&&(t.flags|=128,n=!0,Ol(l,!1),t.lanes=4194304);l.isBackwards?(o.sibling=t.child,t.child=o):(e=l.last,e!==null?e.sibling=o:t.child=o,l.last=o)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=Se(),t.sibling=null,e=ke.current,Z(ke,n?e&1|2:e&1),t):(Be(t),null);case 22:case 23:return ca(t),Ec(),n=t.memoizedState!==null,e!==null?e.memoizedState!==null!==n&&(t.flags|=8192):n&&(t.flags|=8192),n?(a&536870912)!==0&&(t.flags&128)===0&&(Be(t),t.subtreeFlags&6&&(t.flags|=8192)):Be(t),a=t.updateQueue,a!==null&&Zs(t,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),n=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),n!==a&&(t.flags|=2048),e!==null&&k(Fa),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),sa(Ve),Be(t),null;case 25:return null;case 30:return null}throw Error(u(156,t.tag))}function Fp(e,t){switch(fc(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return sa(Ve),Vt(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return rn(t),null;case 13:if(ca(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(u(340));vl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return k(ke),null;case 4:return Vt(),null;case 10:return sa(t.type),null;case 22:case 23:return ca(t),Ec(),e!==null&&k(Fa),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return sa(Ve),null;case 25:return null;default:return null}}function Od(e,t){switch(fc(t),t.tag){case 3:sa(Ve),Vt();break;case 26:case 27:case 5:rn(t);break;case 4:Vt();break;case 13:ca(t);break;case 19:k(ke);break;case 10:sa(t.type);break;case 22:case 23:ca(t),Ec(),e!==null&&k(Fa);break;case 24:sa(Ve)}}function zl(e,t){try{var a=t.updateQueue,n=a!==null?a.lastEffect:null;if(n!==null){var l=n.next;a=l;do{if((a.tag&e)===e){n=void 0;var o=a.create,p=a.inst;n=o(),p.destroy=n}a=a.next}while(a!==l)}}catch(y){De(t,t.return,y)}}function Ea(e,t,a){try{var n=t.updateQueue,l=n!==null?n.lastEffect:null;if(l!==null){var o=l.next;n=o;do{if((n.tag&e)===e){var p=n.inst,y=p.destroy;if(y!==void 0){p.destroy=void 0,l=t;var _=a,z=y;try{z()}catch(G){De(l,_,G)}}}n=n.next}while(n!==o)}}catch(G){De(t,t.return,G)}}function zd(e){var t=e.updateQueue;if(t!==null){var a=e.stateNode;try{xo(t,a)}catch(n){De(e,e.return,n)}}}function Hd(e,t,a){a.props=tn(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(n){De(e,t,n)}}function Hl(e,t){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var n=e.stateNode;break;case 30:n=e.stateNode;break;default:n=e.stateNode}typeof a=="function"?e.refCleanup=a(n):a.current=n}}catch(l){De(e,t,l)}}function Zt(e,t){var a=e.ref,n=e.refCleanup;if(a!==null)if(typeof n=="function")try{n()}catch(l){De(e,t,l)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(l){De(e,t,l)}else a.current=null}function qd(e){var t=e.type,a=e.memoizedProps,n=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":a.autoFocus&&n.focus();break e;case"img":a.src?n.src=a.src:a.srcSet&&(n.srcset=a.srcSet)}}catch(l){De(e,e.return,l)}}function er(e,t,a){try{var n=e.stateNode;xh(n,e.type,a,t),n[dt]=t}catch(l){De(e,e.return,l)}}function Bd(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Ha(e.type)||e.tag===4}function tr(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Bd(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Ha(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ar(e,t,a){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,t):(t=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,t.appendChild(e),a=a._reactRootContainer,a!=null||t.onclick!==null||(t.onclick=ii));else if(n!==4&&(n===27&&Ha(e.type)&&(a=e.stateNode,t=null),e=e.child,e!==null))for(ar(e,t,a),e=e.sibling;e!==null;)ar(e,t,a),e=e.sibling}function Ks(e,t,a){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(n!==4&&(n===27&&Ha(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(Ks(e,t,a),e=e.sibling;e!==null;)Ks(e,t,a),e=e.sibling}function Ud(e){var t=e.stateNode,a=e.memoizedProps;try{for(var n=e.type,l=t.attributes;l.length;)t.removeAttributeNode(l[0]);at(t,n,a),t[lt]=e,t[dt]=a}catch(o){De(e,e.return,o)}}var oa=!1,Ge=!1,nr=!1,wd=typeof WeakSet=="function"?WeakSet:Set,Ie=null;function eh(e,t){if(e=e.containerInfo,Ar=mi,e=Zu(e),tc(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var n=a.getSelection&&a.getSelection();if(n&&n.rangeCount!==0){a=n.anchorNode;var l=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{a.nodeType,o.nodeType}catch{a=null;break e}var p=0,y=-1,_=-1,z=0,G=0,Y=e,H=null;t:for(;;){for(var q;Y!==a||l!==0&&Y.nodeType!==3||(y=p+l),Y!==o||n!==0&&Y.nodeType!==3||(_=p+n),Y.nodeType===3&&(p+=Y.nodeValue.length),(q=Y.firstChild)!==null;)H=Y,Y=q;for(;;){if(Y===e)break t;if(H===a&&++z===l&&(y=p),H===o&&++G===n&&(_=p),(q=Y.nextSibling)!==null)break;Y=H,H=Y.parentNode}Y=q}a=y===-1||_===-1?null:{start:y,end:_}}else a=null}a=a||{start:0,end:0}}else a=null;for(Tr={focusedElem:e,selectionRange:a},mi=!1,Ie=t;Ie!==null;)if(t=Ie,e=t.child,(t.subtreeFlags&1024)!==0&&e!==null)e.return=t,Ie=e;else for(;Ie!==null;){switch(t=Ie,o=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&o!==null){e=void 0,a=t,l=o.memoizedProps,o=o.memoizedState,n=a.stateNode;try{var oe=tn(a.type,l,a.elementType===a.type);e=n.getSnapshotBeforeUpdate(oe,o),n.__reactInternalSnapshotBeforeUpdate=e}catch(re){De(a,a.return,re)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,a=e.nodeType,a===9)Rr(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Rr(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(u(163))}if(e=t.sibling,e!==null){e.return=t.return,Ie=e;break}Ie=t.return}}function Ld(e,t,a){var n=a.flags;switch(a.tag){case 0:case 11:case 15:Aa(e,a),n&4&&zl(5,a);break;case 1:if(Aa(e,a),n&4)if(e=a.stateNode,t===null)try{e.componentDidMount()}catch(p){De(a,a.return,p)}else{var l=tn(a.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(l,t,e.__reactInternalSnapshotBeforeUpdate)}catch(p){De(a,a.return,p)}}n&64&&zd(a),n&512&&Hl(a,a.return);break;case 3:if(Aa(e,a),n&64&&(e=a.updateQueue,e!==null)){if(t=null,a.child!==null)switch(a.child.tag){case 27:case 5:t=a.child.stateNode;break;case 1:t=a.child.stateNode}try{xo(e,t)}catch(p){De(a,a.return,p)}}break;case 27:t===null&&n&4&&Ud(a);case 26:case 5:Aa(e,a),t===null&&n&4&&qd(a),n&512&&Hl(a,a.return);break;case 12:Aa(e,a);break;case 13:Aa(e,a),n&4&&Pd(e,a),n&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=uh.bind(null,a),Ah(e,a))));break;case 22:if(n=a.memoizedState!==null||oa,!n){t=t!==null&&t.memoizedState!==null||Ge,l=oa;var o=Ge;oa=n,(Ge=t)&&!o?Ta(e,a,(a.subtreeFlags&8772)!==0):Aa(e,a),oa=l,Ge=o}break;case 30:break;default:Aa(e,a)}}function $d(e){var t=e.alternate;t!==null&&(e.alternate=null,$d(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Bi(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var He=null,pt=!1;function da(e,t,a){for(a=a.child;a!==null;)Gd(e,t,a),a=a.sibling}function Gd(e,t,a){if(bt&&typeof bt.onCommitFiberUnmount=="function")try{bt.onCommitFiberUnmount(tl,a)}catch{}switch(a.tag){case 26:Ge||Zt(a,t),da(e,t,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:Ge||Zt(a,t);var n=He,l=pt;Ha(a.type)&&(He=a.stateNode,pt=!1),da(e,t,a),Yl(a.stateNode),He=n,pt=l;break;case 5:Ge||Zt(a,t);case 6:if(n=He,l=pt,He=null,da(e,t,a),He=n,pt=l,He!==null)if(pt)try{(He.nodeType===9?He.body:He.nodeName==="HTML"?He.ownerDocument.body:He).removeChild(a.stateNode)}catch(o){De(a,t,o)}else try{He.removeChild(a.stateNode)}catch(o){De(a,t,o)}break;case 18:He!==null&&(pt?(e=He,Df(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),Il(e)):Df(He,a.stateNode));break;case 4:n=He,l=pt,He=a.stateNode.containerInfo,pt=!0,da(e,t,a),He=n,pt=l;break;case 0:case 11:case 14:case 15:Ge||Ea(2,a,t),Ge||Ea(4,a,t),da(e,t,a);break;case 1:Ge||(Zt(a,t),n=a.stateNode,typeof n.componentWillUnmount=="function"&&Hd(a,t,n)),da(e,t,a);break;case 21:da(e,t,a);break;case 22:Ge=(n=Ge)||a.memoizedState!==null,da(e,t,a),Ge=n;break;default:da(e,t,a)}}function Pd(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Il(e)}catch(a){De(t,t.return,a)}}function th(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new wd),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new wd),t;default:throw Error(u(435,e.tag))}}function lr(e,t){var a=th(e);t.forEach(function(n){var l=oh.bind(null,e,n);a.has(n)||(a.add(n),n.then(l,l))})}function _t(e,t){var a=t.deletions;if(a!==null)for(var n=0;n<a.length;n++){var l=a[n],o=e,p=t,y=p;e:for(;y!==null;){switch(y.tag){case 27:if(Ha(y.type)){He=y.stateNode,pt=!1;break e}break;case 5:He=y.stateNode,pt=!1;break e;case 3:case 4:He=y.stateNode.containerInfo,pt=!0;break e}y=y.return}if(He===null)throw Error(u(160));Gd(o,p,l),He=null,pt=!1,o=l.alternate,o!==null&&(o.return=null),l.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)Yd(t,e),t=t.sibling}var Yt=null;function Yd(e,t){var a=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:_t(t,e),Nt(e),n&4&&(Ea(3,e,e.return),zl(3,e),Ea(5,e,e.return));break;case 1:_t(t,e),Nt(e),n&512&&(Ge||a===null||Zt(a,a.return)),n&64&&oa&&(e=e.updateQueue,e!==null&&(n=e.callbacks,n!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?n:a.concat(n))));break;case 26:var l=Yt;if(_t(t,e),Nt(e),n&512&&(Ge||a===null||Zt(a,a.return)),n&4){var o=a!==null?a.memoizedState:null;if(n=e.memoizedState,a===null)if(n===null)if(e.stateNode===null){e:{n=e.type,a=e.memoizedProps,l=l.ownerDocument||l;t:switch(n){case"title":o=l.getElementsByTagName("title")[0],(!o||o[ll]||o[lt]||o.namespaceURI==="http://www.w3.org/2000/svg"||o.hasAttribute("itemprop"))&&(o=l.createElement(n),l.head.insertBefore(o,l.querySelector("head > title"))),at(o,n,a),o[lt]=e,Ke(o),n=o;break e;case"link":var p=wf("link","href",l).get(n+(a.href||""));if(p){for(var y=0;y<p.length;y++)if(o=p[y],o.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&o.getAttribute("rel")===(a.rel==null?null:a.rel)&&o.getAttribute("title")===(a.title==null?null:a.title)&&o.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){p.splice(y,1);break t}}o=l.createElement(n),at(o,n,a),l.head.appendChild(o);break;case"meta":if(p=wf("meta","content",l).get(n+(a.content||""))){for(y=0;y<p.length;y++)if(o=p[y],o.getAttribute("content")===(a.content==null?null:""+a.content)&&o.getAttribute("name")===(a.name==null?null:a.name)&&o.getAttribute("property")===(a.property==null?null:a.property)&&o.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&o.getAttribute("charset")===(a.charSet==null?null:a.charSet)){p.splice(y,1);break t}}o=l.createElement(n),at(o,n,a),l.head.appendChild(o);break;default:throw Error(u(468,n))}o[lt]=e,Ke(o),n=o}e.stateNode=n}else Lf(l,e.type,e.stateNode);else e.stateNode=Uf(l,n,e.memoizedProps);else o!==n?(o===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):o.count--,n===null?Lf(l,e.type,e.stateNode):Uf(l,n,e.memoizedProps)):n===null&&e.stateNode!==null&&er(e,e.memoizedProps,a.memoizedProps)}break;case 27:_t(t,e),Nt(e),n&512&&(Ge||a===null||Zt(a,a.return)),a!==null&&n&4&&er(e,e.memoizedProps,a.memoizedProps);break;case 5:if(_t(t,e),Nt(e),n&512&&(Ge||a===null||Zt(a,a.return)),e.flags&32){l=e.stateNode;try{vn(l,"")}catch(q){De(e,e.return,q)}}n&4&&e.stateNode!=null&&(l=e.memoizedProps,er(e,l,a!==null?a.memoizedProps:l)),n&1024&&(nr=!0);break;case 6:if(_t(t,e),Nt(e),n&4){if(e.stateNode===null)throw Error(u(162));n=e.memoizedProps,a=e.stateNode;try{a.nodeValue=n}catch(q){De(e,e.return,q)}}break;case 3:if(oi=null,l=Yt,Yt=ri(t.containerInfo),_t(t,e),Yt=l,Nt(e),n&4&&a!==null&&a.memoizedState.isDehydrated)try{Il(t.containerInfo)}catch(q){De(e,e.return,q)}nr&&(nr=!1,Xd(e));break;case 4:n=Yt,Yt=ri(e.stateNode.containerInfo),_t(t,e),Nt(e),Yt=n;break;case 12:_t(t,e),Nt(e);break;case 13:_t(t,e),Nt(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(or=Se()),n&4&&(n=e.updateQueue,n!==null&&(e.updateQueue=null,lr(e,n)));break;case 22:l=e.memoizedState!==null;var _=a!==null&&a.memoizedState!==null,z=oa,G=Ge;if(oa=z||l,Ge=G||_,_t(t,e),Ge=G,oa=z,Nt(e),n&8192)e:for(t=e.stateNode,t._visibility=l?t._visibility&-2:t._visibility|1,l&&(a===null||_||oa||Ge||an(e)),a=null,t=e;;){if(t.tag===5||t.tag===26){if(a===null){_=a=t;try{if(o=_.stateNode,l)p=o.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none";else{y=_.stateNode;var Y=_.memoizedProps.style,H=Y!=null&&Y.hasOwnProperty("display")?Y.display:null;y.style.display=H==null||typeof H=="boolean"?"":(""+H).trim()}}catch(q){De(_,_.return,q)}}}else if(t.tag===6){if(a===null){_=t;try{_.stateNode.nodeValue=l?"":_.memoizedProps}catch(q){De(_,_.return,q)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;a===t&&(a=null),t=t.return}a===t&&(a=null),t.sibling.return=t.return,t=t.sibling}n&4&&(n=e.updateQueue,n!==null&&(a=n.retryQueue,a!==null&&(n.retryQueue=null,lr(e,a))));break;case 19:_t(t,e),Nt(e),n&4&&(n=e.updateQueue,n!==null&&(e.updateQueue=null,lr(e,n)));break;case 30:break;case 21:break;default:_t(t,e),Nt(e)}}function Nt(e){var t=e.flags;if(t&2){try{for(var a,n=e.return;n!==null;){if(Bd(n)){a=n;break}n=n.return}if(a==null)throw Error(u(160));switch(a.tag){case 27:var l=a.stateNode,o=tr(e);Ks(e,o,l);break;case 5:var p=a.stateNode;a.flags&32&&(vn(p,""),a.flags&=-33);var y=tr(e);Ks(e,y,p);break;case 3:case 4:var _=a.stateNode.containerInfo,z=tr(e);ar(e,z,_);break;default:throw Error(u(161))}}catch(G){De(e,e.return,G)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Xd(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Xd(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Aa(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Ld(e,t.alternate,t),t=t.sibling}function an(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Ea(4,t,t.return),an(t);break;case 1:Zt(t,t.return);var a=t.stateNode;typeof a.componentWillUnmount=="function"&&Hd(t,t.return,a),an(t);break;case 27:Yl(t.stateNode);case 26:case 5:Zt(t,t.return),an(t);break;case 22:t.memoizedState===null&&an(t);break;case 30:an(t);break;default:an(t)}e=e.sibling}}function Ta(e,t,a){for(a=a&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var n=t.alternate,l=e,o=t,p=o.flags;switch(o.tag){case 0:case 11:case 15:Ta(l,o,a),zl(4,o);break;case 1:if(Ta(l,o,a),n=o,l=n.stateNode,typeof l.componentDidMount=="function")try{l.componentDidMount()}catch(z){De(n,n.return,z)}if(n=o,l=n.updateQueue,l!==null){var y=n.stateNode;try{var _=l.shared.hiddenCallbacks;if(_!==null)for(l.shared.hiddenCallbacks=null,l=0;l<_.length;l++)bo(_[l],y)}catch(z){De(n,n.return,z)}}a&&p&64&&zd(o),Hl(o,o.return);break;case 27:Ud(o);case 26:case 5:Ta(l,o,a),a&&n===null&&p&4&&qd(o),Hl(o,o.return);break;case 12:Ta(l,o,a);break;case 13:Ta(l,o,a),a&&p&4&&Pd(l,o);break;case 22:o.memoizedState===null&&Ta(l,o,a),Hl(o,o.return);break;case 30:break;default:Ta(l,o,a)}t=t.sibling}}function sr(e,t){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&bl(a))}function ir(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&bl(e))}function Kt(e,t,a,n){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Vd(e,t,a,n),t=t.sibling}function Vd(e,t,a,n){var l=t.flags;switch(t.tag){case 0:case 11:case 15:Kt(e,t,a,n),l&2048&&zl(9,t);break;case 1:Kt(e,t,a,n);break;case 3:Kt(e,t,a,n),l&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&bl(e)));break;case 12:if(l&2048){Kt(e,t,a,n),e=t.stateNode;try{var o=t.memoizedProps,p=o.id,y=o.onPostCommit;typeof y=="function"&&y(p,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(_){De(t,t.return,_)}}else Kt(e,t,a,n);break;case 13:Kt(e,t,a,n);break;case 23:break;case 22:o=t.stateNode,p=t.alternate,t.memoizedState!==null?o._visibility&2?Kt(e,t,a,n):ql(e,t):o._visibility&2?Kt(e,t,a,n):(o._visibility|=2,qn(e,t,a,n,(t.subtreeFlags&10256)!==0)),l&2048&&sr(p,t);break;case 24:Kt(e,t,a,n),l&2048&&ir(t.alternate,t);break;default:Kt(e,t,a,n)}}function qn(e,t,a,n,l){for(l=l&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var o=e,p=t,y=a,_=n,z=p.flags;switch(p.tag){case 0:case 11:case 15:qn(o,p,y,_,l),zl(8,p);break;case 23:break;case 22:var G=p.stateNode;p.memoizedState!==null?G._visibility&2?qn(o,p,y,_,l):ql(o,p):(G._visibility|=2,qn(o,p,y,_,l)),l&&z&2048&&sr(p.alternate,p);break;case 24:qn(o,p,y,_,l),l&&z&2048&&ir(p.alternate,p);break;default:qn(o,p,y,_,l)}t=t.sibling}}function ql(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var a=e,n=t,l=n.flags;switch(n.tag){case 22:ql(a,n),l&2048&&sr(n.alternate,n);break;case 24:ql(a,n),l&2048&&ir(n.alternate,n);break;default:ql(a,n)}t=t.sibling}}var Bl=8192;function Bn(e){if(e.subtreeFlags&Bl)for(e=e.child;e!==null;)kd(e),e=e.sibling}function kd(e){switch(e.tag){case 26:Bn(e),e.flags&Bl&&e.memoizedState!==null&&$h(Yt,e.memoizedState,e.memoizedProps);break;case 5:Bn(e);break;case 3:case 4:var t=Yt;Yt=ri(e.stateNode.containerInfo),Bn(e),Yt=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=Bl,Bl=16777216,Bn(e),Bl=t):Bn(e));break;default:Bn(e)}}function Qd(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Ul(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var n=t[a];Ie=n,Kd(n,e)}Qd(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Zd(e),e=e.sibling}function Zd(e){switch(e.tag){case 0:case 11:case 15:Ul(e),e.flags&2048&&Ea(9,e,e.return);break;case 3:Ul(e);break;case 12:Ul(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Js(e)):Ul(e);break;default:Ul(e)}}function Js(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var n=t[a];Ie=n,Kd(n,e)}Qd(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Ea(8,t,t.return),Js(t);break;case 22:a=t.stateNode,a._visibility&2&&(a._visibility&=-3,Js(t));break;default:Js(t)}e=e.sibling}}function Kd(e,t){for(;Ie!==null;){var a=Ie;switch(a.tag){case 0:case 11:case 15:Ea(8,a,t);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var n=a.memoizedState.cachePool.pool;n!=null&&n.refCount++}break;case 24:bl(a.memoizedState.cache)}if(n=a.child,n!==null)n.return=a,Ie=n;else e:for(a=e;Ie!==null;){n=Ie;var l=n.sibling,o=n.return;if($d(n),n===a){Ie=null;break e}if(l!==null){l.return=o,Ie=l;break e}Ie=o}}}var ah={getCacheForType:function(e){var t=st(Ve),a=t.data.get(e);return a===void 0&&(a=e(),t.data.set(e,a)),a}},nh=typeof WeakMap=="function"?WeakMap:Map,Ne=0,Re=null,ve=null,ye=0,Ce=0,Ct=null,Ma=!1,Un=!1,cr=!1,fa=0,we=0,Da=0,nn=0,rr=0,Bt=0,wn=0,wl=null,ht=null,ur=!1,or=0,Is=1/0,Ws=null,Ra=null,tt=0,Oa=null,Ln=null,$n=0,dr=0,fr=null,Jd=null,Ll=0,mr=null;function Et(){if((Ne&2)!==0&&ye!==0)return ye&-ye;if(j.T!==null){var e=An;return e!==0?e:xr()}return du()}function Id(){Bt===0&&(Bt=(ye&536870912)===0||je?cu():536870912);var e=qt.current;return e!==null&&(e.flags|=32),Bt}function At(e,t,a){(e===Re&&(Ce===2||Ce===9)||e.cancelPendingCommit!==null)&&(Gn(e,0),za(e,ye,Bt,!1)),nl(e,a),((Ne&2)===0||e!==Re)&&(e===Re&&((Ne&2)===0&&(nn|=a),we===4&&za(e,ye,Bt,!1)),Jt(e))}function Wd(e,t,a){if((Ne&6)!==0)throw Error(u(327));var n=!a&&(t&124)===0&&(t&e.expiredLanes)===0||al(e,t),l=n?ih(e,t):vr(e,t,!0),o=n;do{if(l===0){Un&&!n&&za(e,t,0,!1);break}else{if(a=e.current.alternate,o&&!lh(a)){l=vr(e,t,!1),o=!1;continue}if(l===2){if(o=t,e.errorRecoveryDisabledLanes&o)var p=0;else p=e.pendingLanes&-536870913,p=p!==0?p:p&536870912?536870912:0;if(p!==0){t=p;e:{var y=e;l=wl;var _=y.current.memoizedState.isDehydrated;if(_&&(Gn(y,p).flags|=256),p=vr(y,p,!1),p!==2){if(cr&&!_){y.errorRecoveryDisabledLanes|=o,nn|=o,l=4;break e}o=ht,ht=l,o!==null&&(ht===null?ht=o:ht.push.apply(ht,o))}l=p}if(o=!1,l!==2)continue}}if(l===1){Gn(e,0),za(e,t,0,!0);break}e:{switch(n=e,o=l,o){case 0:case 1:throw Error(u(345));case 4:if((t&4194048)!==t)break;case 6:za(n,t,Bt,!Ma);break e;case 2:ht=null;break;case 3:case 5:break;default:throw Error(u(329))}if((t&62914560)===t&&(l=or+300-Se(),10<l)){if(za(n,t,Bt,!Ma),us(n,0,!0)!==0)break e;n.timeoutHandle=Tf(Fd.bind(null,n,a,ht,Ws,ur,t,Bt,nn,wn,Ma,o,2,-0,0),l);break e}Fd(n,a,ht,Ws,ur,t,Bt,nn,wn,Ma,o,0,-0,0)}}break}while(!0);Jt(e)}function Fd(e,t,a,n,l,o,p,y,_,z,G,Y,H,q){if(e.timeoutHandle=-1,Y=t.subtreeFlags,(Y&8192||(Y&16785408)===16785408)&&(kl={stylesheets:null,count:0,unsuspend:Lh},kd(t),Y=Gh(),Y!==null)){e.cancelPendingCommit=Y(cf.bind(null,e,t,o,a,n,l,p,y,_,G,1,H,q)),za(e,o,p,!z);return}cf(e,t,o,a,n,l,p,y,_)}function lh(e){for(var t=e;;){var a=t.tag;if((a===0||a===11||a===15)&&t.flags&16384&&(a=t.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var n=0;n<a.length;n++){var l=a[n],o=l.getSnapshot;l=l.value;try{if(!St(o(),l))return!1}catch{return!1}}if(a=t.child,t.subtreeFlags&16384&&a!==null)a.return=t,t=a;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function za(e,t,a,n){t&=~rr,t&=~nn,e.suspendedLanes|=t,e.pingedLanes&=~t,n&&(e.warmLanes|=t),n=e.expirationTimes;for(var l=t;0<l;){var o=31-xt(l),p=1<<o;n[o]=-1,l&=~p}a!==0&&uu(e,a,t)}function Fs(){return(Ne&6)===0?($l(0),!1):!0}function pr(){if(ve!==null){if(Ce===0)var e=ve.return;else e=ve,la=Ia=null,Rc(e),zn=null,Dl=0,e=ve;for(;e!==null;)Od(e.alternate,e),e=e.return;ve=null}}function Gn(e,t){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,jh(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),pr(),Re=e,ve=a=ta(e.current,null),ye=t,Ce=0,Ct=null,Ma=!1,Un=al(e,t),cr=!1,wn=Bt=rr=nn=Da=we=0,ht=wl=null,ur=!1,(t&8)!==0&&(t|=t&32);var n=e.entangledLanes;if(n!==0)for(e=e.entanglements,n&=t;0<n;){var l=31-xt(n),o=1<<l;t|=e[l],n&=~o}return fa=t,Ss(),a}function ef(e,t){pe=null,j.H=$s,t===Sl||t===Ds?(t=go(),Ce=3):t===po?(t=go(),Ce=4):Ce=t===yd?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Ct=t,ve===null&&(we=1,Vs(e,Rt(t,e.current)))}function tf(){var e=j.H;return j.H=$s,e===null?$s:e}function af(){var e=j.A;return j.A=ah,e}function hr(){we=4,Ma||(ye&4194048)!==ye&&qt.current!==null||(Un=!0),(Da&134217727)===0&&(nn&134217727)===0||Re===null||za(Re,ye,Bt,!1)}function vr(e,t,a){var n=Ne;Ne|=2;var l=tf(),o=af();(Re!==e||ye!==t)&&(Ws=null,Gn(e,t)),t=!1;var p=we;e:do try{if(Ce!==0&&ve!==null){var y=ve,_=Ct;switch(Ce){case 8:pr(),p=6;break e;case 3:case 2:case 9:case 6:qt.current===null&&(t=!0);var z=Ce;if(Ce=0,Ct=null,Pn(e,y,_,z),a&&Un){p=0;break e}break;default:z=Ce,Ce=0,Ct=null,Pn(e,y,_,z)}}sh(),p=we;break}catch(G){ef(e,G)}while(!0);return t&&e.shellSuspendCounter++,la=Ia=null,Ne=n,j.H=l,j.A=o,ve===null&&(Re=null,ye=0,Ss()),p}function sh(){for(;ve!==null;)nf(ve)}function ih(e,t){var a=Ne;Ne|=2;var n=tf(),l=af();Re!==e||ye!==t?(Ws=null,Is=Se()+500,Gn(e,t)):Un=al(e,t);e:do try{if(Ce!==0&&ve!==null){t=ve;var o=Ct;t:switch(Ce){case 1:Ce=0,Ct=null,Pn(e,t,o,1);break;case 2:case 9:if(ho(o)){Ce=0,Ct=null,lf(t);break}t=function(){Ce!==2&&Ce!==9||Re!==e||(Ce=7),Jt(e)},o.then(t,t);break e;case 3:Ce=7;break e;case 4:Ce=5;break e;case 7:ho(o)?(Ce=0,Ct=null,lf(t)):(Ce=0,Ct=null,Pn(e,t,o,7));break;case 5:var p=null;switch(ve.tag){case 26:p=ve.memoizedState;case 5:case 27:var y=ve;if(!p||$f(p)){Ce=0,Ct=null;var _=y.sibling;if(_!==null)ve=_;else{var z=y.return;z!==null?(ve=z,ei(z)):ve=null}break t}}Ce=0,Ct=null,Pn(e,t,o,5);break;case 6:Ce=0,Ct=null,Pn(e,t,o,6);break;case 8:pr(),we=6;break e;default:throw Error(u(462))}}ch();break}catch(G){ef(e,G)}while(!0);return la=Ia=null,j.H=n,j.A=l,Ne=a,ve!==null?0:(Re=null,ye=0,Ss(),we)}function ch(){for(;ve!==null&&!nt();)nf(ve)}function nf(e){var t=Dd(e.alternate,e,fa);e.memoizedProps=e.pendingProps,t===null?ei(e):ve=t}function lf(e){var t=e,a=t.alternate;switch(t.tag){case 15:case 0:t=Nd(a,t,t.pendingProps,t.type,void 0,ye);break;case 11:t=Nd(a,t,t.pendingProps,t.type.render,t.ref,ye);break;case 5:Rc(t);default:Od(a,t),t=ve=lo(t,fa),t=Dd(a,t,fa)}e.memoizedProps=e.pendingProps,t===null?ei(e):ve=t}function Pn(e,t,a,n){la=Ia=null,Rc(t),zn=null,Dl=0;var l=t.return;try{if(Jp(e,l,t,a,ye)){we=1,Vs(e,Rt(a,e.current)),ve=null;return}}catch(o){if(l!==null)throw ve=l,o;we=1,Vs(e,Rt(a,e.current)),ve=null;return}t.flags&32768?(je||n===1?e=!0:Un||(ye&536870912)!==0?e=!1:(Ma=e=!0,(n===2||n===9||n===3||n===6)&&(n=qt.current,n!==null&&n.tag===13&&(n.flags|=16384))),sf(t,e)):ei(t)}function ei(e){var t=e;do{if((t.flags&32768)!==0){sf(t,Ma);return}e=t.return;var a=Wp(t.alternate,t,fa);if(a!==null){ve=a;return}if(t=t.sibling,t!==null){ve=t;return}ve=t=e}while(t!==null);we===0&&(we=5)}function sf(e,t){do{var a=Fp(e.alternate,e);if(a!==null){a.flags&=32767,ve=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!t&&(e=e.sibling,e!==null)){ve=e;return}ve=e=a}while(e!==null);we=6,ve=null}function cf(e,t,a,n,l,o,p,y,_){e.cancelPendingCommit=null;do ti();while(tt!==0);if((Ne&6)!==0)throw Error(u(327));if(t!==null){if(t===e.current)throw Error(u(177));if(o=t.lanes|t.childLanes,o|=ic,Lm(e,a,o,p,y,_),e===Re&&(ve=Re=null,ye=0),Ln=t,Oa=e,$n=a,dr=o,fr=l,Jd=n,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,dh(is,function(){return ff(),null})):(e.callbackNode=null,e.callbackPriority=0),n=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||n){n=j.T,j.T=null,l=L.p,L.p=2,p=Ne,Ne|=4;try{eh(e,t,a)}finally{Ne=p,L.p=l,j.T=n}}tt=1,rf(),uf(),of()}}function rf(){if(tt===1){tt=0;var e=Oa,t=Ln,a=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||a){a=j.T,j.T=null;var n=L.p;L.p=2;var l=Ne;Ne|=4;try{Yd(t,e);var o=Tr,p=Zu(e.containerInfo),y=o.focusedElem,_=o.selectionRange;if(p!==y&&y&&y.ownerDocument&&Qu(y.ownerDocument.documentElement,y)){if(_!==null&&tc(y)){var z=_.start,G=_.end;if(G===void 0&&(G=z),"selectionStart"in y)y.selectionStart=z,y.selectionEnd=Math.min(G,y.value.length);else{var Y=y.ownerDocument||document,H=Y&&Y.defaultView||window;if(H.getSelection){var q=H.getSelection(),oe=y.textContent.length,re=Math.min(_.start,oe),Me=_.end===void 0?re:Math.min(_.end,oe);!q.extend&&re>Me&&(p=Me,Me=re,re=p);var R=ku(y,re),T=ku(y,Me);if(R&&T&&(q.rangeCount!==1||q.anchorNode!==R.node||q.anchorOffset!==R.offset||q.focusNode!==T.node||q.focusOffset!==T.offset)){var O=Y.createRange();O.setStart(R.node,R.offset),q.removeAllRanges(),re>Me?(q.addRange(O),q.extend(T.node,T.offset)):(O.setEnd(T.node,T.offset),q.addRange(O))}}}}for(Y=[],q=y;q=q.parentNode;)q.nodeType===1&&Y.push({element:q,left:q.scrollLeft,top:q.scrollTop});for(typeof y.focus=="function"&&y.focus(),y=0;y<Y.length;y++){var P=Y[y];P.element.scrollLeft=P.left,P.element.scrollTop=P.top}}mi=!!Ar,Tr=Ar=null}finally{Ne=l,L.p=n,j.T=a}}e.current=t,tt=2}}function uf(){if(tt===2){tt=0;var e=Oa,t=Ln,a=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||a){a=j.T,j.T=null;var n=L.p;L.p=2;var l=Ne;Ne|=4;try{Ld(e,t.alternate,t)}finally{Ne=l,L.p=n,j.T=a}}tt=3}}function of(){if(tt===4||tt===3){tt=0,yt();var e=Oa,t=Ln,a=$n,n=Jd;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?tt=5:(tt=0,Ln=Oa=null,df(e,e.pendingLanes));var l=e.pendingLanes;if(l===0&&(Ra=null),Hi(a),t=t.stateNode,bt&&typeof bt.onCommitFiberRoot=="function")try{bt.onCommitFiberRoot(tl,t,void 0,(t.current.flags&128)===128)}catch{}if(n!==null){t=j.T,l=L.p,L.p=2,j.T=null;try{for(var o=e.onRecoverableError,p=0;p<n.length;p++){var y=n[p];o(y.value,{componentStack:y.stack})}}finally{j.T=t,L.p=l}}($n&3)!==0&&ti(),Jt(e),l=e.pendingLanes,(a&4194090)!==0&&(l&42)!==0?e===mr?Ll++:(Ll=0,mr=e):Ll=0,$l(0)}}function df(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,bl(t)))}function ti(e){return rf(),uf(),of(),ff()}function ff(){if(tt!==5)return!1;var e=Oa,t=dr;dr=0;var a=Hi($n),n=j.T,l=L.p;try{L.p=32>a?32:a,j.T=null,a=fr,fr=null;var o=Oa,p=$n;if(tt=0,Ln=Oa=null,$n=0,(Ne&6)!==0)throw Error(u(331));var y=Ne;if(Ne|=4,Zd(o.current),Vd(o,o.current,p,a),Ne=y,$l(0,!1),bt&&typeof bt.onPostCommitFiberRoot=="function")try{bt.onPostCommitFiberRoot(tl,o)}catch{}return!0}finally{L.p=l,j.T=n,df(e,t)}}function mf(e,t,a){t=Rt(a,t),t=Vc(e.stateNode,t,2),e=ja(e,t,2),e!==null&&(nl(e,2),Jt(e))}function De(e,t,a){if(e.tag===3)mf(e,e,a);else for(;t!==null;){if(t.tag===3){mf(t,e,a);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ra===null||!Ra.has(n))){e=Rt(a,e),a=vd(2),n=ja(t,a,2),n!==null&&(gd(a,n,t,e),nl(n,2),Jt(n));break}}t=t.return}}function gr(e,t,a){var n=e.pingCache;if(n===null){n=e.pingCache=new nh;var l=new Set;n.set(t,l)}else l=n.get(t),l===void 0&&(l=new Set,n.set(t,l));l.has(a)||(cr=!0,l.add(a),e=rh.bind(null,e,t,a),t.then(e,e))}function rh(e,t,a){var n=e.pingCache;n!==null&&n.delete(t),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,Re===e&&(ye&a)===a&&(we===4||we===3&&(ye&62914560)===ye&&300>Se()-or?(Ne&2)===0&&Gn(e,0):rr|=a,wn===ye&&(wn=0)),Jt(e)}function pf(e,t){t===0&&(t=ru()),e=_n(e,t),e!==null&&(nl(e,t),Jt(e))}function uh(e){var t=e.memoizedState,a=0;t!==null&&(a=t.retryLane),pf(e,a)}function oh(e,t){var a=0;switch(e.tag){case 13:var n=e.stateNode,l=e.memoizedState;l!==null&&(a=l.retryLane);break;case 19:n=e.stateNode;break;case 22:n=e.stateNode._retryCache;break;default:throw Error(u(314))}n!==null&&n.delete(t),pf(e,a)}function dh(e,t){return Fn(e,t)}var ai=null,Yn=null,yr=!1,ni=!1,br=!1,ln=0;function Jt(e){e!==Yn&&e.next===null&&(Yn===null?ai=Yn=e:Yn=Yn.next=e),ni=!0,yr||(yr=!0,mh())}function $l(e,t){if(!br&&ni){br=!0;do for(var a=!1,n=ai;n!==null;){if(e!==0){var l=n.pendingLanes;if(l===0)var o=0;else{var p=n.suspendedLanes,y=n.pingedLanes;o=(1<<31-xt(42|e)+1)-1,o&=l&~(p&~y),o=o&201326741?o&201326741|1:o?o|2:0}o!==0&&(a=!0,yf(n,o))}else o=ye,o=us(n,n===Re?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),(o&3)===0||al(n,o)||(a=!0,yf(n,o));n=n.next}while(a);br=!1}}function fh(){hf()}function hf(){ni=yr=!1;var e=0;ln!==0&&(Sh()&&(e=ln),ln=0);for(var t=Se(),a=null,n=ai;n!==null;){var l=n.next,o=vf(n,t);o===0?(n.next=null,a===null?ai=l:a.next=l,l===null&&(Yn=a)):(a=n,(e!==0||(o&3)!==0)&&(ni=!0)),n=l}$l(e)}function vf(e,t){for(var a=e.suspendedLanes,n=e.pingedLanes,l=e.expirationTimes,o=e.pendingLanes&-62914561;0<o;){var p=31-xt(o),y=1<<p,_=l[p];_===-1?((y&a)===0||(y&n)!==0)&&(l[p]=wm(y,t)):_<=t&&(e.expiredLanes|=y),o&=~y}if(t=Re,a=ye,a=us(e,e===t?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),n=e.callbackNode,a===0||e===t&&(Ce===2||Ce===9)||e.cancelPendingCommit!==null)return n!==null&&n!==null&&el(n),e.callbackNode=null,e.callbackPriority=0;if((a&3)===0||al(e,a)){if(t=a&-a,t===e.callbackPriority)return t;switch(n!==null&&el(n),Hi(a)){case 2:case 8:a=ss;break;case 32:a=is;break;case 268435456:a=iu;break;default:a=is}return n=gf.bind(null,e),a=Fn(a,n),e.callbackPriority=t,e.callbackNode=a,t}return n!==null&&n!==null&&el(n),e.callbackPriority=2,e.callbackNode=null,2}function gf(e,t){if(tt!==0&&tt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(ti()&&e.callbackNode!==a)return null;var n=ye;return n=us(e,e===Re?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),n===0?null:(Wd(e,n,t),vf(e,Se()),e.callbackNode!=null&&e.callbackNode===a?gf.bind(null,e):null)}function yf(e,t){if(ti())return null;Wd(e,t,!0)}function mh(){_h(function(){(Ne&6)!==0?Fn(Tt,fh):hf()})}function xr(){return ln===0&&(ln=cu()),ln}function bf(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ps(""+e)}function xf(e,t){var a=t.ownerDocument.createElement("input");return a.name=t.name,a.value=t.value,e.id&&a.setAttribute("form",e.id),t.parentNode.insertBefore(a,t),e=new FormData(e),a.parentNode.removeChild(a),e}function ph(e,t,a,n,l){if(t==="submit"&&a&&a.stateNode===l){var o=bf((l[dt]||null).action),p=n.submitter;p&&(t=(t=p[dt]||null)?bf(t.formAction):p.getAttribute("formAction"),t!==null&&(o=t,p=null));var y=new ys("action","action",null,n,l);e.push({event:y,listeners:[{instance:null,listener:function(){if(n.defaultPrevented){if(ln!==0){var _=p?xf(l,p):new FormData(l);$c(a,{pending:!0,data:_,method:l.method,action:o},null,_)}}else typeof o=="function"&&(y.preventDefault(),_=p?xf(l,p):new FormData(l),$c(a,{pending:!0,data:_,method:l.method,action:o},o,_))},currentTarget:l}]})}}for(var Sr=0;Sr<sc.length;Sr++){var jr=sc[Sr],hh=jr.toLowerCase(),vh=jr[0].toUpperCase()+jr.slice(1);Pt(hh,"on"+vh)}Pt(Iu,"onAnimationEnd"),Pt(Wu,"onAnimationIteration"),Pt(Fu,"onAnimationStart"),Pt("dblclick","onDoubleClick"),Pt("focusin","onFocus"),Pt("focusout","onBlur"),Pt(zp,"onTransitionRun"),Pt(Hp,"onTransitionStart"),Pt(qp,"onTransitionCancel"),Pt(eo,"onTransitionEnd"),mn("onMouseEnter",["mouseout","mouseover"]),mn("onMouseLeave",["mouseout","mouseover"]),mn("onPointerEnter",["pointerout","pointerover"]),mn("onPointerLeave",["pointerout","pointerover"]),Pa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Pa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Pa("onBeforeInput",["compositionend","keypress","textInput","paste"]),Pa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Pa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Pa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gh=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Gl));function Sf(e,t){t=(t&4)!==0;for(var a=0;a<e.length;a++){var n=e[a],l=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var p=n.length-1;0<=p;p--){var y=n[p],_=y.instance,z=y.currentTarget;if(y=y.listener,_!==o&&l.isPropagationStopped())break e;o=y,l.currentTarget=z;try{o(l)}catch(G){Xs(G)}l.currentTarget=null,o=_}else for(p=0;p<n.length;p++){if(y=n[p],_=y.instance,z=y.currentTarget,y=y.listener,_!==o&&l.isPropagationStopped())break e;o=y,l.currentTarget=z;try{o(l)}catch(G){Xs(G)}l.currentTarget=null,o=_}}}}function ge(e,t){var a=t[qi];a===void 0&&(a=t[qi]=new Set);var n=e+"__bubble";a.has(n)||(jf(t,e,2,!1),a.add(n))}function _r(e,t,a){var n=0;t&&(n|=4),jf(a,e,n,t)}var li="_reactListening"+Math.random().toString(36).slice(2);function Nr(e){if(!e[li]){e[li]=!0,mu.forEach(function(a){a!=="selectionchange"&&(gh.has(a)||_r(a,!1,e),_r(a,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[li]||(t[li]=!0,_r("selectionchange",!1,t))}}function jf(e,t,a,n){switch(kf(t)){case 2:var l=Xh;break;case 8:l=Vh;break;default:l=wr}a=l.bind(null,t,a,e),l=void 0,!ki||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(l=!0),n?l!==void 0?e.addEventListener(t,a,{capture:!0,passive:l}):e.addEventListener(t,a,!0):l!==void 0?e.addEventListener(t,a,{passive:l}):e.addEventListener(t,a,!1)}function Cr(e,t,a,n,l){var o=n;if((t&1)===0&&(t&2)===0&&n!==null)e:for(;;){if(n===null)return;var p=n.tag;if(p===3||p===4){var y=n.stateNode.containerInfo;if(y===l)break;if(p===4)for(p=n.return;p!==null;){var _=p.tag;if((_===3||_===4)&&p.stateNode.containerInfo===l)return;p=p.return}for(;y!==null;){if(p=on(y),p===null)return;if(_=p.tag,_===5||_===6||_===26||_===27){n=o=p;continue e}y=y.parentNode}}n=n.return}Au(function(){var z=o,G=Xi(a),Y=[];e:{var H=to.get(e);if(H!==void 0){var q=ys,oe=e;switch(e){case"keypress":if(vs(a)===0)break e;case"keydown":case"keyup":q=dp;break;case"focusin":oe="focus",q=Ji;break;case"focusout":oe="blur",q=Ji;break;case"beforeblur":case"afterblur":q=Ji;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":q=Du;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":q=Fm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":q=pp;break;case Iu:case Wu:case Fu:q=ap;break;case eo:q=vp;break;case"scroll":case"scrollend":q=Im;break;case"wheel":q=yp;break;case"copy":case"cut":case"paste":q=lp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":q=Ou;break;case"toggle":case"beforetoggle":q=xp}var re=(t&4)!==0,Me=!re&&(e==="scroll"||e==="scrollend"),R=re?H!==null?H+"Capture":null:H;re=[];for(var T=z,O;T!==null;){var P=T;if(O=P.stateNode,P=P.tag,P!==5&&P!==26&&P!==27||O===null||R===null||(P=il(T,R),P!=null&&re.push(Pl(T,P,O))),Me)break;T=T.return}0<re.length&&(H=new q(H,oe,null,a,G),Y.push({event:H,listeners:re}))}}if((t&7)===0){e:{if(H=e==="mouseover"||e==="pointerover",q=e==="mouseout"||e==="pointerout",H&&a!==Yi&&(oe=a.relatedTarget||a.fromElement)&&(on(oe)||oe[un]))break e;if((q||H)&&(H=G.window===G?G:(H=G.ownerDocument)?H.defaultView||H.parentWindow:window,q?(oe=a.relatedTarget||a.toElement,q=z,oe=oe?on(oe):null,oe!==null&&(Me=f(oe),re=oe.tag,oe!==Me||re!==5&&re!==27&&re!==6)&&(oe=null)):(q=null,oe=z),q!==oe)){if(re=Du,P="onMouseLeave",R="onMouseEnter",T="mouse",(e==="pointerout"||e==="pointerover")&&(re=Ou,P="onPointerLeave",R="onPointerEnter",T="pointer"),Me=q==null?H:sl(q),O=oe==null?H:sl(oe),H=new re(P,T+"leave",q,a,G),H.target=Me,H.relatedTarget=O,P=null,on(G)===z&&(re=new re(R,T+"enter",oe,a,G),re.target=O,re.relatedTarget=Me,P=re),Me=P,q&&oe)t:{for(re=q,R=oe,T=0,O=re;O;O=Xn(O))T++;for(O=0,P=R;P;P=Xn(P))O++;for(;0<T-O;)re=Xn(re),T--;for(;0<O-T;)R=Xn(R),O--;for(;T--;){if(re===R||R!==null&&re===R.alternate)break t;re=Xn(re),R=Xn(R)}re=null}else re=null;q!==null&&_f(Y,H,q,re,!1),oe!==null&&Me!==null&&_f(Y,Me,oe,re,!0)}}e:{if(H=z?sl(z):window,q=H.nodeName&&H.nodeName.toLowerCase(),q==="select"||q==="input"&&H.type==="file")var W=$u;else if(wu(H))if(Gu)W=Dp;else{W=Tp;var he=Ap}else q=H.nodeName,!q||q.toLowerCase()!=="input"||H.type!=="checkbox"&&H.type!=="radio"?z&&Pi(z.elementType)&&(W=$u):W=Mp;if(W&&(W=W(e,z))){Lu(Y,W,a,G);break e}he&&he(e,H,z),e==="focusout"&&z&&H.type==="number"&&z.memoizedProps.value!=null&&Gi(H,"number",H.value)}switch(he=z?sl(z):window,e){case"focusin":(wu(he)||he.contentEditable==="true")&&(xn=he,ac=z,pl=null);break;case"focusout":pl=ac=xn=null;break;case"mousedown":nc=!0;break;case"contextmenu":case"mouseup":case"dragend":nc=!1,Ku(Y,a,G);break;case"selectionchange":if(Op)break;case"keydown":case"keyup":Ku(Y,a,G)}var ne;if(Wi)e:{switch(e){case"compositionstart":var ue="onCompositionStart";break e;case"compositionend":ue="onCompositionEnd";break e;case"compositionupdate":ue="onCompositionUpdate";break e}ue=void 0}else bn?Bu(e,a)&&(ue="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(ue="onCompositionStart");ue&&(zu&&a.locale!=="ko"&&(bn||ue!=="onCompositionStart"?ue==="onCompositionEnd"&&bn&&(ne=Tu()):(ya=G,Qi="value"in ya?ya.value:ya.textContent,bn=!0)),he=si(z,ue),0<he.length&&(ue=new Ru(ue,e,null,a,G),Y.push({event:ue,listeners:he}),ne?ue.data=ne:(ne=Uu(a),ne!==null&&(ue.data=ne)))),(ne=jp?_p(e,a):Np(e,a))&&(ue=si(z,"onBeforeInput"),0<ue.length&&(he=new Ru("onBeforeInput","beforeinput",null,a,G),Y.push({event:he,listeners:ue}),he.data=ne)),ph(Y,e,z,a,G)}Sf(Y,t)})}function Pl(e,t,a){return{instance:e,listener:t,currentTarget:a}}function si(e,t){for(var a=t+"Capture",n=[];e!==null;){var l=e,o=l.stateNode;if(l=l.tag,l!==5&&l!==26&&l!==27||o===null||(l=il(e,a),l!=null&&n.unshift(Pl(e,l,o)),l=il(e,t),l!=null&&n.push(Pl(e,l,o))),e.tag===3)return n;e=e.return}return[]}function Xn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function _f(e,t,a,n,l){for(var o=t._reactName,p=[];a!==null&&a!==n;){var y=a,_=y.alternate,z=y.stateNode;if(y=y.tag,_!==null&&_===n)break;y!==5&&y!==26&&y!==27||z===null||(_=z,l?(z=il(a,o),z!=null&&p.unshift(Pl(a,z,_))):l||(z=il(a,o),z!=null&&p.push(Pl(a,z,_)))),a=a.return}p.length!==0&&e.push({event:t,listeners:p})}var yh=/\r\n?/g,bh=/\u0000|\uFFFD/g;function Nf(e){return(typeof e=="string"?e:""+e).replace(yh,`
`).replace(bh,"")}function Cf(e,t){return t=Nf(t),Nf(e)===t}function ii(){}function Te(e,t,a,n,l,o){switch(a){case"children":typeof n=="string"?t==="body"||t==="textarea"&&n===""||vn(e,n):(typeof n=="number"||typeof n=="bigint")&&t!=="body"&&vn(e,""+n);break;case"className":ds(e,"class",n);break;case"tabIndex":ds(e,"tabindex",n);break;case"dir":case"role":case"viewBox":case"width":case"height":ds(e,a,n);break;case"style":Cu(e,n,o);break;case"data":if(t!=="object"){ds(e,"data",n);break}case"src":case"href":if(n===""&&(t!=="a"||a!=="href")){e.removeAttribute(a);break}if(n==null||typeof n=="function"||typeof n=="symbol"||typeof n=="boolean"){e.removeAttribute(a);break}n=ps(""+n),e.setAttribute(a,n);break;case"action":case"formAction":if(typeof n=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof o=="function"&&(a==="formAction"?(t!=="input"&&Te(e,t,"name",l.name,l,null),Te(e,t,"formEncType",l.formEncType,l,null),Te(e,t,"formMethod",l.formMethod,l,null),Te(e,t,"formTarget",l.formTarget,l,null)):(Te(e,t,"encType",l.encType,l,null),Te(e,t,"method",l.method,l,null),Te(e,t,"target",l.target,l,null)));if(n==null||typeof n=="symbol"||typeof n=="boolean"){e.removeAttribute(a);break}n=ps(""+n),e.setAttribute(a,n);break;case"onClick":n!=null&&(e.onclick=ii);break;case"onScroll":n!=null&&ge("scroll",e);break;case"onScrollEnd":n!=null&&ge("scrollend",e);break;case"dangerouslySetInnerHTML":if(n!=null){if(typeof n!="object"||!("__html"in n))throw Error(u(61));if(a=n.__html,a!=null){if(l.children!=null)throw Error(u(60));e.innerHTML=a}}break;case"multiple":e.multiple=n&&typeof n!="function"&&typeof n!="symbol";break;case"muted":e.muted=n&&typeof n!="function"&&typeof n!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(n==null||typeof n=="function"||typeof n=="boolean"||typeof n=="symbol"){e.removeAttribute("xlink:href");break}a=ps(""+n),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":n!=null&&typeof n!="function"&&typeof n!="symbol"?e.setAttribute(a,""+n):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":n&&typeof n!="function"&&typeof n!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":n===!0?e.setAttribute(a,""):n!==!1&&n!=null&&typeof n!="function"&&typeof n!="symbol"?e.setAttribute(a,n):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":n!=null&&typeof n!="function"&&typeof n!="symbol"&&!isNaN(n)&&1<=n?e.setAttribute(a,n):e.removeAttribute(a);break;case"rowSpan":case"start":n==null||typeof n=="function"||typeof n=="symbol"||isNaN(n)?e.removeAttribute(a):e.setAttribute(a,n);break;case"popover":ge("beforetoggle",e),ge("toggle",e),os(e,"popover",n);break;case"xlinkActuate":Ft(e,"http://www.w3.org/1999/xlink","xlink:actuate",n);break;case"xlinkArcrole":Ft(e,"http://www.w3.org/1999/xlink","xlink:arcrole",n);break;case"xlinkRole":Ft(e,"http://www.w3.org/1999/xlink","xlink:role",n);break;case"xlinkShow":Ft(e,"http://www.w3.org/1999/xlink","xlink:show",n);break;case"xlinkTitle":Ft(e,"http://www.w3.org/1999/xlink","xlink:title",n);break;case"xlinkType":Ft(e,"http://www.w3.org/1999/xlink","xlink:type",n);break;case"xmlBase":Ft(e,"http://www.w3.org/XML/1998/namespace","xml:base",n);break;case"xmlLang":Ft(e,"http://www.w3.org/XML/1998/namespace","xml:lang",n);break;case"xmlSpace":Ft(e,"http://www.w3.org/XML/1998/namespace","xml:space",n);break;case"is":os(e,"is",n);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=Km.get(a)||a,os(e,a,n))}}function Er(e,t,a,n,l,o){switch(a){case"style":Cu(e,n,o);break;case"dangerouslySetInnerHTML":if(n!=null){if(typeof n!="object"||!("__html"in n))throw Error(u(61));if(a=n.__html,a!=null){if(l.children!=null)throw Error(u(60));e.innerHTML=a}}break;case"children":typeof n=="string"?vn(e,n):(typeof n=="number"||typeof n=="bigint")&&vn(e,""+n);break;case"onScroll":n!=null&&ge("scroll",e);break;case"onScrollEnd":n!=null&&ge("scrollend",e);break;case"onClick":n!=null&&(e.onclick=ii);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!pu.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(l=a.endsWith("Capture"),t=a.slice(2,l?a.length-7:void 0),o=e[dt]||null,o=o!=null?o[a]:null,typeof o=="function"&&e.removeEventListener(t,o,l),typeof n=="function")){typeof o!="function"&&o!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(t,n,l);break e}a in e?e[a]=n:n===!0?e.setAttribute(a,""):os(e,a,n)}}}function at(e,t,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ge("error",e),ge("load",e);var n=!1,l=!1,o;for(o in a)if(a.hasOwnProperty(o)){var p=a[o];if(p!=null)switch(o){case"src":n=!0;break;case"srcSet":l=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(u(137,t));default:Te(e,t,o,p,a,null)}}l&&Te(e,t,"srcSet",a.srcSet,a,null),n&&Te(e,t,"src",a.src,a,null);return;case"input":ge("invalid",e);var y=o=p=l=null,_=null,z=null;for(n in a)if(a.hasOwnProperty(n)){var G=a[n];if(G!=null)switch(n){case"name":l=G;break;case"type":p=G;break;case"checked":_=G;break;case"defaultChecked":z=G;break;case"value":o=G;break;case"defaultValue":y=G;break;case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(u(137,t));break;default:Te(e,t,n,G,a,null)}}Su(e,o,y,_,z,p,l,!1),fs(e);return;case"select":ge("invalid",e),n=p=o=null;for(l in a)if(a.hasOwnProperty(l)&&(y=a[l],y!=null))switch(l){case"value":o=y;break;case"defaultValue":p=y;break;case"multiple":n=y;default:Te(e,t,l,y,a,null)}t=o,a=p,e.multiple=!!n,t!=null?hn(e,!!n,t,!1):a!=null&&hn(e,!!n,a,!0);return;case"textarea":ge("invalid",e),o=l=n=null;for(p in a)if(a.hasOwnProperty(p)&&(y=a[p],y!=null))switch(p){case"value":n=y;break;case"defaultValue":l=y;break;case"children":o=y;break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(u(91));break;default:Te(e,t,p,y,a,null)}_u(e,n,l,o),fs(e);return;case"option":for(_ in a)if(a.hasOwnProperty(_)&&(n=a[_],n!=null))switch(_){case"selected":e.selected=n&&typeof n!="function"&&typeof n!="symbol";break;default:Te(e,t,_,n,a,null)}return;case"dialog":ge("beforetoggle",e),ge("toggle",e),ge("cancel",e),ge("close",e);break;case"iframe":case"object":ge("load",e);break;case"video":case"audio":for(n=0;n<Gl.length;n++)ge(Gl[n],e);break;case"image":ge("error",e),ge("load",e);break;case"details":ge("toggle",e);break;case"embed":case"source":case"link":ge("error",e),ge("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(z in a)if(a.hasOwnProperty(z)&&(n=a[z],n!=null))switch(z){case"children":case"dangerouslySetInnerHTML":throw Error(u(137,t));default:Te(e,t,z,n,a,null)}return;default:if(Pi(t)){for(G in a)a.hasOwnProperty(G)&&(n=a[G],n!==void 0&&Er(e,t,G,n,a,void 0));return}}for(y in a)a.hasOwnProperty(y)&&(n=a[y],n!=null&&Te(e,t,y,n,a,null))}function xh(e,t,a,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var l=null,o=null,p=null,y=null,_=null,z=null,G=null;for(q in a){var Y=a[q];if(a.hasOwnProperty(q)&&Y!=null)switch(q){case"checked":break;case"value":break;case"defaultValue":_=Y;default:n.hasOwnProperty(q)||Te(e,t,q,null,n,Y)}}for(var H in n){var q=n[H];if(Y=a[H],n.hasOwnProperty(H)&&(q!=null||Y!=null))switch(H){case"type":o=q;break;case"name":l=q;break;case"checked":z=q;break;case"defaultChecked":G=q;break;case"value":p=q;break;case"defaultValue":y=q;break;case"children":case"dangerouslySetInnerHTML":if(q!=null)throw Error(u(137,t));break;default:q!==Y&&Te(e,t,H,q,n,Y)}}$i(e,p,y,_,z,G,o,l);return;case"select":q=p=y=H=null;for(o in a)if(_=a[o],a.hasOwnProperty(o)&&_!=null)switch(o){case"value":break;case"multiple":q=_;default:n.hasOwnProperty(o)||Te(e,t,o,null,n,_)}for(l in n)if(o=n[l],_=a[l],n.hasOwnProperty(l)&&(o!=null||_!=null))switch(l){case"value":H=o;break;case"defaultValue":y=o;break;case"multiple":p=o;default:o!==_&&Te(e,t,l,o,n,_)}t=y,a=p,n=q,H!=null?hn(e,!!a,H,!1):!!n!=!!a&&(t!=null?hn(e,!!a,t,!0):hn(e,!!a,a?[]:"",!1));return;case"textarea":q=H=null;for(y in a)if(l=a[y],a.hasOwnProperty(y)&&l!=null&&!n.hasOwnProperty(y))switch(y){case"value":break;case"children":break;default:Te(e,t,y,null,n,l)}for(p in n)if(l=n[p],o=a[p],n.hasOwnProperty(p)&&(l!=null||o!=null))switch(p){case"value":H=l;break;case"defaultValue":q=l;break;case"children":break;case"dangerouslySetInnerHTML":if(l!=null)throw Error(u(91));break;default:l!==o&&Te(e,t,p,l,n,o)}ju(e,H,q);return;case"option":for(var oe in a)if(H=a[oe],a.hasOwnProperty(oe)&&H!=null&&!n.hasOwnProperty(oe))switch(oe){case"selected":e.selected=!1;break;default:Te(e,t,oe,null,n,H)}for(_ in n)if(H=n[_],q=a[_],n.hasOwnProperty(_)&&H!==q&&(H!=null||q!=null))switch(_){case"selected":e.selected=H&&typeof H!="function"&&typeof H!="symbol";break;default:Te(e,t,_,H,n,q)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var re in a)H=a[re],a.hasOwnProperty(re)&&H!=null&&!n.hasOwnProperty(re)&&Te(e,t,re,null,n,H);for(z in n)if(H=n[z],q=a[z],n.hasOwnProperty(z)&&H!==q&&(H!=null||q!=null))switch(z){case"children":case"dangerouslySetInnerHTML":if(H!=null)throw Error(u(137,t));break;default:Te(e,t,z,H,n,q)}return;default:if(Pi(t)){for(var Me in a)H=a[Me],a.hasOwnProperty(Me)&&H!==void 0&&!n.hasOwnProperty(Me)&&Er(e,t,Me,void 0,n,H);for(G in n)H=n[G],q=a[G],!n.hasOwnProperty(G)||H===q||H===void 0&&q===void 0||Er(e,t,G,H,n,q);return}}for(var R in a)H=a[R],a.hasOwnProperty(R)&&H!=null&&!n.hasOwnProperty(R)&&Te(e,t,R,null,n,H);for(Y in n)H=n[Y],q=a[Y],!n.hasOwnProperty(Y)||H===q||H==null&&q==null||Te(e,t,Y,H,n,q)}var Ar=null,Tr=null;function ci(e){return e.nodeType===9?e:e.ownerDocument}function Ef(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Af(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Mr(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Dr=null;function Sh(){var e=window.event;return e&&e.type==="popstate"?e===Dr?!1:(Dr=e,!0):(Dr=null,!1)}var Tf=typeof setTimeout=="function"?setTimeout:void 0,jh=typeof clearTimeout=="function"?clearTimeout:void 0,Mf=typeof Promise=="function"?Promise:void 0,_h=typeof queueMicrotask=="function"?queueMicrotask:typeof Mf<"u"?function(e){return Mf.resolve(null).then(e).catch(Nh)}:Tf;function Nh(e){setTimeout(function(){throw e})}function Ha(e){return e==="head"}function Df(e,t){var a=t,n=0,l=0;do{var o=a.nextSibling;if(e.removeChild(a),o&&o.nodeType===8)if(a=o.data,a==="/$"){if(0<n&&8>n){a=n;var p=e.ownerDocument;if(a&1&&Yl(p.documentElement),a&2&&Yl(p.body),a&4)for(a=p.head,Yl(a),p=a.firstChild;p;){var y=p.nextSibling,_=p.nodeName;p[ll]||_==="SCRIPT"||_==="STYLE"||_==="LINK"&&p.rel.toLowerCase()==="stylesheet"||a.removeChild(p),p=y}}if(l===0){e.removeChild(o),Il(t);return}l--}else a==="$"||a==="$?"||a==="$!"?l++:n=a.charCodeAt(0)-48;else n=0;a=o}while(a);Il(t)}function Rr(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var a=t;switch(t=t.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":Rr(a),Bi(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function Ch(e,t,a,n){for(;e.nodeType===1;){var l=a;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!n&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(n){if(!e[ll])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(o=e.getAttribute("rel"),o==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(o!==l.rel||e.getAttribute("href")!==(l.href==null||l.href===""?null:l.href)||e.getAttribute("crossorigin")!==(l.crossOrigin==null?null:l.crossOrigin)||e.getAttribute("title")!==(l.title==null?null:l.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(o=e.getAttribute("src"),(o!==(l.src==null?null:l.src)||e.getAttribute("type")!==(l.type==null?null:l.type)||e.getAttribute("crossorigin")!==(l.crossOrigin==null?null:l.crossOrigin))&&o&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var o=l.name==null?null:""+l.name;if(l.type==="hidden"&&e.getAttribute("name")===o)return e}else return e;if(e=Xt(e.nextSibling),e===null)break}return null}function Eh(e,t,a){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=Xt(e.nextSibling),e===null))return null;return e}function Or(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function Ah(e,t){var a=e.ownerDocument;if(e.data!=="$?"||a.readyState==="complete")t();else{var n=function(){t(),a.removeEventListener("DOMContentLoaded",n)};a.addEventListener("DOMContentLoaded",n),e._reactRetry=n}}function Xt(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}var zr=null;function Rf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(t===0)return e;t--}else a==="/$"&&t++}e=e.previousSibling}return null}function Of(e,t,a){switch(t=ci(a),e){case"html":if(e=t.documentElement,!e)throw Error(u(452));return e;case"head":if(e=t.head,!e)throw Error(u(453));return e;case"body":if(e=t.body,!e)throw Error(u(454));return e;default:throw Error(u(451))}}function Yl(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Bi(e)}var Ut=new Map,zf=new Set;function ri(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ma=L.d;L.d={f:Th,r:Mh,D:Dh,C:Rh,L:Oh,m:zh,X:qh,S:Hh,M:Bh};function Th(){var e=ma.f(),t=Fs();return e||t}function Mh(e){var t=dn(e);t!==null&&t.tag===5&&t.type==="form"?Wo(t):ma.r(e)}var Vn=typeof document>"u"?null:document;function Hf(e,t,a){var n=Vn;if(n&&typeof t=="string"&&t){var l=Dt(t);l='link[rel="'+e+'"][href="'+l+'"]',typeof a=="string"&&(l+='[crossorigin="'+a+'"]'),zf.has(l)||(zf.add(l),e={rel:e,crossOrigin:a,href:t},n.querySelector(l)===null&&(t=n.createElement("link"),at(t,"link",e),Ke(t),n.head.appendChild(t)))}}function Dh(e){ma.D(e),Hf("dns-prefetch",e,null)}function Rh(e,t){ma.C(e,t),Hf("preconnect",e,t)}function Oh(e,t,a){ma.L(e,t,a);var n=Vn;if(n&&e&&t){var l='link[rel="preload"][as="'+Dt(t)+'"]';t==="image"&&a&&a.imageSrcSet?(l+='[imagesrcset="'+Dt(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(l+='[imagesizes="'+Dt(a.imageSizes)+'"]')):l+='[href="'+Dt(e)+'"]';var o=l;switch(t){case"style":o=kn(e);break;case"script":o=Qn(e)}Ut.has(o)||(e=b({rel:"preload",href:t==="image"&&a&&a.imageSrcSet?void 0:e,as:t},a),Ut.set(o,e),n.querySelector(l)!==null||t==="style"&&n.querySelector(Xl(o))||t==="script"&&n.querySelector(Vl(o))||(t=n.createElement("link"),at(t,"link",e),Ke(t),n.head.appendChild(t)))}}function zh(e,t){ma.m(e,t);var a=Vn;if(a&&e){var n=t&&typeof t.as=="string"?t.as:"script",l='link[rel="modulepreload"][as="'+Dt(n)+'"][href="'+Dt(e)+'"]',o=l;switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=Qn(e)}if(!Ut.has(o)&&(e=b({rel:"modulepreload",href:e},t),Ut.set(o,e),a.querySelector(l)===null)){switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Vl(o)))return}n=a.createElement("link"),at(n,"link",e),Ke(n),a.head.appendChild(n)}}}function Hh(e,t,a){ma.S(e,t,a);var n=Vn;if(n&&e){var l=fn(n).hoistableStyles,o=kn(e);t=t||"default";var p=l.get(o);if(!p){var y={loading:0,preload:null};if(p=n.querySelector(Xl(o)))y.loading=5;else{e=b({rel:"stylesheet",href:e,"data-precedence":t},a),(a=Ut.get(o))&&Hr(e,a);var _=p=n.createElement("link");Ke(_),at(_,"link",e),_._p=new Promise(function(z,G){_.onload=z,_.onerror=G}),_.addEventListener("load",function(){y.loading|=1}),_.addEventListener("error",function(){y.loading|=2}),y.loading|=4,ui(p,t,n)}p={type:"stylesheet",instance:p,count:1,state:y},l.set(o,p)}}}function qh(e,t){ma.X(e,t);var a=Vn;if(a&&e){var n=fn(a).hoistableScripts,l=Qn(e),o=n.get(l);o||(o=a.querySelector(Vl(l)),o||(e=b({src:e,async:!0},t),(t=Ut.get(l))&&qr(e,t),o=a.createElement("script"),Ke(o),at(o,"link",e),a.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},n.set(l,o))}}function Bh(e,t){ma.M(e,t);var a=Vn;if(a&&e){var n=fn(a).hoistableScripts,l=Qn(e),o=n.get(l);o||(o=a.querySelector(Vl(l)),o||(e=b({src:e,async:!0,type:"module"},t),(t=Ut.get(l))&&qr(e,t),o=a.createElement("script"),Ke(o),at(o,"link",e),a.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},n.set(l,o))}}function qf(e,t,a,n){var l=(l=ce.current)?ri(l):null;if(!l)throw Error(u(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(t=kn(a.href),a=fn(l).hoistableStyles,n=a.get(t),n||(n={type:"style",instance:null,count:0,state:null},a.set(t,n)),n):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=kn(a.href);var o=fn(l).hoistableStyles,p=o.get(e);if(p||(l=l.ownerDocument||l,p={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},o.set(e,p),(o=l.querySelector(Xl(e)))&&!o._p&&(p.instance=o,p.state.loading=5),Ut.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},Ut.set(e,a),o||Uh(l,e,a,p.state))),t&&n===null)throw Error(u(528,""));return p}if(t&&n!==null)throw Error(u(529,""));return null;case"script":return t=a.async,a=a.src,typeof a=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Qn(a),a=fn(l).hoistableScripts,n=a.get(t),n||(n={type:"script",instance:null,count:0,state:null},a.set(t,n)),n):{type:"void",instance:null,count:0,state:null};default:throw Error(u(444,e))}}function kn(e){return'href="'+Dt(e)+'"'}function Xl(e){return'link[rel="stylesheet"]['+e+"]"}function Bf(e){return b({},e,{"data-precedence":e.precedence,precedence:null})}function Uh(e,t,a,n){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?n.loading=1:(t=e.createElement("link"),n.preload=t,t.addEventListener("load",function(){return n.loading|=1}),t.addEventListener("error",function(){return n.loading|=2}),at(t,"link",a),Ke(t),e.head.appendChild(t))}function Qn(e){return'[src="'+Dt(e)+'"]'}function Vl(e){return"script[async]"+e}function Uf(e,t,a){if(t.count++,t.instance===null)switch(t.type){case"style":var n=e.querySelector('style[data-href~="'+Dt(a.href)+'"]');if(n)return t.instance=n,Ke(n),n;var l=b({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return n=(e.ownerDocument||e).createElement("style"),Ke(n),at(n,"style",l),ui(n,a.precedence,e),t.instance=n;case"stylesheet":l=kn(a.href);var o=e.querySelector(Xl(l));if(o)return t.state.loading|=4,t.instance=o,Ke(o),o;n=Bf(a),(l=Ut.get(l))&&Hr(n,l),o=(e.ownerDocument||e).createElement("link"),Ke(o);var p=o;return p._p=new Promise(function(y,_){p.onload=y,p.onerror=_}),at(o,"link",n),t.state.loading|=4,ui(o,a.precedence,e),t.instance=o;case"script":return o=Qn(a.src),(l=e.querySelector(Vl(o)))?(t.instance=l,Ke(l),l):(n=a,(l=Ut.get(o))&&(n=b({},a),qr(n,l)),e=e.ownerDocument||e,l=e.createElement("script"),Ke(l),at(l,"link",n),e.head.appendChild(l),t.instance=l);case"void":return null;default:throw Error(u(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(n=t.instance,t.state.loading|=4,ui(n,a.precedence,e));return t.instance}function ui(e,t,a){for(var n=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),l=n.length?n[n.length-1]:null,o=l,p=0;p<n.length;p++){var y=n[p];if(y.dataset.precedence===t)o=y;else if(o!==l)break}o?o.parentNode.insertBefore(e,o.nextSibling):(t=a.nodeType===9?a.head:a,t.insertBefore(e,t.firstChild))}function Hr(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function qr(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var oi=null;function wf(e,t,a){if(oi===null){var n=new Map,l=oi=new Map;l.set(a,n)}else l=oi,n=l.get(a),n||(n=new Map,l.set(a,n));if(n.has(e))return n;for(n.set(e,null),a=a.getElementsByTagName(e),l=0;l<a.length;l++){var o=a[l];if(!(o[ll]||o[lt]||e==="link"&&o.getAttribute("rel")==="stylesheet")&&o.namespaceURI!=="http://www.w3.org/2000/svg"){var p=o.getAttribute(t)||"";p=e+p;var y=n.get(p);y?y.push(o):n.set(p,[o])}}return n}function Lf(e,t,a){e=e.ownerDocument||e,e.head.insertBefore(a,t==="title"?e.querySelector("head > title"):null)}function wh(e,t,a){if(a===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function $f(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var kl=null;function Lh(){}function $h(e,t,a){if(kl===null)throw Error(u(475));var n=kl;if(t.type==="stylesheet"&&(typeof a.media!="string"||matchMedia(a.media).matches!==!1)&&(t.state.loading&4)===0){if(t.instance===null){var l=kn(a.href),o=e.querySelector(Xl(l));if(o){e=o._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(n.count++,n=di.bind(n),e.then(n,n)),t.state.loading|=4,t.instance=o,Ke(o);return}o=e.ownerDocument||e,a=Bf(a),(l=Ut.get(l))&&Hr(a,l),o=o.createElement("link"),Ke(o);var p=o;p._p=new Promise(function(y,_){p.onload=y,p.onerror=_}),at(o,"link",a),t.instance=o}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(t,e),(e=t.state.preload)&&(t.state.loading&3)===0&&(n.count++,t=di.bind(n),e.addEventListener("load",t),e.addEventListener("error",t))}}function Gh(){if(kl===null)throw Error(u(475));var e=kl;return e.stylesheets&&e.count===0&&Br(e,e.stylesheets),0<e.count?function(t){var a=setTimeout(function(){if(e.stylesheets&&Br(e,e.stylesheets),e.unsuspend){var n=e.unsuspend;e.unsuspend=null,n()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(a)}}:null}function di(){if(this.count--,this.count===0){if(this.stylesheets)Br(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var fi=null;function Br(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,fi=new Map,t.forEach(Ph,e),fi=null,di.call(e))}function Ph(e,t){if(!(t.state.loading&4)){var a=fi.get(e);if(a)var n=a.get(null);else{a=new Map,fi.set(e,a);for(var l=e.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<l.length;o++){var p=l[o];(p.nodeName==="LINK"||p.getAttribute("media")!=="not all")&&(a.set(p.dataset.precedence,p),n=p)}n&&a.set(null,n)}l=t.instance,p=l.getAttribute("data-precedence"),o=a.get(p)||n,o===n&&a.set(null,l),a.set(p,l),this.count++,n=di.bind(this),l.addEventListener("load",n),l.addEventListener("error",n),o?o.parentNode.insertBefore(l,o.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(l,e.firstChild)),t.state.loading|=4}}var Ql={$$typeof:V,Provider:null,Consumer:null,_currentValue:X,_currentValue2:X,_threadCount:0};function Yh(e,t,a,n,l,o,p,y){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Oi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oi(0),this.hiddenUpdates=Oi(null),this.identifierPrefix=n,this.onUncaughtError=l,this.onCaughtError=o,this.onRecoverableError=p,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=y,this.incompleteTransitions=new Map}function Gf(e,t,a,n,l,o,p,y,_,z,G,Y){return e=new Yh(e,t,a,p,y,_,z,Y),t=1,o===!0&&(t|=24),o=jt(3,null,null,t),e.current=o,o.stateNode=e,t=gc(),t.refCount++,e.pooledCache=t,t.refCount++,o.memoizedState={element:n,isDehydrated:a,cache:t},Sc(o),e}function Pf(e){return e?(e=Nn,e):Nn}function Yf(e,t,a,n,l,o){l=Pf(l),n.context===null?n.context=l:n.pendingContext=l,n=Sa(t),n.payload={element:a},o=o===void 0?null:o,o!==null&&(n.callback=o),a=ja(e,n,t),a!==null&&(At(a,e,t),_l(a,e,t))}function Xf(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<t?a:t}}function Ur(e,t){Xf(e,t),(e=e.alternate)&&Xf(e,t)}function Vf(e){if(e.tag===13){var t=_n(e,67108864);t!==null&&At(t,e,67108864),Ur(e,67108864)}}var mi=!0;function Xh(e,t,a,n){var l=j.T;j.T=null;var o=L.p;try{L.p=2,wr(e,t,a,n)}finally{L.p=o,j.T=l}}function Vh(e,t,a,n){var l=j.T;j.T=null;var o=L.p;try{L.p=8,wr(e,t,a,n)}finally{L.p=o,j.T=l}}function wr(e,t,a,n){if(mi){var l=Lr(n);if(l===null)Cr(e,t,n,pi,a),Qf(e,n);else if(Qh(l,e,t,a,n))n.stopPropagation();else if(Qf(e,n),t&4&&-1<kh.indexOf(e)){for(;l!==null;){var o=dn(l);if(o!==null)switch(o.tag){case 3:if(o=o.stateNode,o.current.memoizedState.isDehydrated){var p=Ga(o.pendingLanes);if(p!==0){var y=o;for(y.pendingLanes|=2,y.entangledLanes|=2;p;){var _=1<<31-xt(p);y.entanglements[1]|=_,p&=~_}Jt(o),(Ne&6)===0&&(Is=Se()+500,$l(0))}}break;case 13:y=_n(o,2),y!==null&&At(y,o,2),Fs(),Ur(o,2)}if(o=Lr(n),o===null&&Cr(e,t,n,pi,a),o===l)break;l=o}l!==null&&n.stopPropagation()}else Cr(e,t,n,null,a)}}function Lr(e){return e=Xi(e),$r(e)}var pi=null;function $r(e){if(pi=null,e=on(e),e!==null){var t=f(e);if(t===null)e=null;else{var a=t.tag;if(a===13){if(e=h(t),e!==null)return e;e=null}else if(a===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return pi=e,null}function kf(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ct()){case Tt:return 2;case ss:return 8;case is:case Om:return 32;case iu:return 268435456;default:return 32}default:return 32}}var Gr=!1,qa=null,Ba=null,Ua=null,Zl=new Map,Kl=new Map,wa=[],kh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Qf(e,t){switch(e){case"focusin":case"focusout":qa=null;break;case"dragenter":case"dragleave":Ba=null;break;case"mouseover":case"mouseout":Ua=null;break;case"pointerover":case"pointerout":Zl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kl.delete(t.pointerId)}}function Jl(e,t,a,n,l,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:a,eventSystemFlags:n,nativeEvent:o,targetContainers:[l]},t!==null&&(t=dn(t),t!==null&&Vf(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,l!==null&&t.indexOf(l)===-1&&t.push(l),e)}function Qh(e,t,a,n,l){switch(t){case"focusin":return qa=Jl(qa,e,t,a,n,l),!0;case"dragenter":return Ba=Jl(Ba,e,t,a,n,l),!0;case"mouseover":return Ua=Jl(Ua,e,t,a,n,l),!0;case"pointerover":var o=l.pointerId;return Zl.set(o,Jl(Zl.get(o)||null,e,t,a,n,l)),!0;case"gotpointercapture":return o=l.pointerId,Kl.set(o,Jl(Kl.get(o)||null,e,t,a,n,l)),!0}return!1}function Zf(e){var t=on(e.target);if(t!==null){var a=f(t);if(a!==null){if(t=a.tag,t===13){if(t=h(a),t!==null){e.blockedOn=t,$m(e.priority,function(){if(a.tag===13){var n=Et();n=zi(n);var l=_n(a,n);l!==null&&At(l,a,n),Ur(a,n)}});return}}else if(t===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function hi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var a=Lr(e.nativeEvent);if(a===null){a=e.nativeEvent;var n=new a.constructor(a.type,a);Yi=n,a.target.dispatchEvent(n),Yi=null}else return t=dn(a),t!==null&&Vf(t),e.blockedOn=a,!1;t.shift()}return!0}function Kf(e,t,a){hi(e)&&a.delete(t)}function Zh(){Gr=!1,qa!==null&&hi(qa)&&(qa=null),Ba!==null&&hi(Ba)&&(Ba=null),Ua!==null&&hi(Ua)&&(Ua=null),Zl.forEach(Kf),Kl.forEach(Kf)}function vi(e,t){e.blockedOn===t&&(e.blockedOn=null,Gr||(Gr=!0,c.unstable_scheduleCallback(c.unstable_NormalPriority,Zh)))}var gi=null;function Jf(e){gi!==e&&(gi=e,c.unstable_scheduleCallback(c.unstable_NormalPriority,function(){gi===e&&(gi=null);for(var t=0;t<e.length;t+=3){var a=e[t],n=e[t+1],l=e[t+2];if(typeof n!="function"){if($r(n||a)===null)continue;break}var o=dn(a);o!==null&&(e.splice(t,3),t-=3,$c(o,{pending:!0,data:l,method:a.method,action:n},n,l))}}))}function Il(e){function t(_){return vi(_,e)}qa!==null&&vi(qa,e),Ba!==null&&vi(Ba,e),Ua!==null&&vi(Ua,e),Zl.forEach(t),Kl.forEach(t);for(var a=0;a<wa.length;a++){var n=wa[a];n.blockedOn===e&&(n.blockedOn=null)}for(;0<wa.length&&(a=wa[0],a.blockedOn===null);)Zf(a),a.blockedOn===null&&wa.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(n=0;n<a.length;n+=3){var l=a[n],o=a[n+1],p=l[dt]||null;if(typeof o=="function")p||Jf(a);else if(p){var y=null;if(o&&o.hasAttribute("formAction")){if(l=o,p=o[dt]||null)y=p.formAction;else if($r(l)!==null)continue}else y=p.action;typeof y=="function"?a[n+1]=y:(a.splice(n,3),n-=3),Jf(a)}}}function Pr(e){this._internalRoot=e}yi.prototype.render=Pr.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(u(409));var a=t.current,n=Et();Yf(a,n,e,t,null,null)},yi.prototype.unmount=Pr.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Yf(e.current,2,null,e,null,null),Fs(),t[un]=null}};function yi(e){this._internalRoot=e}yi.prototype.unstable_scheduleHydration=function(e){if(e){var t=du();e={blockedOn:null,target:e,priority:t};for(var a=0;a<wa.length&&t!==0&&t<wa[a].priority;a++);wa.splice(a,0,e),a===0&&Zf(e)}};var If=r.version;if(If!=="19.1.1")throw Error(u(527,If,"19.1.1"));L.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(u(188)):(e=Object.keys(e).join(","),Error(u(268,e)));return e=g(t),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var Kh={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:j,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bi.isDisabled&&bi.supportsFiber)try{tl=bi.inject(Kh),bt=bi}catch{}}return Fl.createRoot=function(e,t){if(!d(e))throw Error(u(299));var a=!1,n="",l=fd,o=md,p=pd,y=null;return t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onUncaughtError!==void 0&&(l=t.onUncaughtError),t.onCaughtError!==void 0&&(o=t.onCaughtError),t.onRecoverableError!==void 0&&(p=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(y=t.unstable_transitionCallbacks)),t=Gf(e,1,!1,null,null,a,n,l,o,p,y,null),e[un]=t.current,Nr(e),new Pr(t)},Fl.hydrateRoot=function(e,t,a){if(!d(e))throw Error(u(299));var n=!1,l="",o=fd,p=md,y=pd,_=null,z=null;return a!=null&&(a.unstable_strictMode===!0&&(n=!0),a.identifierPrefix!==void 0&&(l=a.identifierPrefix),a.onUncaughtError!==void 0&&(o=a.onUncaughtError),a.onCaughtError!==void 0&&(p=a.onCaughtError),a.onRecoverableError!==void 0&&(y=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(_=a.unstable_transitionCallbacks),a.formState!==void 0&&(z=a.formState)),t=Gf(e,1,!0,t,a??null,n,l,o,p,y,_,z),t.context=Pf(null),a=t.current,n=Et(),n=zi(n),l=Sa(n),l.callback=null,ja(a,l,n),a=n,t.current.lanes=a,nl(t,a),Jt(t),e[un]=t.current,Nr(e),new yi(t)},Fl.version="19.1.1",Fl}var cm;function lv(){if(cm)return Vr.exports;cm=1;function c(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(c)}catch(r){console.error(r)}}return c(),Vr.exports=nv(),Vr.exports}var sv=lv();const iv=nu(sv),cv=ee.createContext(null),Kr={didCatch:!1,error:null};class rm extends ee.Component{constructor(r){super(r),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=Kr}static getDerivedStateFromError(r){return{didCatch:!0,error:r}}resetErrorBoundary(){const{error:r}=this.state;if(r!==null){for(var s,u,d=arguments.length,f=new Array(d),h=0;h<d;h++)f[h]=arguments[h];(s=(u=this.props).onReset)===null||s===void 0||s.call(u,{args:f,reason:"imperative-api"}),this.setState(Kr)}}componentDidCatch(r,s){var u,d;(u=(d=this.props).onError)===null||u===void 0||u.call(d,r,s)}componentDidUpdate(r,s){const{didCatch:u}=this.state,{resetKeys:d}=this.props;if(u&&s.error!==null&&rv(r.resetKeys,d)){var f,h;(f=(h=this.props).onReset)===null||f===void 0||f.call(h,{next:d,prev:r.resetKeys,reason:"keys"}),this.setState(Kr)}}render(){const{children:r,fallbackRender:s,FallbackComponent:u,fallback:d}=this.props,{didCatch:f,error:h}=this.state;let m=r;if(f){const g={error:h,resetErrorBoundary:this.resetErrorBoundary};if(typeof s=="function")m=s(g);else if(u)m=ee.createElement(u,g);else if(d!==void 0)m=d;else throw h}return ee.createElement(cv.Provider,{value:{didCatch:f,error:h,resetErrorBoundary:this.resetErrorBoundary}},m)}}function rv(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return c.length!==r.length||c.some((s,u)=>!Object.is(s,r[u]))}const uv={scene1:{text:`Tu es Elarion, un jeune magicien haut-elfe de la cité d'Ilveras. Tes cheveux argentés tombent en mèches fines autour de ton visage pâle et élégant, et tes yeux d'un bleu profond reflètent la curiosité insatiable qui t'anime. Tu portes une robe de mage bleu nuit, brodée de runes argentées, et un sac rempli de tes parchemins.

Ilveras est une cité ancienne, bâtie sur des falaises dominant la mer. Les tours de cristal de l'Académie des Arcanes s'élèvent au centre, tandis que les ruelles pavées et les jardins suspendus témoignent de la grandeur passée de ce royaume elfique.

Récemment, tu as entendu des murmures concernant une ancienne prophétie liée à un "symbole perdu" qui pourrait détenir la clé d'un pouvoir immense. Ces murmures t'ont mené à la grande bibliothèque de l'Académie, le cœur de ton apprentissage. En explorant les rangées d'étagères, une étrange lueur émane d'un vieux manuscrit sur un pupitre isolé. L'air vibre d'une magie ancienne, et tu sens une forte connexion avec cet objet.`,choices:[{text:"Approcher et lire le manuscrit",next:"scene2a"},{text:"Explorer les étagères à la recherche d'un savoir oublié",next:"scene2b"},{text:"Ignorer le manuscrit et sortir dans les jardins de l'académie",next:"scene2c"}]},scene2a:{text:"Tu t'approches du manuscrit. Au moment où tu le touches, une page s'efface sous tes yeux et un symbole brûlant se grave sur ta paume. La douleur est si intense que tu perds connaissance quelques instants. À ton réveil, le manuscrit est fermé, mais ton esprit est étrangement éveillé. Tu comprends instinctivement que ce symbole est la clé de la prophétie. La piste la plus prometteuse pour découvrir sa signification se trouve à Meresnya, la grande cité marchande, connue pour ses érudits et ses archives millénaires.",choices:[{text:"Préparer ton voyage vers Meresnya",next:"scene3"}]},scene2b:{text:"En fouillant les étagères, tu trouves un ancien parchemin qui semble te murmurer des secrets. Il est d'une grande valeur pour un érudit comme toi. Soudain, le manuscrit que tu as vu plus tôt attire ton attention à nouveau, il se met à léviter doucement au-dessus du pupitre. Le symbole de la prophétie apparaît sur la couverture. Le parchemin que tu as en main te révèle alors que la seule personne qui peut t'aider est un mystérieux maître de la ville de Meresnya.",choices:[{text:"Prendre le parchemin et commencer le voyage",next:{type:"item",item:["potionOfSuperiorHealing","arccheat"],nextScene:"scene3"}}]},scene2c:{text:`Tu ignores le manuscrit et sors dans les jardins suspendus de l'académie. L'air est frais et les fleurs exhalent un parfum mystérieux. Cependant, une étrange sensation de chaleur sur ta main gauche te fait découvrir un symbole magique gravé dans ta paume. Tu réalises que c'est un signe, lié à la prophétie que tu étudiais. Un vent soudain murmure le nom de "Meresnya", et tu comprends que c'est là que tu dois te rendre pour percer son secret.`,choices:[{text:"Préparer ton voyage vers Meresnya",next:"scene3"}]},scene3:{text:"Alors que tu quittes l'enceinte sacrée de l'académie pour la route menant à la grande cité de Meresnya, le sentier se rétrécit brusquement. Deux gobelins à la peau vert-de-gris et aux sourires déments surgissent d'un buisson, leurs armes de fortune brandies. Ils grognent et s'avancent vers toi, prêts à en découdre.",choices:[{text:"Dégainer ton arme et te défendre !",action:{type:"combat",enemies:[{type:"gobelin",count:2}],enemyPositions:[{x:6,y:0},{x:7,y:0}],next:"scene4"}}]},scene4:{text:"Après avoir repoussé les gobelins, tu continues ta route, ton cœur battant encore la chamade. Tu arrives bientôt dans une clairière baignée de soleil. Au centre, une fontaine cristalline chante doucement, ses eaux pures glissant sur la pierre usée. C'est un endroit paisible, parfait pour faire une courte pause et reprendre ton souffle.",choices:[{text:"Faire un court repos pour soigner tes blessures",action:{type:"shortRest",nextScene:"scene5"}},{text:"Continuer l'exploration sans t'arrêter",next:"scene5"}]},scene5:{text:"Tu pénètres dans la Forêt de Murmures, un bois ancien et mystérieux où les arbres centenaires tordent leurs branches comme des doigts crochus. Des murmures magiques semblent flotter dans l'air, et tu as l'impression que des créatures invisibles t'observent. Le sentier se divise en deux. L'un, sombre et escarpé, s'enfonce entre les arbres, tandis que l'autre est bordé de fleurs luminescentes, créant une lueur apaisante.",choices:[{text:"Prendre le chemin sombre",next:"scene6"},{text:"Prendre le chemin lumineux",next:"scene6"}]},scene6:{text:"Peu importe le chemin choisi, tu arrives devant un ancien pont de pierre, enjambant un torrent tumultueux. Un symbole étrangement familier est gravé dans la pierre. Il représente un blason oublié, celui d'un des fondateurs de l'Académie des Arcanes, dont l'histoire a été perdue au fil du temps. Le symbole sur ta paume semble réagir, émettant une faible chaleur.",choices:[{text:"Essayer de se souvenir de l'histoire du blason",action:{type:"skillCheck",skill:"histoire",dc:15,onSuccess:"scene6a",onPartialSuccess:"scene6b",onFailure:"scene6c"}},{text:"Ignorer le blason et traverser le pont",next:"scene7"}]},scene6a:{text:"Grâce à tes vastes connaissances académiques, tu te souviens parfaitement que ce blason appartient à l'un des fondateurs originels de l'Académie, un mage excentrique qui a scellé un passage secret derrière le pont. En observant attentivement la pierre, tu découvres un mécanisme caché. Le symbole sur ta main s'illumine au moment où tu l'actives, et un passage s'ouvre, révélant un coffre.",choices:[{text:"Ouvrir le coffre",next:{type:"item",item:"potionOfSuperiorHealing",nextScene:"scene7"}}]},scene6b:{text:"Tu te souviens que ce blason est lié aux fondateurs de l'Académie, mais tu ne parviens pas à te souvenir des détails précis. En touchant la pierre, tu sens une légère vibration qui résonne avec le symbole sur ta main, mais tu ne parviens pas à activer le mécanisme. Tu n'as d'autre choix que de continuer ton chemin.",choices:[{text:"Continuer l'exploration",next:"scene7"}]},scene6c:{text:"Le blason ne te dit absolument rien. En touchant la pierre, une décharge électrique te parcourt, te laissant un peu étourdi. Le symbole sur ta main reste silencieux. Il vaut mieux ne pas insister et continuer ton chemin.",choices:[{text:"Continuer l'exploration",next:"scene7"}]},scene7:{text:"Après avoir traversé le pont, tu longes le torrent. Tu remarques un petit trésor dissimulé dans une crevasse : une fiole de potion de soins et un ancien parchemin. Le parchemin brille d'une faible lueur magique, tu sens qu'il pourrait améliorer tes capacités.",choices:[{text:"rhingann",next:{type:"ally",ally:"Rhingann",nextScene:"scene8"}},{text:"Les ranger dans mon sac !",next:{type:"item",item:["potionOfHealing","scrollOfIntelligence"],nextScene:"scene8"}}]},scene8:{text:"Un jeune guerrier au regard déterminé apparaît sur ton chemin. Il se nomme Tyrion. Il porte une armure de cuir souple usée par les voyages et te propose de l'accompagner vers les ruines de Valdoria, une ancienne cité maudite, pour y chercher une relique perdue de son ordre. Tu sens qu'il a besoin d'aide, et son chemin pourrait également t'en apprendre plus sur le mystérieux symbole gravé sur ta main.",choices:[{text:"Accepter la proposition et faire équipe avec Tyrion",next:{type:"ally",ally:"Tyrion",nextScene:"scene9"}},{text:"Refuser l'offre et continuer seul",next:"scene9"}]},scene9:{text:"Après des heures de marche, tu arrives devant les ruines anciennes de Valdoria, un lieu chargé d'histoire et de légendes. Les vestiges de ce qui fut autrefois une cité majestueuse s'étendent à perte de vue, des murs effondrés et des arches brisées se dressant comme les squelettes d'un géant endormi. L'air, étrangement immobile, est imprégné de l'odeur de la pierre humide, de la terre et d'un effluve métallique qui te glace le sang : le parfum de la mort. Une aura magique palpable émane de l'ensemble du site, comme si les échos des sorts passés continuaient de vibrer dans le silence. Deux chemins s'offrent à toi : l'un s'enfonce dans les entrailles des ruines, l'autre contourne prudemment la zone.",choices:[{text:"T'aventurer plus profondément dans les ruines",next:"scene10"},{text:"Continuer ton chemin et contourner les ruines",next:"scene12"}]},scene10:{text:"Ignorant les avertissements de ton instinct, tu t'engages dans l'allée principale des ruines. Les bâtiments, réduits à l'état de carcasses de pierre, te rappellent des histoires oubliées de batailles et de puissantes magies. Soudain, un craquement macabre brise le silence. Deux silhouettes squelettiques, animées par une force obscure, émergent des décombres d'une ancienne taverne. Leurs os jaunis par le temps, leurs orbites vides fixées sur toi, elles brandissent des épées rouillées. Ces gardiens d'outre-tombe semblent prêts à défendre ce lieu jusqu'à ce que leurs derniers os tombent en poussière.",choices:[{text:"Préparer ton arme et te défendre !",action:{type:"combat",enemies:[{type:"squelette",count:2}],enemyPositions:[{x:0,y:0},{x:7,y:0}],next:"scene11"}}]},scene11:{text:"Après un combat acharné contre les gardiens d'outre-tombe, tu parviens à les vaincre. Leurs ossements s'effondrent sur le sol en une poignée de poussière. Le silence revient, encore plus lourd qu'avant. Tu décides de fouiller les restes de la taverne et découvres, caché sous une dalle brisée, un coffre vermoulu. À l'intérieur, un peu d'or et une fiole de potion de soin. Mais surtout, une ancienne carte partiellement brûlée indique le chemin vers une crypte située plus loin dans les ruines. C'est peut-être la piste qui te mènera à la vérité sur le symbole.",choices:[{text:"Prendre les objets et suivre le chemin de la crypte",next:{type:"item",item:"potionOfHealing",nextScene:"scene13"}},{text:"Ignorer la carte et faire demi-tour",next:"scene12"}]},scene12:{text:"Tu décides de ne pas t'attarder dans cet endroit lugubre et fais le tour des ruines. Le chemin est long et parsemé d'embûches naturelles, mais tu évites le combat. Finalement, tu rejoins la route principale. Tu as l'impression d'avoir évité un danger, mais aussi d'avoir laissé derrière toi un secret bien gardé. Le murmure des ruines s'éloigne derrière toi, et tu continues ta route vers la prochaine étape.",choices:[{text:"Continuer l'aventure",next:"scene13"}]},scene13:{text:"Un sentier mène à une caverne mystérieuse, dont l'entrée est masquée par un rideau de lierre. L'air qui en émane est épais et chargé de magie, avec une légère odeur de souffre. Tu sens une présence malveillante et un danger imminent qui t'attirent, comme si le mystère du symbole de ta main était lié à ce lieu.",choices:[{text:"Essayer de percevoir le danger",action:{type:"skillCheck",skill:"perception",dc:14,onSuccess:"scene13a",onPartialSuccess:"scene13b",onFailure:"scene13c"}},{text:"Rentrer directement dans la caverne",next:"scene14"}]},scene13a:{text:"Grâce à tes sens d'elfe aiguisés et à ta concentration, tu perçois clairement des bruits de pas et des chuchotements venant de l'intérieur de la caverne. Tu sens que des créatures t'attendent à l'affût, prêtes à bondir. Le symbole sur ta paume s'illumine et une potion de sagesse tombe à tes pieds. Tu te prépares à un combat imminent.",choices:[{text:"Se tenir prêt",next:{type:"item",item:"scrollOfSagesse",nextScene:"scene14"}}]},scene13b:{text:"Tu entends des bruits étranges venant de la caverne, comme des raclements de pierre et des chuchotements lointains, mais tu ne peux pas identifier clairement le danger. Tu décides de rester sur tes gardes, sans savoir exactement à quoi t'attendre.",choices:[{text:"Rentrer dans la caverne",next:"scene14"}]},scene13c:{text:"Malgré tes efforts, tu n'entends rien de suspect. Le silence de la caverne te semble trompeur. Tu te sens un peu imprudent, mais tu décides de continuer malgré tout, le symbole sur ta main te brûlant légèrement.",choices:[{text:"Rentrer dans la caverne",next:"scene14"}]},scene14:{text:"À l'intérieur de la caverne, l'odeur de soufre est plus forte. Deux diablotins surgissent des ombres, tout feu tout flamme, leurs corps de créatures infernales s'agitant de rage. Ils gardent l'entrée de la salle principale et se jettent sur toi, prêts à t'attaquer.",choices:[{text:"Engager le combat",action:{type:"combat",enemies:[{type:"diablotin",count:2}],enemyPositions:[{x:5,y:0},{x:6,y:1}],next:"scene15"}}]},scene15:{text:"Après le combat, tu trouves un lac magique qui scintille dans l'obscurité. Ses eaux émettent une lumière bleutée et les vapeurs qui s'en échappent apaisent ton esprit. L'endroit est parfait pour te régénérer complètement et panser tes blessures.",choices:[{text:"Faire un repos long (récupère tous les PV et les ressources de classe)",action:{type:"longRest",nextScene:"scene16"}},{text:"Continuer l'exploration",next:"scene16"}]},scene16:{text:"Ressourcé, tu explores un ancien temple caché au fond de la caverne. Des runes mystiques sont gravées dans les murs, émettant une énergie sombre mais fascinante. L'une d'elles, en particulier, semble vibrer en harmonie avec le symbole sur ta main, dégageant une forte énergie démoniaque.",choices:[{text:"Étudier les runes",next:"scene17"},{text:"Ignorer et avancer",next:"scene17"}]},scene17:{text:"Au centre du temple, un Diable épineux, une créature démoniaque à l'apparence de reptile, apparaît dans un nuage de fumée. Il se tient droit et t'observe, ses yeux brûlants te fixant intensément. D'une voix caverneuse, il te défie, voulant tester ta maîtrise des sorts et ton courage.",choices:[{text:"Combattre le Diable épineux",action:{type:"combat",enemies:[{type:"diable",count:1}],next:"scene18"}}]},scene18:{text:"La bataille est intense, mais tu parviens à vaincre la créature. Alors qu'elle disparaît en poussière, tu trouves un parchemin de l'agilité qui renforce ta dextérité, ainsi que des notes sur l'art de la prestidigitation, laissées par un ancien mage qui a peut-être lui aussi combattu le Diable épineux.",choices:[{text:"Prendre les parchemins",next:{type:"item",item:["scrollOfDexterity","bookArtHeal"],nextScene:"scene19"}}]},scene19:{text:"Alors que tu te prépares à quitter le temple, la voix d'un de tes maîtres de l'académie résonne dans la caverne. Il te retrouve, impressionné par tes exploits et le chemin que tu as parcouru seul. Il te révèle que le symbole est la clef d'un ancien pouvoir, mais que de grands dangers t'attendent. Il te remet une dernière aide avant que vos chemins se séparent.",choices:[{text:"Accepter l'aide du Maître",next:{type:"item",item:["scrollOfDexterity","scrollOfIntelligence"],nextScene:"scene20"}}]},scene20:{text:"Après un dernier échange, ton Maître te fait ses adieux. Tu quittes le temple et la caverne, laissant derrière toi les ruines de Valdoria. Le chemin vers Meresnya est long, et la route s'étend devant toi sous un ciel crépusculaire. Le symbole sur ta paume émet une douce chaleur, comme une boussole interne te guidant vers ton destin. Tu t'engages sur la grande route, le cœur rempli d'une nouvelle détermination.",choices:[{text:"Continuer le voyage",next:"scene21"}]},scene21:{text:`Le lendemain, après une nuit de marche, tu arrives à une auberge isolée au carrefour de deux routes. L'auberge "Le Dragon Endormi" est un refuge pour les voyageurs fatigués. À l'intérieur, un vieil homme aux yeux vifs te propose une carte. Il te dit que la route principale est plus sûre mais plus longue, tandis qu'un sentier à travers les Marais de la Lune est plus court, mais rempli de bêtes et de dangers.`,choices:[{text:"Prendre la route principale (plus sûre, mais plus longue)",next:"scene22"},{text:"Prendre le sentier des Marais (plus courte, mais plus dangereuse)",next:"scene23"}]},scene22:{text:"Tu décides de prendre la route principale, plus longue mais plus sûre. Après une journée de marche paisible, tu arrives sans encombre aux portes de Meresnya. La cité est immense, ses murs de marbre blanc s'élèvent majestueusement, et l'animation de la ville se fait déjà entendre.",choices:[{text:"Entrer dans la cité",next:"scene24"}]},scene23:{text:"Tu t'engages sur le sentier des Marais de la Lune. L'air est lourd et humide, et une brume persistante enveloppe les lieux. Soudain, un bruit de frottement se fait entendre, et une Créature de la Boue, une masse informe de terre et de vase, se dresse devant toi, ses yeux luisants de malice. Elle t'attaque !",choices:[{text:"Combattre la Créature de la Boue",action:{type:"combat",enemies:[{type:"mephiteBoueux",count:1}],enemyPositions:[{x:6,y:0}],next:"scene24"}}]},scene24:{text:"Tu te retrouves enfin aux portes de Meresnya. La cité s'étend devant toi, une métropole bouillonnante de vie. Des marchands crient leurs offres, des mages échangent des secrets, et l'architecture grandiose témoigne de la richesse et du savoir qui s'y trouvent. Le symbole sur ta main t'indique que tu es au bon endroit. Ta quête pour percer son mystère peut enfin commencer.",choices:[{text:"Chercher un érudit pour t'aider",next:"scene1"}]}},um=c=>{let r;const s=new Set,u=(v,b)=>{const x=typeof v=="function"?v(r):v;if(!Object.is(x,r)){const A=r;r=b??(typeof x!="object"||x===null)?x:Object.assign({},r,x),s.forEach(N=>N(r,A))}},d=()=>r,m={setState:u,getState:d,getInitialState:()=>g,subscribe:v=>(s.add(v),()=>s.delete(v))},g=r=c(u,d,m);return m},ov=c=>c?um(c):um,dv=c=>c;function fv(c,r=dv){const s=Oe.useSyncExternalStore(c.subscribe,Oe.useCallback(()=>r(c.getState()),[c,r]),Oe.useCallback(()=>r(c.getInitialState()),[c,r]));return Oe.useDebugValue(s),s}const om=c=>{const r=ov(c),s=u=>fv(r,u);return Object.assign(s,r),s},Mi=c=>c?om(c):om,dm={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1},ns=new Map,xi=c=>{const r=ns.get(c);return r?Object.fromEntries(Object.entries(r.stores).map(([s,u])=>[s,u.getState()])):{}},mv=(c,r,s)=>{if(c===void 0)return{type:"untracked",connection:r.connect(s)};const u=ns.get(s.name);if(u)return{type:"tracked",store:c,...u};const d={connection:r.connect(s),stores:{}};return ns.set(s.name,d),{type:"tracked",store:c,...d}},pv=(c,r)=>{if(r===void 0)return;const s=ns.get(c);s&&(delete s.stores[r],Object.keys(s.stores).length===0&&ns.delete(c))},hv=c=>{var r,s;if(!c)return;const u=c.split(`
`),d=u.findIndex(h=>h.includes("api.setState"));if(d<0)return;const f=((r=u[d+1])==null?void 0:r.trim())||"";return(s=/.+ (.+) .+/.exec(f))==null?void 0:s[1]},vv=(c,r={})=>(s,u,d)=>{const{enabled:f,anonymousActionType:h,store:m,...g}=r;let v;try{v=(f??(dm?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!v)return c(s,u,d);const{connection:b,...x}=mv(m,v,g);let A=!0;d.setState=(E,D,M)=>{const B=s(E,D);if(!A)return B;const V=M===void 0?{type:h||hv(new Error().stack)||"anonymous"}:typeof M=="string"?{type:M}:M;return m===void 0?(b?.send(V,u()),B):(b?.send({...V,type:`${m}/${V.type}`},{...xi(g.name),[m]:d.getState()}),B)},d.devtools={cleanup:()=>{b&&typeof b.unsubscribe=="function"&&b.unsubscribe(),pv(g.name,m)}};const N=(...E)=>{const D=A;A=!1,s(...E),A=D},C=c(d.setState,u,d);if(x.type==="untracked"?b?.init(C):(x.stores[x.store]=d,b?.init(Object.fromEntries(Object.entries(x.stores).map(([E,D])=>[E,E===x.store?C:D.getState()])))),d.dispatchFromDevtools&&typeof d.dispatch=="function"){let E=!1;const D=d.dispatch;d.dispatch=(...M)=>{(dm?"production":void 0)!=="production"&&M[0].type==="__setState"&&!E&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),E=!0),D(...M)}}return b.subscribe(E=>{var D;switch(E.type){case"ACTION":if(typeof E.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return Jr(E.payload,M=>{if(M.type==="__setState"){if(m===void 0){N(M.state);return}Object.keys(M.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const B=M.state[m];if(B==null)return;JSON.stringify(d.getState())!==JSON.stringify(B)&&N(B);return}d.dispatchFromDevtools&&typeof d.dispatch=="function"&&d.dispatch(M)});case"DISPATCH":switch(E.payload.type){case"RESET":return N(C),m===void 0?b?.init(d.getState()):b?.init(xi(g.name));case"COMMIT":if(m===void 0){b?.init(d.getState());return}return b?.init(xi(g.name));case"ROLLBACK":return Jr(E.state,M=>{if(m===void 0){N(M),b?.init(d.getState());return}N(M[m]),b?.init(xi(g.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Jr(E.state,M=>{if(m===void 0){N(M);return}JSON.stringify(d.getState())!==JSON.stringify(M[m])&&N(M[m])});case"IMPORT_STATE":{const{nextLiftedState:M}=E.payload,B=(D=M.computedStates.slice(-1)[0])==null?void 0:D.state;if(!B)return;N(m===void 0?B:B[m]),b?.send(null,M);return}case"PAUSE_RECORDING":return A=!A}return}}),C},Di=vv,Jr=(c,r)=>{let s;try{s=JSON.parse(c)}catch(u){console.error("[zustand devtools middleware] Could not parse the received json",u)}s!==void 0&&r(s)},gv=c=>(r,s,u)=>{const d=u.subscribe;return u.subscribe=(h,m,g)=>{let v=h;if(m){const b=g?.equalityFn||Object.is;let x=h(u.getState());v=A=>{const N=h(A);if(!b(x,N)){const C=x;m(x=N,C)}},g?.fireImmediately&&m(x,x)}return d(v)},c(r,s,u)},yv=gv;function bv(c,r){let s;try{s=c()}catch{return}return{getItem:d=>{var f;const h=g=>g===null?null:JSON.parse(g,void 0),m=(f=s.getItem(d))!=null?f:null;return m instanceof Promise?m.then(h):h(m)},setItem:(d,f)=>s.setItem(d,JSON.stringify(f,void 0)),removeItem:d=>s.removeItem(d)}}const Wr=c=>r=>{try{const s=c(r);return s instanceof Promise?s:{then(u){return Wr(u)(s)},catch(u){return this}}}catch(s){return{then(u){return this},catch(u){return Wr(u)(s)}}}},xv=(c,r)=>(s,u,d)=>{let f={storage:bv(()=>localStorage),partialize:E=>E,version:0,merge:(E,D)=>({...D,...E}),...r},h=!1;const m=new Set,g=new Set;let v=f.storage;if(!v)return c((...E)=>{console.warn(`[zustand persist middleware] Unable to update item '${f.name}', the given storage is currently unavailable.`),s(...E)},u,d);const b=()=>{const E=f.partialize({...u()});return v.setItem(f.name,{state:E,version:f.version})},x=d.setState;d.setState=(E,D)=>{x(E,D),b()};const A=c((...E)=>{s(...E),b()},u,d);d.getInitialState=()=>A;let N;const C=()=>{var E,D;if(!v)return;h=!1,m.forEach(B=>{var V;return B((V=u())!=null?V:A)});const M=((D=f.onRehydrateStorage)==null?void 0:D.call(f,(E=u())!=null?E:A))||void 0;return Wr(v.getItem.bind(v))(f.name).then(B=>{if(B)if(typeof B.version=="number"&&B.version!==f.version){if(f.migrate){const V=f.migrate(B.state,B.version);return V instanceof Promise?V.then(le=>[!0,le]):[!0,V]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,B.state];return[!1,void 0]}).then(B=>{var V;const[le,I]=B;if(N=f.merge(I,(V=u())!=null?V:A),s(N,!0),le)return b()}).then(()=>{M?.(N,void 0),N=u(),h=!0,g.forEach(B=>B(N))}).catch(B=>{M?.(void 0,B)})};return d.persist={setOptions:E=>{f={...f,...E},E.storage&&(v=E.storage)},clearStorage:()=>{v?.removeItem(f.name)},getOptions:()=>f,rehydrate:()=>C(),hasHydrated:()=>h,onHydrate:E=>(m.add(E),()=>{m.delete(E)}),onFinishHydration:E=>(g.add(E),()=>{g.delete(E)})},f.skipHydration||C(),N||A},Sv=xv,$a={"Projectile Magique":{name:"Projectile Magique",level:0,school:"Évocation",castingTime:"1 action",range:"36 mètres",description:"Vous créez trois fléchettes faites d'énergie magique brillante. Chacune touche une créature de votre choix, située à portée et dans votre champ de vision. Une fléchette inflige 1d4+1 dégâts de force à la cible. Toutes les fléchettes frappent leur cible en même temps, sachant que vous pouvez toutes les diriger contre une seule et même créature ou les répartir entre plusieurs.",damage:{dice:"1d4",bonus:1,type:"force"},projectiles:3,requiresAttackRoll:!1,castableOutOfCombat:!1},"Trait de Feu":{name:"Trait de Feu",level:1,school:"Évocation",castingTime:"1 action",range:"36 mètres",duration:"instantanée",description:"Vous lancez un trait enflammé sur une créature ou un objet à portée. Faites une attaque de sort à distance contre la cible. Si vous touchez, elle subit 1d10 dégâts de feu. Si le sort touche un objet inflammable qui n'est ni porté ni transporté, il s'embrase.",damage:{dice:"1d10",bonus:0,type:"feu"},projectiles:1,requiresAttackRoll:!0,castableOutOfCombat:!1},"Rayon de givre":{name:"Rayon de givre",level:0,school:"Évocation",castingTime:"1 action",range:"18 mètres",description:"Un rayon de lumière d'un blanc bleuté file vers une créature à portée. Faites une attaque de sort à distance contre la cible. Si vous la touchez, elle subit 1d8 dégâts de froid et sa vitesse est réduite de 3 mètres jusqu'au début de votre prochain tour.",damage:{dice:"1d8",bonus:0,type:"froid"},projectiles:1,requiresAttackRoll:!0,castableOutOfCombat:!1},"Rayon Ardent":{name:"Rayon Ardent",level:2,school:"Évocation",castingTime:"1 action",range:"36 mètres",description:"Vous créez trois rayons de feu et les projetez sur des cibles à portée. Vous pouvez les diriger contre une même cible ou contre des cibles différentes. Faites une attaque de sort à distance pour chaque rayon. Si vous touchez, la cible reçoit 2d6 dégâts.",damage:{dice:"2d6",bonus:0,type:"feu"},projectiles:3,requiresAttackRoll:!0,castableOutOfCombat:!1},"Boule de Feu":{name:"Boule de Feu",level:2,school:"Évocation",castingTime:"1 action",range:"45 mètres",description:"Une boule de feu explose dans une sphère de 6 mètres de rayon centrée sur un point à portée. Chaque créature dans la zone doit faire un jet de sauvegarde de Dextérité. En cas d'échec, elle subit 8d6 dégâts de feu, ou la moitié en cas de réussite.",damage:{dice:"8d6",bonus:0,type:"feu"},areaOfEffect:{shape:"sphere",radius:20},savingThrow:{ability:"dexterite",dc:"spell"},requiresAttackRoll:!1,castableOutOfCombat:!1,projectiles:1},"Armure du Mage":{name:"Armure du Mage",level:1,school:"Abjuration",castingTime:"1 action",range:"Toucher",description:"Vous touchez une créature consentante et non-vêtue d'une armure. Sa Classe d'Armure devient 13 + son modificateur de Dextérité.",requiresAttackRoll:!1,castableOutOfCombat:!0},Soins:{name:"Soins",level:1,school:"Évocation",castingTime:"1 action",range:"Toucher",description:"Une créature que vous touchez récupère un nombre de points de vie égal à 1d8 + votre modificateur de caractéristique d'incantation.",healing:{dice:"1d8",bonus:"wisdom"},requiresAttackRoll:!1,targetType:"ally",castableOutOfCombat:!0},Bénédiction:{name:"Bénédiction",level:1,school:"Enchantement",castingTime:"1 action",range:"9 mètres",duration:"Concentration, jusqu'à 1 minute",description:"Vous bénissez jusqu'à trois créatures de votre choix à portée. Chaque fois qu'une cible effectue un jet d'attaque ou de sauvegarde avant la fin du sort, elle peut lancer 1d4 et ajouter le résultat au jet.",buff:{attackBonus:"1d4",saveBonus:"1d4",duration:600},targetType:"ally",maxTargets:3,requiresAttackRoll:!1,castableOutOfCombat:!0},Sanctuaire:{name:"Sanctuaire",level:1,school:"Abjuration",castingTime:"1 action bonus",range:"9 mètres",duration:"1 minute",description:"Vous protégez une créature à portée contre les attaques. Jusqu'à la fin du sort, toute créature qui cible la créature protégée avec une attaque ou un sort offensif doit d'abord effectuer un jet de sauvegarde de Sagesse.",buff:{protection:"sanctuary",saveDC:"spell",duration:600},targetType:"ally",requiresAttackRoll:!1,castableOutOfCombat:!0},Aide:{name:"Aide",level:2,school:"Abjuration",castingTime:"1 action",range:"9 mètres",duration:"8 heures",description:"Votre sort renforce vos alliés avec endurance et résolution. Choisissez jusqu'à trois créatures à portée. Le maximum de points de vie de chaque cible augmente de 5 pour la durée du sort.",buff:{maxHPBonus:5,duration:28800},maxTargets:3,targetType:"ally",requiresAttackRoll:!1,castableOutOfCombat:!0},Bouclier:{name:"Bouclier",level:1,school:"Abjuration",castingTime:"1 réaction",range:"Personnel",duration:"1 round",description:"Une barrière invisible de force magique apparaît et vous protège. Jusqu'au début de votre prochain tour, vous avez un bonus de +5 à la CA.",buff:{acBonus:5,duration:1},targetType:"self",requiresAttackRoll:!1,castableOutOfCombat:!1}},Si={wizard:{name:"Elarion",level:1,currentXP:0,race:"Haut Elfe",class:"Magicien",historic:"Érudit de l'Académie",maxHP:12,currentHP:12,ac:10,initiative:0,speed:"9m",proficiencyBonus:2,hitDice:1,hitDiceType:6,type:"player",stats:{force:10,dexterite:15,constitution:12,intelligence:16,sagesse:13,charisme:12},proficiencies:{saves:["intelligence","sagesse"],skills:["arcane","histoire","investigation","perspicacite"]},weaponProficiencies:["simple"],spellcasting:{ability:"intelligence",spellSlots:{},knownSpells:[],cantrips:["Projectile Magique","Rayon de givre"],preparedSpells:["Armure du Mage"],activeSpells:{}},weapons:["dagger"],inventory:[]},warrior:{name:"Gareth",level:1,currentXP:0,race:"Humain",class:"Guerrier",historic:"Soldat Vétéran",maxHP:18,currentHP:18,ac:16,initiative:0,speed:"9m",proficiencyBonus:2,hitDice:1,hitDiceType:10,type:"player",stats:{force:16,dexterite:14,constitution:15,intelligence:10,sagesse:12,charisme:13},proficiencies:{saves:["force","constitution"],skills:["athletisme","intimidation","perception","survie"]},weaponProficiencies:["simple","martial"],armorProficiencies:["light","medium","heavy","shields"],weapons:["longsword","shortbow","heavybow","dagger"],armor:"chainmail",shield:!0,inventory:[]},rogue:{name:"Lyra",level:1,currentXP:0,race:"Halfelin",class:"Roublard",historic:"Criminel",maxHP:14,currentHP:14,ac:13,initiative:0,speed:"7.5m",proficiencyBonus:2,hitDice:1,hitDiceType:8,type:"player",stats:{force:15,dexterite:16,constitution:14,intelligence:13,sagesse:12,charisme:8},proficiencies:{saves:["dexterite","intelligence"],skills:["acrobaties","discretion","escamotage","investigation","perception","persuasion","tromperie"]},weaponProficiencies:["simple","longsword","rapier","shortsword","lightCrossbow"],armorProficiencies:["light"],weapons:["rapier","shortbow","dagger"],armor:"leather",specialAbilities:{sneakAttack:{name:"Attaque Sournoise",description:"1d6 dégâts supplémentaires si avantage ou allié adjacent",damage:"1d6",level:1},expertise:{name:"Expertise",description:"Double le bonus de maîtrise pour certaines compétences",skills:["discretion","escamotage"]}},inventory:[]},paladin:{name:"Elara",level:1,currentXP:0,race:"Elfe",class:"Paladin",historic:"Templier",maxHP:16,currentHP:16,ac:18,initiative:0,speed:"9m",proficiencyBonus:2,hitDice:1,hitDiceType:10,type:"player",stats:{force:15,dexterite:12,constitution:14,intelligence:10,sagesse:13,charisme:16},proficiencies:{saves:["force","charisme"],skills:["athletisme","intimidation","medecine","persuasion"]},weaponProficiencies:["simple","martial"],armorProficiencies:["light","medium","heavy","shields"],weapons:["longsword","shield"],armor:"chainmail",shield:!0,inventory:[]}},jv={1:{1:2},2:{1:3},3:{1:4,2:2},4:{1:4,2:3},5:{1:4,2:3,3:2}},ze=c=>Math.floor((c-10)/2),_i=c=>Math.floor(Math.random()*c)+1,_v=()=>_i(20),Kn=(c=0)=>_v()+c,Jn=c=>{if(!c||!c.includes("d"))return 0;const[r,s]=c.split("d").map(Number);let u=0;for(let d=0;d<r;d++)u+=_i(s);return u},wt=(c,r)=>!c||!r||c.x===void 0||r.x===void 0?1/0:Math.abs(c.x-r.x)+Math.abs(c.y-r.y),Nv=""+new URL("tyrion-Cl-F8-rO.png",import.meta.url).href,Cv=""+new URL("rhingann-CamkbPql.png",import.meta.url).href,Sm={Tyrion:{name:"Tyrion",level:1,race:"Humain",class:"Jeune Guerrier",historic:"Chercheur de Reliques",role:"tank",maxHP:12,currentHP:12,ac:18,initiative:0,speed:"9m",proficiencyBonus:2,hitDice:1,hitDiceType:6,type:"companion",stats:{force:18,dexterite:16,constitution:15,intelligence:13,sagesse:10,charisme:12},movement:6,image:Nv,attacks:[{name:"son Épée longue",type:"melee",range:1,description:"Une attaque avec une épée longue",damageDice:"1d8",damageType:"tranchant",stat:"force"}],inventory:[],aiPriority:["protect","taunt","melee_attack"],spellcasting:null},Rhingann:{name:"Rhingann",level:1,race:"Naine",class:"Clerc",historic:"",role:"healer",maxHP:13,currentHP:13,ac:14,initiative:0,speed:"9m",proficiencyBonus:2,hitDice:1,hitDiceType:8,type:"companion",stats:{force:14,dexterite:10,constitution:14,intelligence:10,sagesse:18,charisme:10},movement:6,image:Cv,attacks:[{name:"son Marteau de guerre",type:"melee",range:1,description:"Une attaque avec un marteau de guerre",damageDice:"1d8",damageType:"contondant",stat:"force"}],inventory:[],aiPriority:["heal","buff","ranged_support"],spellcasting:{class:"Clerc",spellSlots:{1:{total:2,used:0}},knownSpells:["Soins","Bénédiction"],preparedSpells:["Soins","Bénédiction"],slotsRemaining:{1:2}}}};class qe{static getProficiencyBonus(r){return Math.ceil(r/4)+1}static getSpellSaveDC(r){if(!r.spellcasting)return 8;const s=this.getSpellcastingAbility(r),u=ze(r.stats[s]),d=this.getProficiencyBonus(r.level);return 8+u+d}static getSpellcastingAbility(r){return r.spellcasting?r.spellcasting.ability||(()=>{switch(r.class){case"Magicien":return"intelligence";case"Clerc":return"sagesse";case"Barde":return"charisme";case"Rôdeur":case"Paladin":return"sagesse";case"Sorcier":case"Occultiste":return"charisme";default:return"intelligence"}})():"intelligence"}static getAttackBonus(r,s){const u=this.getProficiencyBonus(r.level);switch(s.actionType){case"spell":const d=this.getSpellcastingAbility(r);return ze(r.stats[d])+u;case"weapon":let f=s.stat||"force";if(s.properties?.includes("finesse")){const g=ze(r.stats.force);f=ze(r.stats.dexterite)>g?"dexterite":"force"}const m=this.isWeaponProficient(r,s)?u:0;return ze(r.stats[f])+m;default:return 0}}static isWeaponProficient(r,s){if(!r.weaponProficiencies)return!1;if(r.weaponProficiencies.includes(s.id))return!0;const u=["dagger","club","quarterstaff","lightCrossbow","shortbow"].includes(s.id);return!!(u&&r.weaponProficiencies.includes("simple")||!u&&r.weaponProficiencies.includes("martial"))}static levelUp(r){const s=r.level+1;if(s>20)return r;const u=this.getHitDie(r.class),d=ze(r.stats.constitution),f=Math.max(1,_i(u)+d),h={...r,level:s,maxHP:r.maxHP+f,currentHP:r.currentHP+f,currentXP:r.currentXP||r.experience||0,proficiencyBonus:this.getProficiencyBonus(s)};if(r.spellcasting){const m=this.generateSpellSlotsForLevel(s,r.class);h.spellcasting={...r.spellcasting,spellSlots:m}}return console.log(`📈 Level up successful: ${r.level} → ${s}, HP: ${r.maxHP} → ${h.maxHP}`),h}static generateSpellSlotsForLevel(r,s){const u={1:{1:{max:2,used:0}},2:{1:{max:3,used:0}},3:{1:{max:4,used:0},2:{max:2,used:0}},4:{1:{max:4,used:0},2:{max:3,used:0}},5:{1:{max:4,used:0},2:{max:3,used:0},3:{max:2,used:0}}};return s==="Magicien"||s==="Clerc"?u[r]||{}:{}}static getHitDie(r){return{Guerrier:10,Magicien:6,Roublard:8,Clerc:8,Rôdeur:10,Paladin:10}[r]||8}static shortRest(r,s=0){if(s<=0)return r;const u=this.getHitDie(r.class),d=ze(r.stats.constitution);let f=0;const h=r.hitDice||Math.floor(r.level/2),m=Math.min(s,h);for(let g=0;g<m;g++)f+=Math.max(1,_i(u)+d);return{...r,currentHP:Math.min(r.maxHP,r.currentHP+f),hitDice:h-m}}static longRest(r){const s={...r,currentHP:r.maxHP,hitDice:r.level};return r.spellcasting&&(s.spellcasting={...r.spellcasting,slotsRemaining:{...r.spellcasting.slotsTotal}}),s}static takeDamage(r,s){return{...r,currentHP:Math.max(0,r.currentHP-s)}}static heal(r,s){return{...r,currentHP:Math.min(r.maxHP,r.currentHP+s)}}static consumeSpellSlot(r,s){if(!r.spellcasting||s<=0)return r;const u=r.spellcasting.slotsRemaining[s]||0;return u<=0?r:{...r,spellcasting:{...r.spellcasting,slotsRemaining:{...r.spellcasting.slotsRemaining,[s]:u-1}}}}static addExperience(r,s){const d=(r.currentXP||r.experience||0)+s;return this.processLevelUps({...r,currentXP:d})}static processLevelUps(r){let s={...r},u=0;const d=10,f=20;for(;u<d&&s.level<f;){const h=this.getXPToNextLevel(s.level);if(s.currentXP>=h){const m=s.level;if(s=this.levelUp(s),s.level<=m){console.error(`⚠️ Level up failed to increase level (${m} → ${s.level})`);break}console.log(`🎯 Level up ! ${m} → ${s.level} (XP: ${s.currentXP}/${h})`),u++}else break}return u>=d&&console.warn("⚠️ Limite de montées de niveau atteinte pour éviter une boucle infinie"),s}static getXPForLevel(r){return[0,300,900,2700,6500,14e3,23e3,34e3,48e3,64e3,85e3][r-1]||0}static getXPToNextLevel(r){return this.getXPForLevel(r+1)}}class Lt{static processSceneAction(r,s){if(typeof r=="string")return r;if(typeof r=="object")switch(r.type){case"combat":return this.processCombatAction(r);case"longRest":return this.processRestAction(r,s,"long");case"shortRest":return this.processRestAction(r,s,"short");case"item":return this.processItemAction(r,s);case"ally":return this.processAllyAction(r,s);case"skillCheck":return this.processSkillCheck(r,s);default:return console.warn("Type d'action inconnu :",r.type),null}return null}static processCombatAction(r){return{...r,enemies:r.enemies,enemyPositions:r.enemyPositions,next:r.next}}static processRestAction(r,s,u){return u==="long"?s.startLongRest(r.nextScene):s.startShortRest(r.nextScene),null}static processItemAction(r,s){return s.handleItemGain(r.item),r.nextScene}static processAllyAction(r,s){const u=Sm[r.ally];return u?(s.setPlayerCompanion(u),s.addCombatMessage(`${u.name} te rejoint dans ton aventure !`,"upgrade"),r.nextScene):(console.error(`Compagnon '${r.ally}' introuvable.`),null)}static processSkillCheck(r,s){return s.handleSkillCheck(r.skill,r.dc,r.onSuccess,r.onPartialSuccess,r.onFailure),null}static performSkillCheck(r,s,u){const f=this.getSkillAbilityMapping()[s]||"force",h=getModifier(r.stats[f]),m=qe.getProficiencyBonus(r.level),g=r.skillProficiencies?.includes(s)||!1,v=h+(g?m:0),b=Kn(v);return{roll:b,total:b,dc:u,success:b>=u,skill:s,ability:f,modifier:v,proficient:g}}static getSkillAbilityMapping(){return{Acrobaties:"dexterite",Arcanes:"intelligence",Athletisme:"force",Discrétion:"dexterite",Dressage:"sagesse",Escamotage:"dexterite",Histoire:"intelligence",Insight:"sagesse",Intimidation:"charisme",Investigation:"intelligence",Médecine:"sagesse",Nature:"intelligence",Perception:"sagesse",Persuasion:"charisme",Religion:"intelligence",Representation:"charisme",Survie:"sagesse",Tromperie:"charisme"}}static calculateCombatExperience(r,s=1){const u=r.reduce((d,f)=>d+({0:10,"1/8":25,"1/4":50,"1/2":100,1:200,2:450,3:700,4:1100,5:1800}[f.challengeRating]||100),0);return Math.floor(u/s)}static processCombatRewards(r,s,u=null){const d=u?2:1,f=this.calculateCombatExperience(r,d),h={xpGained:f,messages:[],leveledUp:!1},m=qe.getXPToNextLevel(s.level);return s.experience+f>=m&&(h.leveledUp=!0,h.messages.push(`${s.name} gagne un niveau !`)),h.messages.push(`+${f} XP`),h}static isChoiceAvailable(r,s){return r.conditions?r.conditions.every(u=>{switch(u.type){case"hasItem":return s.playerCharacter.inventory.some(f=>f.id===u.itemId);case"hasCompanion":return s.playerCompanion!==null;case"minLevel":return s.playerCharacter.level>=u.level;case"hasSpell":return[...s.playerCharacter.spellcasting?.cantrips||[],...s.playerCharacter.spellcasting?.preparedSpells||[]].includes(u.spellName);case"statCheck":return s.playerCharacter.stats[u.stat]>=u.value;default:return!0}}):!0}static generateId(r="id"){return`${r}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}static deepClone(r){if(r===null||typeof r!="object")return r;if(r instanceof Date)return new Date(r.getTime());if(r instanceof Array)return r.map(u=>this.deepClone(u));const s={};for(const u in r)r.hasOwnProperty(u)&&(s[u]=this.deepClone(r[u]));return s}}const Ev={acrobaties:"dexterite",arcane:"intelligence",athletisme:"force",discretion:"dexterite",dressage:"sagesse",escamotage:"dexterite",histoire:"intelligence",intimidation:"charisme",intuition:"sagesse",investigation:"intelligence",medecine:"sagesse",nature:"intelligence",perception:"sagesse",persuasion:"charisme",religion:"intelligence",representation:"charisme",survie:"sagesse",tromperie:"charisme"},ha=Mi(Di((c,r)=>({gamePhase:"character-selection",currentScene:"scene7",sceneHistory:[],combatLog:[],isShortResting:!1,isLongResting:!1,nextSceneAfterRest:null,combatKey:0,gameMessages:[],setGamePhase:s=>c({gamePhase:s}),setCurrentScene:s=>c(u=>({currentScene:s,sceneHistory:[...u.sceneHistory,u.currentScene]})),goToPreviousScene:()=>c(s=>s.sceneHistory.length>0?{currentScene:s.sceneHistory[s.sceneHistory.length-1],sceneHistory:s.sceneHistory.slice(0,-1)}:s),addCombatMessage:(s,u="default")=>c(d=>({combatLog:[...d.combatLog,{id:Lt.generateId("msg"),message:s,type:u,timestamp:new Date}]})),clearCombatLog:()=>c({combatLog:[]}),addGameMessage:(s,u="info")=>c(d=>({gameMessages:[...d.gameMessages,{id:Lt.generateId("game-msg"),message:s,type:u,timestamp:new Date}]})),clearGameMessages:()=>c({gameMessages:[]}),startShortRest:s=>c({isShortResting:!0,nextSceneAfterRest:s}),endShortRest:()=>c(s=>({isShortResting:!1,currentScene:s.nextSceneAfterRest,nextSceneAfterRest:null})),startLongRest:s=>c({isLongResting:!0,nextSceneAfterRest:s}),endLongRest:()=>c(s=>({isLongResting:!1,currentScene:s.nextSceneAfterRest,nextSceneAfterRest:null})),incrementCombatKey:()=>c(s=>({combatKey:s.combatKey+1})),handleSkillCheck:(s,u,d,f,h,m)=>{const g=Ev[s],v=m.stats[g],b=ze(v),A=m.proficiencies?.skills?.includes(s)||!1?m.proficiencyBonus:0,N=b+A,C=Kn(N),E=C,{addCombatMessage:D,setCurrentScene:M}=r();D(`Test de ${s} (${g}): ${C-N} (+${N} de bonus) = ${E}. DD: ${u}`,"skill-check");let B=h;E>=u?(B=d,D("✅ Réussite !","success")):E>=u-5&&f?(B=f,D("⚠️ Réussite partielle","partial")):(B=h,D("❌ Échec","failure")),M(B)},updateSpellSlotsForLevel:s=>{if(!s.spellcasting)return s;const u=r().getSpellSlotsForLevel(s.level,s.class),d=r().getKnownSpells(s.level,s.class);return{...s,spellcasting:{...s.spellcasting,spellSlots:u,knownSpells:d}}},getSpellSlotsForLevel:(s,u)=>{let d=s;switch(u){case"Magicien":break;case"Paladin":case"Rôdeur":d=Math.max(0,Math.floor((s-1)/2));break;case"Guerrier":if(s>=3)d=Math.max(0,Math.floor((s-2)/3));else return{};break;case"Roublard":if(s>=3)d=Math.max(0,Math.floor((s-2)/3));else return{};break;default:return{}}const f=jv[d];if(!f)return{};const h={};for(const m in f)h[m]={total:f[m],used:0};return h},getKnownSpells:(s,u)=>{const d=r().getSpellSlotsForLevel(s,u),f=d?Math.max(...Object.keys(d).map(Number)):0,h=Object.values($a).filter(v=>{switch(u){case"Magicien":return!0;case"Guerrier":return v.school==="Abjuration"||v.school==="Évocation"||v.level===0;case"Roublard":return v.school==="Enchantement"||v.school==="Illusion"||v.level===0;default:return!1}}),m=h.filter(v=>v.level===0).map(v=>v.name),g=h.filter(v=>v.level>0&&v.level<=f).map(v=>v.name);return[...m,...g]}}),{name:"game-store"}));class ls{getSpellAttackBonus(r){if(!r.spellcasting)return 0;const s=r.spellcasting.ability||"intelligence",u=ze(r.stats[s]),d=this.getProficiencyBonus(r.level);return u+d}getSpellSaveDC(r){if(!r.spellcasting)return 8;const s=r.spellcasting.ability||"intelligence",u=ze(r.stats[s]),d=this.getProficiencyBonus(r.level);return 8+u+d}getProficiencyBonus(r){return Math.ceil(r/4)+1}getKnownSpells(r){return r.spellcasting?.knownSpells?r.spellcasting.knownSpells.map(s=>this.getSpellData(s)).filter(Boolean).filter(s=>s.level>0):[]}getPreparedSpells(r){return r.spellcasting?.preparedSpells?r.spellcasting.preparedSpells.map(s=>{const u=this.getSpellData(s);return u&&this.isSpellAvailableForClass(u,r)?u:null}).filter(Boolean):[]}getCantrips(r){return r.spellcasting?.cantrips?r.spellcasting.cantrips.map(s=>this.getSpellData(s)).filter(Boolean):[]}getMaxPreparedSpells(r){if(!r.spellcasting)return 0;const s=r.spellcasting.ability||"intelligence";return Math.max(1,ze(r.stats[s]))+r.level}getSpellSlots(r){return!r.spellcasting?.spellSlots||Object.keys(r.spellcasting.spellSlots).length===0?this.generateDefaultSpellSlots(r):r.spellcasting.spellSlots}generateDefaultSpellSlots(r){const s={},u=r.level,f={1:{1:2},2:{1:3},3:{1:4,2:2},4:{1:4,2:3},5:{1:4,2:3,3:2},6:{1:4,2:3,3:3},7:{1:4,2:3,3:3,4:1},8:{1:4,2:3,3:3,4:2},9:{1:4,2:3,3:3,4:3,5:1},10:{1:4,2:3,3:3,4:3,5:2},11:{1:4,2:3,3:3,4:3,5:2,6:1},12:{1:4,2:3,3:3,4:3,5:2,6:1},13:{1:4,2:3,3:3,4:3,5:2,6:1,7:1},14:{1:4,2:3,3:3,4:3,5:2,6:1,7:1},15:{1:4,2:3,3:3,4:3,5:2,6:1,7:1,8:1},16:{1:4,2:3,3:3,4:3,5:2,6:1,7:1,8:1},17:{1:4,2:3,3:3,4:3,5:2,6:1,7:1,8:1,9:1},18:{1:4,2:3,3:3,4:3,5:3,6:1,7:1,8:1,9:1},19:{1:4,2:3,3:3,4:3,5:3,6:2,7:1,8:1,9:1},20:{1:4,2:3,3:3,4:3,5:3,6:2,7:2,8:1,9:1}}[Math.min(u,20)]||{};for(const[h,m]of Object.entries(f))s[h]={max:m,used:0,available:m};return s}getSpellData(r){if($a[r])return{id:r,...$a[r]};const s=Object.entries($a).find(([u,d])=>d.name===r||d.name?.toLowerCase()===r?.toLowerCase());return s?{id:s[0],...s[1]}:null}filterSpells(r,s){return r.filter(u=>{if(s.school!=="all"&&u.school!==s.school)return!1;if(s.level!=="all"){const d=parseInt(s.level);if(u.level!==d)return!1}if(s.searchTerm){const d=s.searchTerm.toLowerCase(),f=u.name?.toLowerCase().includes(d),h=u.description?.toLowerCase().includes(d),m=u.school?.toLowerCase().includes(d);if(!f&&!h&&!m)return!1}return s.castableOnly&&u.level===0,!0})}sortSpells(r,s="level"){return[...r].sort((u,d)=>{switch(s){case"name":return(u.name||"").localeCompare(d.name||"");case"level":return u.level!==d.level?u.level-d.level:(u.name||"").localeCompare(d.name||"");case"school":return u.school!==d.school?(u.school||"").localeCompare(d.school||""):(u.name||"").localeCompare(d.name||"");case"range":return this.compareRange(u.range,d.range);default:return 0}})}compareRange(r,s){const u=d=>!d||d==="Personnel"?0:d==="Contact"?1:d.includes("mètres")?parseInt(d.match(/\d+/)?.[0]||"0"):999999;return u(r)-u(s)}canCastSpell(r,s,u=null){if(!r||!s.spellcasting)return!1;if(r.level===0)return!0;const d=this.getSpellSlots(s),f=u||r.level;for(let h=f;h<=9;h++){const m=d[h];if(m&&m.available>0)return!0}return!1}getAvailableCastingLevels(r,s){if(r.level===0)return[0];const u=this.getSpellSlots(s),d=[];for(let f=r.level;f<=9;f++){const h=u[f];h&&h.available>0&&d.push(f)}return d}calculateSpellDamage(r,s){if(!r.damage)return null;const u=r.damage,d=Math.max(0,s-r.level);return r.scalingDamage&&d>0?u+r.scalingDamage*d:u}getSchoolsOfMagic(){return["Abjuration","Invocation","Divination","Enchantement","Évocation","Illusion","Nécromancie","Transmutation"]}getGrimoireSpells(r){if(!r.spellcasting)return[];const s=[];return Object.entries($a).forEach(([u,d])=>{this.isSpellAvailableForClass(d,r)&&s.push({id:u,...d,isPrepared:r.spellcasting.preparedSpells?.includes(u)||!1})}),this.sortSpells(s,"level")}getUnpreparedSpells(r){if(!r.spellcasting)return[];const s=this.getGrimoireSpells(r),u=r.spellcasting.preparedSpells||[];return s.filter(d=>d.level>0&&!u.includes(d.id))}isSpellAvailableForClass(r,s){if(r.level===0)return s.level>=1;const u={1:1,2:3,3:5,4:7,5:9,6:11,7:13,8:15,9:17};return s.level>=(u[r.level]||20)}isSpellActive(r,s){return s.activeEffects?s.activeEffects.some(d=>d.sourceSpellId===r||d.name===r):!1}canPrepareSpell(r,s){if(!s.spellcasting||s.spellcasting.preparedSpells?.includes(r))return!1;const u=s.spellcasting.preparedSpells?.length||0,d=this.getMaxPreparedSpells(s);if(u>=d)return!1;const f=this.getSpellData(r);return!f||f.level===0?!1:this.isSpellAvailableForClass(f,s)}canUnprepareSpell(r,s){return s.spellcasting?.preparedSpells?s.spellcasting.preparedSpells.includes(r):!1}}class ji{static castSpell(r,s,u=[],d={}){const f={success:!1,character:r,messages:[],effects:[]},h=this.validateSpellcast(r,s);if(!h.success)return f.messages.push(h.message),f;s.level>0&&(f.character=this.consumeSpellSlot(f.character,s.level));const m=this.processSpellEffects(s,u,r,d);return f.effects=m.effects,f.messages=[...f.messages,...m.messages],f.character=this.applySpellEffectsToCharacter(f.character,s,m),f.success=!0,f}static validateSpellcast(r,s){if(!r.spellcasting)return{success:!1,message:"Ce personnage ne peut pas lancer de sorts"};if(![...r.spellcasting.cantrips||[],...r.spellcasting.preparedSpells||[]].includes(s.id))return{success:!1,message:"Sort non préparé"};if(s.level>0){const f=new ls().getSpellSlots(r);let h=!1;for(let m=s.level;m<=9;m++){const g=f[m];if(g&&g.available>0){h=!0;break}}if(!h)return{success:!1,message:"Aucun emplacement de sort disponible"}}return{success:!0}}static processSpellEffects(r,s,u,d={}){const f={effects:[],messages:[]};if(r.damage){const h=this.processDamageSpell(r,s,u,d);f.effects.push(...h.effects),f.messages.push(...h.messages)}if(r.healing){const h=this.processHealingSpell(r,s,u,d);f.effects.push(...h.effects),f.messages.push(...h.messages)}if(r.effects){const h=this.processUtilitySpell(r,s,u,d);f.effects.push(...h.effects),f.messages.push(...h.messages)}return f}static processDamageSpell(r,s,u,d){const f={effects:[],messages:[]};return s.forEach(h=>{let m=Jn(r.damage.dice)+(r.damage.bonus||0);if(d.spellLevel&&d.spellLevel>r.level){const g=d.spellLevel-r.level;if(r.damage.scaling){const v=Jn(r.damage.scaling)*g;m+=v}}f.effects.push({type:"damage",target:h,amount:m,damageType:r.damage.type}),f.messages.push(`${h.name} subit ${m} dégâts ${r.damage.type} de ${r.name}`)}),f}static processHealingSpell(r,s,u,d){const f={effects:[],messages:[]};return s.forEach(h=>{let m=Jn(r.healing.dice)+(r.healing.bonus||0);if(d.spellLevel&&d.spellLevel>r.level){const g=d.spellLevel-r.level;if(r.healing.scaling){const v=Jn(r.healing.scaling)*g;m+=v}}f.effects.push({type:"healing",target:h,amount:m}),f.messages.push(`${h.name} récupère ${m} points de vie grâce à ${r.name}`)}),f}static processUtilitySpell(r,s,u,d){const f={effects:[],messages:[]};return r.effects.forEach(h=>{switch(h.type){case"ac_bonus":s.forEach(m=>{f.effects.push({type:"ac_modifier",target:m,modifier:h.value,duration:r.duration}),f.messages.push(`${m.name} gagne +${h.value} CA grâce à ${r.name}`)});break;case"advantage":s.forEach(m=>{f.effects.push({type:"advantage",target:m,category:h.category,duration:r.duration}),f.messages.push(`${m.name} a l'avantage sur ${h.category} grâce à ${r.name}`)});break;case"condition":s.forEach(m=>{f.effects.push({type:"condition",target:m,condition:h.condition,duration:r.duration}),f.messages.push(`${m.name} est affecté par ${h.condition} (${r.name})`)});break;default:console.warn(`Unknown spell effect type: ${h.type}`)}}),f}static getAvailableSpellSlots(r){return r.spellcasting?r.spellcasting.slotsRemaining||{}:{}}static applySpellEffectsToCharacter(r,s,u){let d={...r};if(s.name==="Armure du Mage"){const h=13+Math.floor((r.stats.dexterite-10)/2);d={...d,ac:h,armorClass:h,activeEffects:[...r.activeEffects||[],{id:`armure_du_mage_${Date.now()}`,sourceSpellId:"Armure du Mage",name:"Armure du Mage",type:"spell_effect",description:"CA = 13 + modificateur de Dextérité",startTime:new Date}]}}return u.effects.forEach(f=>{if(f.target===r||f.target?.id===r.id)switch(f.type){case"ac_modifier":d.armorClass=(d.armorClass||10)+f.modifier;break;case"healing":d.currentHP=Math.min(d.maxHP,d.currentHP+f.amount);break}}),d}static consumeSpellSlot(r,s){if(!r.spellcasting||s<=0)return r;const d=new ls().getSpellSlots(r);let f=null;for(let m=s;m<=9;m++){const g=d[m];if(g&&g.available>0){f=m;break}}if(!f)return r;const h={...d,[f]:{...d[f],used:d[f].used+1,available:d[f].available-1}};return{...r,spellcasting:{...r.spellcasting,spellSlots:h}}}static getPreparedSpells(r){return r.spellcasting?[...r.spellcasting.cantrips||[],...r.spellcasting.preparedSpells||[]]:[]}static getMaxPreparedSpells(r){if(!r.spellcasting)return 0;const s=qe.getSpellcastingAbility(r),u=Math.max(1,ze(r.stats[s]));return r.level+u}static prepareSpell(r,s){if(!r.spellcasting)return null;const u=r.spellcasting.preparedSpells||[],d=this.getMaxPreparedSpells(r);return u.includes(s)?r:u.length>=d?null:{...r,spellcasting:{...r.spellcasting,preparedSpells:[...u,s]}}}static unprepareSpell(r,s){if(!r.spellcasting)return r;const u=r.spellcasting.preparedSpells||[];return{...r,spellcasting:{...r.spellcasting,preparedSpells:u.filter(d=>d!==s)}}}}const es={potionOfHealing:{name:"Potion de Soin",description:"Restaure 2d4 + 2 PV.",type:"consumable",iconType:"heal",weight:.5,use:c=>{const r=Math.floor(Math.random()*4)+1+Math.floor(Math.random()*4)+1+2,s=Math.min(c.maxHP,c.currentHP+r);return{...c,currentHP:s}},message:c=>`Tu as bu une Potion de Soin et récupères ${c} PV.`},potionOfSuperiorHealing:{name:"Potion de Soin Supérieure",description:"Restaure 4d4 + 4 PV.",type:"consumable",iconType:"heal",weight:.5,use:c=>{let r=0;for(let u=0;u<4;u++)r+=Math.floor(Math.random()*4)+1;r+=4;const s=Math.min(c.maxHP,c.currentHP+r);return{...c,currentHP:s}},message:c=>`Tu as bu une Potion de Soin Supérieure et récupères ${c} PV.`},scrollOfStrength:{name:"Parchemin de Force",description:"Augmente ta Force de 2 de manière permanente.",type:"consumable",iconType:"upgrade",weight:.1,use:c=>({...c,stats:{...c.stats,force:c.stats.force+2}}),message:()=>"Tu as lu un Parchemin de Force et te sens plus puissant !"},scrollOfDexterity:{name:"Parchemin d'Agilité",description:"Augmente ta Dextérité de 2 de manière permanente.",type:"consumable",iconType:"upgrade",weight:.1,use:c=>({...c,stats:{...c.stats,dexterite:c.stats.dexterite+2}}),message:()=>"Tu as lu un Parchemin d'Agilité et te sens plus agile !"},scrollOfConstitution:{name:"Parchemin de Vitalité",description:"Augmente ta Constitution de 2 de manière permanente et tes PV maximum de 2.",type:"consumable",iconType:"upgrade",weight:.1,use:c=>({...c,stats:{...c.stats,constitution:c.stats.constitution+2},maxHP:c.maxHP+2,currentHP:c.currentHP+2}),message:()=>"Tu as lu un Parchemin de Vitalité, ton corps se renforce et tu gagnes des PV !"},scrollOfIntelligence:{name:"Parchemin d'Intelligence",description:"Augmente ton Intelligence de 2 de manière permanente.",type:"consumable",iconType:"upgrade",rarity:"légendaire",weight:.1,use:c=>({...c,stats:{...c.stats,intelligence:c.stats.intelligence+2}}),message:()=>"Tu as lu un Parchemin d'Intelligence et tes facultés augmentent !"},scrollOfSagesse:{name:"Parchemin de Sagesse",description:"Augmente ta Sagesse de 2 de manière permanente.",type:"consumable",iconType:"upgrade",weight:.1,use:c=>({...c,stats:{...c.stats,sagesse:c.stats.sagesse+2}}),message:()=>"Tu as lu un Parchemin de Sagesse et te sens plus sae !"},bookArtHeal:{name:"Livre l'art de la prestidigitation",description:"C'est un jolie livre vous devriez le lire",type:"consumable",iconType:"heal",weight:.8,use:c=>{const s=Math.min(c.maxHP,c.currentHP+2);return{...c,currentHP:s}},message:()=>"Tu as lu ce livre pendant une heure et tu t'es un peu reposé, tu as récuperer 2PV"}},cn={dagger:{name:"Dague",id:"dagger",type:"weapon",category:"melee",damage:{dice:"1d4",bonus:0,type:"force"},damageType:"perforant",properties:["finesse","light","thrown"],range:{melee:1,thrown:"20/60"},stat:"force",description:"Une petite lame facile à manier."},club:{name:"Gourdin",id:"club",type:"weapon",category:"melee",damage:{dice:"1d4",bonus:0,type:"force"},damageType:"contondant",properties:["light"],range:{melee:1},stat:"force",description:"Un simple bâton de bois."},quarterstaff:{name:"Bâton",id:"quarterstaff",type:"weapon",category:"melee",damage:{dice:"1d6",bonus:0,type:"force"},damageType:"contondant",properties:["versatile"],range:{melee:1},stat:"force",description:"Un bâton solide pouvant être manié à une ou deux mains."},longsword:{name:"Épée longue",id:"longsword",type:"weapon",category:"melee",damage:{dice:"1d8",bonus:0,type:"force"},damageType:"tranchant",properties:["versatile"],range:{melee:1},stat:"force",description:"Une épée classique, équilibrée et polyvalente."},shortsword:{name:"Épée courte",id:"shortsword",type:"weapon",category:"melee",damage:{dice:"1d6",bonus:0,type:"force"},damageType:"perforant",properties:["finesse","light"],range:{melee:1},stat:"force",description:"Une lame courte et rapide."},rapier:{name:"Rapière",id:"rapier",type:"weapon",category:"melee",damage:{dice:"1d8",bonus:0,type:"dexterite"},damageType:"perforant",properties:["finesse"],range:{melee:1},stat:"dexterite",description:"Une épée d'estoc élégante et précise."},battleaxe:{name:"Hache de bataille",id:"battleaxe",type:"weapon",category:"melee",damage:{dice:"1d8",bonus:0,type:"force"},damageType:"tranchant",properties:["versatile"],range:{melee:1},stat:"force",description:"Une hache lourde et tranchante."},warhammer:{name:"Marteau de guerre",id:"warhammer",type:"weapon",category:"melee",damage:{dice:"1d8",bonus:0,type:"force"},damageType:"contondant",properties:["versatile"],range:{melee:1},stat:"force",description:"Un marteau lourd conçu pour le combat."},greatsword:{name:"Épée à deux mains",id:"greatsword",type:"weapon",category:"melee",damage:{dice:"2d6",bonus:0,type:"force"},damageType:"tranchant",properties:["heavy","two-handed"],range:{melee:1},stat:"force",description:"Une épée massive nécessitant les deux mains."},lightCrossbow:{name:"Arbalète légère",id:"lightCrossbow",type:"weapon",category:"ranged",damage:{dice:"1d8",bonus:0,type:"dexterite"},damageType:"perforant",properties:["ammunition","loading","two-handed"],range:{ranged:"80/320"},stat:"dexterite",description:"Une arbalète facile à manier."},shortbow:{name:"Arc court",id:"shortbow",type:"weapon",category:"ranged",damage:{dice:"1d6",bonus:0,type:"dexterite"},damageType:"perforant",properties:["ammunition","two-handed"],range:{ranged:"80/320"},stat:"dexterite",description:"Un arc compact et maniable."},longbow:{name:"Arc long",id:"longbow",type:"weapon",category:"ranged",damage:{dice:"1d8",bonus:0,type:"dexterite"},damageType:"perforant",properties:["ammunition","heavy","two-handed"],range:{ranged:"150/600"},stat:"dexterite",description:"Un arc puissant avec une longue portée."},heavybow:{name:"Arc lourd",id:"heavybow",type:"weapon",category:"ranged",damage:{dice:"1d10",bonus:0,type:"dexterite"},damageType:"perforant",properties:["ammunition","heavy","two-handed"],range:{ranged:"200/800"},stat:"dexterite",description:"Un arc de guerre exceptionnellement puissant, difficile à bander."},heavyCrossbow:{name:"Arbalète lourde",id:"heavyCrossbow",type:"weapon",category:"ranged",damage:{dice:"1d10",bonus:0,type:"dexterite"},damageType:"perforant",properties:["ammunition","heavy","loading","two-handed"],range:{ranged:"100/400"},stat:"dexterite",description:"Une arbalète puissante mais lente à recharger."},arccheat:{name:"Arc Du MJ",id:"arccheat",type:"weapon",category:"ranged",damage:{dice:"1d10",bonus:50,type:"intelligence"},damageType:"perforant",properties:["ammunition","heavy","two-handed"],range:{ranged:"150/600"},stat:"intelligence",description:"Un arc d'une grande précision, fabriqué à partir du bois d'un arbre ancien.",rarity:"Légendaire",weight:3}},ut=c=>(c.playerCharacter&&(c.selectedCharacter=c.playerCharacter),c),$t=Mi(yv(Di((c,r)=>({playerCharacter:null,playerCompanion:null,playerCompanions:[],activeCompanions:[],selectedCharacter:null,activeEffects:[],temporaryModifiers:{},experienceGains:[],levelUpPending:!1,levelUpData:null,setPlayerCharacter:s=>c(ut({playerCharacter:s?Lt.deepClone(s):null})),setPlayerCompanion:s=>c({playerCompanion:s?Lt.deepClone(s):null}),addCompanion:s=>c(u=>{if(u.playerCompanions.length>=3)return console.warn("Maximum 3 compagnons autorisés"),u;const d=Lt.deepClone(s);return d.id=d.id||d.name||Lt.generateId("companion"),{playerCompanions:[...u.playerCompanions,d]}}),removeCompanion:s=>c(u=>({playerCompanions:u.playerCompanions.filter(d=>d.id!==s),activeCompanions:u.activeCompanions.filter(d=>d!==s)})),setActiveCompanions:s=>c(u=>({activeCompanions:s.filter(f=>u.playerCompanions.some(h=>h.id===f))})),getCompanion:s=>{const{playerCompanions:u}=r();return u.find(d=>d.id===s)},getActiveCompanions:()=>{const{playerCompanions:s,activeCompanions:u}=r();return u.map(d=>s.find(f=>f.id===d)).filter(Boolean)},updatePlayerCharacter:s=>c(u=>({playerCharacter:u.playerCharacter?{...u.playerCharacter,...s}:null})),updatePlayerCompanion:s=>c(u=>({playerCompanion:u.playerCompanion?{...u.playerCompanion,...s}:null})),updateCompanion:(s,u)=>c(d=>({playerCompanions:d.playerCompanions.map(f=>f.id===s?{...f,...u}:f),playerCompanion:d.playerCompanion?.id===s?{...d.playerCompanion,...u}:d.playerCompanion})),takeDamagePlayer:s=>c(u=>{if(!u.playerCharacter)return u;const d=qe.takeDamage(u.playerCharacter,s);return ut({playerCharacter:d})}),takeDamageCompanion:s=>c(u=>u.playerCompanion?{playerCompanion:qe.takeDamage(u.playerCompanion,s)}:u),takeDamageCompanionById:(s,u)=>c(d=>{const f=d.playerCompanions.find(m=>m.id===s);if(!f)return d;const h=qe.takeDamage(f,u);return{playerCompanions:d.playerCompanions.map(m=>m.id===s?h:m),playerCompanion:d.playerCompanion?.id===s?h:d.playerCompanion}}),healPlayer:s=>c(u=>{if(!u.playerCharacter)return u;const d=qe.heal(u.playerCharacter,s);return ut({playerCharacter:d})}),healCompanion:s=>c(u=>u.playerCompanion?{playerCompanion:qe.heal(u.playerCompanion,s)}:u),healCompanionById:(s,u)=>c(d=>{const f=d.playerCompanions.find(m=>m.id===s);if(!f)return d;const h=qe.heal(f,u);return{playerCompanions:d.playerCompanions.map(m=>m.id===s?h:m),playerCompanion:d.playerCompanion?.id===s?h:d.playerCompanion}}),shortRestPlayer:(s=0)=>c(u=>{if(!u.playerCharacter)return u;const d=qe.shortRest(u.playerCharacter,s);return ut({playerCharacter:d})}),longRestPlayer:()=>c(s=>{if(!s.playerCharacter)return s;const u=qe.longRest(s.playerCharacter);return ut({playerCharacter:u})}),longRestCompanion:()=>c(s=>s.playerCompanion?{playerCompanion:qe.longRest(s.playerCompanion)}:s),longRestCompanionById:s=>c(u=>{const d=u.playerCompanions.find(h=>h.id===s);if(!d)return u;const f=qe.longRest(d);return{playerCompanions:u.playerCompanions.map(h=>h.id===s?f:h),playerCompanion:u.playerCompanion?.id===s?f:u.playerCompanion}}),longRestAll:()=>{const{longRestPlayer:s,longRestCompanion:u,playerCompanions:d}=r();s(),u(),d.forEach(f=>{r().longRestCompanionById(f.id)})},spendHitDie:(s="player")=>c(u=>{const d=s==="player"?u.playerCharacter:u.playerCompanion;if(!d||d.hitDice<=0||d.currentHP>=d.maxHP)return u;const f=d.hitDiceType||8,h=Math.floor((d.stats.constitution-10)/2),m=Math.floor(Math.random()*f)+1,g=Math.max(1,m+h),v=Math.min(d.maxHP,d.currentHP+g),b={...d,currentHP:v,hitDice:d.hitDice-1};return s==="player"?ut({playerCharacter:b}):{playerCompanion:b}}),addExperience:(s,u="player")=>c(d=>{const f=u==="player"?d.playerCharacter:d.playerCompanion;if(!f)return d;console.log(`🎯 Adding ${s} XP to ${u} (current level: ${f.level}, current XP: ${f.currentXP||f.experience||0})`);const h=qe.addExperience(f,s);console.log(`🎯 After XP gain: level ${h.level}, XP: ${h.currentXP}`);const m={...d};return h.level>f.level&&(console.log(`🎉 Level up detected! ${f.level} → ${h.level}`),m.levelUpPending=!0,m.levelUpData={character:u,oldLevel:f.level,newLevel:h.level,hpGained:h.maxHP-f.maxHP}),m.experienceGains=[...d.experienceGains,{id:Lt.generateId("xp"),amount:s,target:u,timestamp:new Date}],u==="player"?(m.playerCharacter=h,m.selectedCharacter=h):m.playerCompanion=h,m}),confirmLevelUp:()=>c(s=>({levelUpPending:!1,levelUpData:null})),castSpellPlayer:(s,u={})=>c(d=>d.playerCharacter?{playerCharacter:ji.castSpell(d.playerCharacter,s,[],u).character}:d),consumeSpellSlot:(s,u="player")=>c(d=>{const f=u==="player"?d.playerCharacter:d.playerCompanion;if(!f)return d;const h=qe.consumeSpellSlot(f,s);return u==="player"?ut({playerCharacter:h}):{playerCompanion:h}}),prepareSpell:(s,u="player")=>{const d=r(),f=u==="player"?d.playerCharacter:d.playerCompanion;if(!f)return{success:!1,message:`Aucun personnage ${u} trouvé`};const h=ji.prepareSpell(f,s);if(!h){const m=f.spellcasting?.preparedSpells||[],g=ji.getMaxPreparedSpells(f);return m.includes(s)?{success:!1,message:`${s} est déjà préparé`}:m.length>=g?{success:!1,message:`Limite de sorts préparés atteinte (${g})`}:{success:!1,message:`Impossible de préparer ${s}`}}return c(u==="player"?ut({playerCharacter:h}):{playerCompanion:h}),{success:!0,message:`${s} préparé avec succès`}},unprepareSpell:(s,u="player")=>{const d=r(),f=u==="player"?d.playerCharacter:d.playerCompanion;if(!f)return{success:!1,message:`Aucun personnage ${u} trouvé`};const h=ji.unprepareSpell(f,s);return h?(c(u==="player"?ut({playerCharacter:h}):{playerCompanion:h}),{success:!0,message:`${s} retiré des sorts préparés`}):{success:!1,message:`Impossible de retirer ${s}`}},equipItem:(s,u="player")=>c(d=>{const f=u==="player"?d.playerCharacter:d.playerCompanion;if(!f)return d;let h=f.inventory?.find(x=>(x.id||x.name||x.nom)===s);if(!h){const x=cn[s];x&&(h={...x,id:s})}if(!h)return d;const m=h.type;if(!["weapon","arme","armor","armure","accessory","accessoire"].includes(m))return d;let v={...f.equipment||{}},b=null;if(m==="weapon"||m==="arme"?b="mainHand":m==="armor"||m==="armure"?b="body":(m==="accessory"||m==="accessoire")&&(b="accessory"),!b)return d;if(v[b]){const x=v[b],A=f.inventory?.some(E=>(E.id||E.name||E.nom)===x);let N=[...f.inventory||[]];if(A){const E=cn[x];E&&N.push({...E,id:x})}v[b]=s,N=N.filter(E=>(E.id||E.name||E.nom)!==s);const C={inventory:N,equipment:v};return u==="player"?ut({playerCharacter:{...f,...C}}):{playerCompanion:{...f,...C}}}else{v[b]=s;const A={inventory:f.inventory?f.inventory.filter(N=>(N.id||N.name||N.nom)!==s):[],equipment:v};return u==="player"?ut({playerCharacter:{...f,...A}}):{playerCompanion:{...f,...A}}}}),unequipItem:(s,u="player")=>c(d=>{const f=u==="player"?d.playerCharacter:d.playerCompanion;if(!f||!f.equipment)return d;const h=f.equipment;let m=null;for(const[A,N]of Object.entries(h))if(N===s){m=A;break}if(!m)return d;const g={...h};delete g[m];const v=cn[s],b=[...f.inventory||[]];v&&b.push({...v,id:s});const x={inventory:b,equipment:g};return u==="player"?ut({playerCharacter:{...f,...x}}):{playerCompanion:{...f,...x}}}),addItemToInventory:(s,u="player")=>c(d=>{const f=u==="player"?d.playerCharacter:d.playerCompanion;if(!f)return d;const h=f.inventory||[],m=s.id||s.name||s.nom,g=s.quantity||1,v=h.findIndex(A=>(A.id||A.name||A.nom)===m);let b;v>=0?(b=[...h],b[v]={...b[v],quantity:(b[v].quantity||1)+g}):b=[...h,{...s,id:s.id||s.name||s.nom||Lt.generateId("item"),quantity:g}];const x={inventory:b};return u==="player"?ut({playerCharacter:{...f,...x}}):{playerCompanion:{...f,...x}}}),removeItemFromInventory:(s,u="player",d=1)=>c(f=>{const h=u==="player"?f.playerCharacter:f.playerCompanion;if(!h)return f;const m=h.inventory||[],g=m.findIndex(N=>(N.id||N.name||N.nom)===s);if(g===-1)return f;let v=[...m];const b=v[g],x=b.quantity||1;x<=d?v.splice(g,1):v[g]={...b,quantity:x-d};const A={inventory:v};return u==="player"?ut({playerCharacter:{...h,...A}}):{playerCompanion:{...h,...A}}}),useItem:(s,u="player")=>{const d=u==="player"?r().playerCharacter:r().playerCompanion;if(!d)return{success:!1,message:"Personnage non trouvé"};const f=d.inventory.find(m=>(m.id||m.name||m.nom)===s);if(!f)return{success:!1,message:"Objet non trouvé dans l'inventaire"};const h=es[s]||es[f.id]||es[f.name]||es[f.nom];if(h&&h.use)try{const m=d.currentHP,g=h.use(d),v=g.currentHP-m;return c(u==="player"?{playerCharacter:g,selectedCharacter:g}:{playerCompanion:g}),h.type==="consumable"&&r().removeItemFromInventory(s,u,1),{success:!0,message:typeof h.message=="function"?h.message(v):h.message,item:h}}catch(m){return console.error("Erreur lors de l'utilisation de l'objet:",m),{success:!1,message:`Erreur: ${m.message}`}}else{if(f.effects){let m={...d},g=`${f.name||f.nom} utilisé`;return f.effects.forEach(v=>{switch(v.type){case"heal":const b=v.value;m.currentHP=Math.min(d.maxHP,d.currentHP+b),g=`Vous récupérez ${b} PV`;break;default:console.warn(`Unknown item effect type: ${v.type}`)}}),c(u==="player"?{playerCharacter:m,selectedCharacter:m}:{playerCompanion:m}),(f.consumable||f.type==="consumable")&&r().removeItemFromInventory(s,u,1),{success:!0,message:g}}return{success:!1,message:"Cet objet ne peut pas être utilisé"}}},addEffect:s=>c(u=>({activeEffects:[...u.activeEffects,{...s,id:s.id||Lt.generateId("effect"),startTime:new Date}]})),removeEffect:s=>c(u=>({activeEffects:u.activeEffects.filter(d=>d.id!==s)})),clearExpiredEffects:()=>c(s=>{const u=new Date;return{activeEffects:s.activeEffects.filter(d=>d.duration?u-d.startTime<d.duration:!0)}}),consolidateInventory:(s="player")=>c(u=>{const d=s==="player"?u.playerCharacter:u.playerCompanion;if(!d||!d.inventory)return u;const f=[],h=new Map;d.inventory.forEach(g=>{const v=g.id||g.name||g.nom;if(h.has(v)){const b=h.get(v);b.quantity=(b.quantity||1)+(g.quantity||1)}else h.set(v,{...g,quantity:g.quantity||1})}),h.forEach(g=>f.push(g));const m={inventory:f};return s==="player"?ut({playerCharacter:{...d,...m}}):{playerCompanion:{...d,...m}}}),resetCharacters:()=>c({playerCharacter:null,playerCompanion:null,playerCompanions:[],activeCompanions:[],activeEffects:[],temporaryModifiers:{},experienceGains:[],levelUpPending:!1,levelUpData:null}),clearExperienceGains:()=>c({experienceGains:[]})}),{name:"character-store"}))),Fr=8,eu=6,ot={PLAYER:"player",COMPANION:"companion",ENEMY:"enemy"},Zn=(c,r)=>c>=0&&c<Fr&&r>=0&&r<eu,Ni=(c,r,s,u=[],d=null)=>{if(s.player&&s.player.x===c&&s.player.y===r)return!0;for(const f in s)if(f!=="player"&&f!==d&&!f.endsWith("StartPos")){const h=s[f];if(h&&h.x===c&&h.y===r)return!0}for(const f of u)if(f.name!==d&&f.currentHP>0){const h=s[f.name];if(h&&h.x===c&&h.y===r)return!0}return!1},fm=(c,r,s)=>{if(!c||!r)return!1;const u=Math.abs(c.x-r.x)+Math.abs(c.y-r.y),d=Av(s);return u<=d},Av=c=>{if(c.actionType==="spell"){if(typeof c.range=="string"){if(c.range.includes("mètres")){const r=parseInt(c.range);return Math.floor(r/1.5)}return c.range==="Toucher"?1:12}return c.range||12}if(c.actionType==="weapon"){if(c.category==="melee")return c.range?.melee||1;if(c.category==="ranged"){const r=c.range?.ranged||"80/320",s=parseInt(r.split("/")[0]);return Math.floor(s/5)}return 1}return 1};class It{static calculateDamage(r){let s=Jn(r.damageDice)+(r.damageBonus||0),u=`${s} dégâts ${r.damageType}`;if(r.secondaryDamageDice){const d=Jn(r.secondaryDamageDice)+(r.secondaryDamageBonus||0);s+=d,u+=` + ${d} dégâts ${r.secondaryDamageType} (${s}dmg)`}return{damage:s,message:u}}static getTargetsInRange(r,s,u,d){const{playerCharacter:f,companionCharacter:h,combatEnemies:m,combatPositions:g}=d,v=[];if(!s)return v;const b=fm.getActionRange?fm.getActionRange(u):u.range||1;return r.type===ot.ENEMY&&f?.currentHP>0&&g.player&&wt(s,g.player)<=b&&v.push({...f,type:ot.PLAYER,position:g.player}),r.type===ot.ENEMY&&h?.currentHP>0&&g.companion&&wt(s,g.companion)<=b&&v.push({...h,type:ot.COMPANION,position:g.companion}),[ot.PLAYER,ot.COMPANION].includes(r.type)&&m.forEach(x=>{if(x.currentHP>0){const A=g[x.name];A&&wt(s,A)<=b&&v.push({...x,type:ot.ENEMY,position:A})}}),v}static calculateOptimalMovement(r,s,u){if(!s||r.currentHP<=0)return null;const d=this.findPotentialTargets(r,u);if(d.length===0)return null;const f=d.reduce((b,x)=>{const A=wt(s,x.position);return!b||A<b.distance?{target:x,distance:A}:b},null);if(!f)return null;const h=this.getIdealDistance(r);if(f.distance<=h)return null;const m=r.movement||6;let g=null,v=-1;for(let b=-m;b<=m;b++)for(let x=-m;x<=m;x++){const A=Math.abs(b)+Math.abs(x);if(A===0||A>m)continue;const N={x:s.x+b,y:s.y+x};if(!Zn(N.x,N.y)||Ni(N.x,N.y,u.combatPositions,u.combatEnemies,r.name))continue;const C=wt(N,f.target.position),D=100-Math.abs(C-h)-A*.1;D>v&&(v=D,g=N)}return g}static findPotentialTargets(r,s){const{playerCharacter:u,companionCharacter:d,combatEnemies:f,combatPositions:h,activeCompanions:m=[]}=s,g=[];return r.type===ot.ENEMY?(u?.currentHP>0&&h.player&&g.push({entity:u,position:h.player}),m&&m.length>0&&m.forEach(v=>{if(v&&v.currentHP>0){const b=v.id||v.name.toLowerCase(),x=h[b];x&&g.push({entity:v,position:x})}}),d?.currentHP>0&&h.companion&&g.push({entity:d,position:h.companion})):f.forEach(v=>{v.currentHP>0&&h[v.name]&&g.push({entity:v,position:h[v.name]})}),g}static getIdealDistance(r){if(!r.attacks)return 1;const s=r.attacks.some(d=>d.type==="ranged"||d.range&&d.range>1),u=r.attacks.some(d=>d.type==="melee"||!d.range||d.range<=1);if(u&&!s)return 1;if(s&&!u){const d=r.attacks.find(f=>f.type==="ranged");return Math.min(4,d?.range||4)}else return 1}static calculateAoESquares(r,s){const u=[];if(!r||!s)return u;switch(s.shape){case"sphere":case"circle":const d=s.size||1;for(let m=r.x-d;m<=r.x+d;m++)for(let g=r.y-d;g<=r.y+d;g++)Zn(m,g)&&wt(r,{x:m,y:g})<=d&&u.push({x:m,y:g});break;case"cone":const f=s.size||2;for(let m=1;m<=f;m++)for(let g=-m;g<=m;g++){const v=r.x+m,b=r.y+g;Zn(v,b)&&u.push({x:v,y:b})}break;case"line":const h=s.size||3;for(let m=1;m<=h;m++){const g=r.x+m,v=r.y;Zn(g,v)&&u.push({x:g,y:v})}break;default:u.push(r)}return u}static findBestTarget(r,s,u){const{playerCharacter:d,companionCharacter:f,combatPositions:h,activeCompanions:m=[]}=u;if(!s)return console.warn(`⚠️ Pas de position pour ${r.name}`),null;const g=[];if(r.type===ot.ENEMY?(d&&d.currentHP>0&&h.player&&g.push({type:ot.PLAYER,name:d.name,character:d,position:h.player}),m&&m.length>0&&m.forEach(x=>{if(x&&x.currentHP>0){const A=x.id||x.name.toLowerCase(),N=h[A];N&&g.push({type:ot.COMPANION,name:x.name,character:x,position:N})}}),f&&f.currentHP>0&&h.companion&&g.push({type:ot.COMPANION,name:f.name,character:f,position:h.companion})):(r.type===ot.COMPANION||r.type==="companion")&&u.combatEnemies&&u.combatEnemies.forEach(x=>{x.currentHP>0&&h[x.name]&&g.push({type:ot.ENEMY,name:x.name,character:x,position:h[x.name]})}),g.length===0)return console.log(`🎯 ${r.name}: Aucune cible vivante trouvée`),null;let v=null,b=1/0;return console.log(`🎯 ${r.name} à (${s.x}, ${s.y}) évalue les cibles:`),console.log("   📍 Positions disponibles:",Object.keys(h).map(x=>`${x}: (${h[x]?.x}, ${h[x]?.y})`).join(", ")),g.forEach(x=>{const A=wt(s,x.position);console.log(`   - ${x.name} (${x.type}) à (${x.position.x}, ${x.position.y}) - distance: ${A}`),A<b?(b=A,v=x,console.log(`     ✅ Nouvelle cible la plus proche: ${x.name} à distance ${A}`)):A===b&&x.type===ot.PLAYER&&(v=x,console.log(`     ↔️ Même distance ${A}, priorité au joueur: ${x.name}`))}),v&&(v.distance=b,console.log(`🏹 ${r.name} choisit: ${v.name} (${v.type}) à distance ${b}`)),v}static validateMovement(r,s,u,d){if(!Zn(u.x,u.y))return console.warn(`❌ Position invalide pour ${r.name}: (${u.x}, ${u.y})`),!1;const{combatPositions:f,combatEnemies:h}=d;if(Ni(u.x,u.y,f,h,r.name))return console.warn(`❌ Position occupée pour ${r.name}: (${u.x}, ${u.y})`),!1;const g=wt(s,u),v=r.movement||6;return g>v?(console.warn(`❌ Mouvement trop loin pour ${r.name}: ${g} > ${v}`),!1):!0}}const jm={gobelin:{name:"Gobelin",maxHP:7,currentHP:7,ac:15,xp:50,stats:{force:8,dexterite:14,constitution:10,intelligence:10,sagesse:8,charisme:8},attacks:[{name:"son Cimeterre",type:"melee",attackBonus:4,range:1,targets:1,damageDice:"1d6",damageBonus:2,damageType:"tranchant",description:"Attaque au corps à corps avec une arme : +4 au toucher, allonge 1,50 m, une cible. Touché : 5 (1d6 + 2) dégâts tranchants."}],image:"https://www.aidedd.org/dnd/images/goblin.jpg"},mephiteBoueux:{name:"Méphite boueux",maxHP:27,currentHP:27,ac:11,xp:50,stats:{force:8,dexterite:12,constitution:12,intelligence:9,sagesse:11,charisme:7},attacks:[{name:"Poing",type:"melee",attackBonus:3,range:1,targets:1,damageDice:"1d6",damageBonus:1,damageType:"contondant",description:"Attaque au corps à corps avec une arme : +3 au toucher, allonge 1,50 m, une créature. Touché : 4 (1d6 + 1) dégâts contondants."}],image:"https://www.aidedd.org/dnd/images/mud-mephit.jpg"},kobold:{name:"Kobold",maxHP:5,currentHP:5,ac:12,xp:25,movement:6,stats:{force:8,dexterite:15,constitution:10,intelligence:8,sagesse:8,charisme:8},attacks:[{name:"sa Dague",type:"melee",attackBonus:4,range:1,targets:1,damageDice:"1d4",damageBonus:2,damageType:"perforant",description:"Attaque au corps à corps : +4 au toucher, allonge 1 m, une cible. Touché : 4 (1d4 + 2) dégâts perforants."}],image:"https://www.aidedd.org/dnd/images/kobold.jpg"},goule:{name:"Goule",maxHP:22,currentHP:22,ac:12,xp:200,movement:6,stats:{force:13,dexterite:15,constitution:10,intelligence:7,sagesse:10,charisme:6},attacks:[{name:"Griffes",type:"melee",attackBonus:4,range:1,targets:1,damageDice:"2d4",damageBonus:2,damageType:"tranchant",description:"Attaque au corps à corps avec une arme : +4 au toucher, allonge 1,50 m, une cible. Touché : 7 (2d4 + 2) dégâts tranchants. Si la cible est une créature autre qu'un elfe ou un mort-vivant, celle-ci doit réussir un jet de sauvegarde de Constitution DD 10 pour ne pas être paralysée pendant 1 minute. La cible peut relancer le jet de sauvegarde à la fin de chacun de ses tours, mettant fin à l'effet qui l'affecte en cas de réussite."}],image:"https://www.aidedd.org/dnd/images/ghoul.jpg"},squelette:{name:"Squelette",maxHP:13,currentHP:13,ac:13,xp:50,movement:6,stats:{force:10,dexterite:14,constitution:15,intelligence:6,sagesse:8,charisme:5},attacks:[{name:"son Épée courte",type:"melee",attackBonus:4,range:1,targets:1,damageDice:"1d6",damageBonus:2,damageType:"perforant",description:"Attaque au corps à corps : +4 au toucher, allonge 1 m, une cible. Touché : 4 (1d4 + 2) dégâts perforants."}],image:"https://www.aidedd.org/dnd/images/skeleton.jpg"},diablotin:{name:"Diablotin",maxHP:10,currentHP:10,ac:13,xp:200,movement:6,stats:{force:6,dexterite:17,constitution:13,intelligence:11,sagesse:12,charisme:14},attacks:[{name:"Dard",type:"melee",attackBonus:5,range:1,targets:1,damageDice:"1d4",damageBonus:3,damageType:"perforants",description:"Attaque au corps à corps : +4 au toucher, allonge 1 m, une cible. Touché : 4 (1d4 + 2) dégâts perforants."}],image:"https://www.aidedd.org/dnd/images/imp.jpg"},diable:{name:"Diable épineux",maxHP:22,currentHP:22,ac:13,xp:450,stats:{force:10,dexterite:15,constitution:12,intelligence:11,sagesse:14,charisme:8},movement:8,attackSets:[{name:"Morsure et fourche",attacks:[{name:"Morsure",type:"melee",attackBonus:2,range:1,damageDice:"2d4",damageBonus:0,damageType:"tranchants",description:"Attaque avec ces crocs aceres"},{name:"Fourche",type:"melee",attackBonus:2,range:1,damageDice:"1d6",damageBonus:0,damageType:"perforants",description:"Attaque avec une fourche"}]},{name:"Double épine caudale",attacks:[{name:"Épine caudale",type:"ranged",attackBonus:4,range:6,damageDice:"1d4",damageBonus:2,damageType:"perforants",secondaryDamageDice:"1d6",secondaryDamageBonus:0,secondaryDamageType:"feu",description:"Projette une épine de sa queue"},{name:"Épine caudale",type:"ranged",attackBonus:4,range:6,damageDice:"1d4",damageBonus:2,damageType:"perforants",secondaryDamageDice:"1d6",secondaryDamageBonus:0,secondaryDamageType:"feu",description:"Projette une épine de sa queue"}]}],image:"https://www.aidedd.org/dnd/images/spined-devil.jpg"}};class Ci{initializeCombat(r,s,u){const d=this.createEnemiesFromEncounter(u),f=this.rollInitiative(r,s,d),h=this.initializePositions(r,s,d,u.enemyPositions);return{enemies:d,turnOrder:f,positions:h,currentTurn:0}}createEnemiesFromEncounter(r){if(!r?.enemies?.length)throw new Error("Aucun ennemi défini dans la rencontre");return r.enemies.flatMap((s,u)=>{const d=jm[s.type];return d?Array(s.count).fill(null).map((f,h)=>({...d,id:`${s.type}_${u}_${h}`,name:s.count>1?`${d.name} ${h+1}`:d.name,type:"enemy",currentHP:d.currentHP??d.maxHP??10,maxHP:d.maxHP??10,ac:d.ac??10,stats:{...d.stats},attacks:[...d.attacks||[]],image:d.image||"",isAlive:!0})):(console.error(`Template non trouvé pour: ${s.type}`),[])})}rollInitiative(r,s,u){const d=[];if(!r||!r.stats)throw console.error("CombatService: playerCharacter ou playerCharacter.stats manquant"),new Error("Personnage joueur requis pour initialiser le combat");const f=this.rollD20()+ze(r.stats.dexterite);if(d.push({...r,id:"player",type:"player",initiative:f,isAlive:!0}),s){const h=this.rollD20()+ze(s.stats.dexterite);d.push({...s,id:"companion",type:"companion",initiative:h,isAlive:!0})}return u.forEach(h=>{const m=this.rollD20()+ze(h.stats.dexterite);d.push({...h,initiative:m})}),d.sort((h,m)=>m.initiative===h.initiative?h.type==="player"?-1:m.type==="player"?1:h.type==="companion"?-1:m.type==="companion"?1:0:m.initiative-h.initiative)}initializePositions(r,s,u,d=null){const f={player:{x:1,y:2},companion:s?{x:0,y:2}:null,playerHasMoved:!1,companionHasMoved:!1};return d?u.forEach((h,m)=>{const g=d[m];g?f[h.id]={x:g.x,y:g.y}:f[h.id]=this.getDefaultEnemyPosition(m,u.length)}):u.forEach((h,m)=>{f[h.id]=this.getDefaultEnemyPosition(m,u.length)}),f}getDefaultEnemyPosition(r,s){const f=Math.floor(4.8),h=8-f;if(s===1)return{x:f+Math.floor(h/2),y:Math.floor(6/2)};const m=Math.min(h,s),g=Math.floor(r/m),v=r%m;return{x:f+v,y:Math.max(1,Math.min(4,g+1))}}executePlayerAction(r,s,u,d,f){const h=[],m={damage:[],effects:[],messages:h};if(!s||!u.length)return h.push({text:"Aucune action ou cible sélectionnée",type:"error"}),m;switch(s.type){case"attack":return this.executeAttack(r,s,u,m);case"spell":return this.executeSpell(r,s,u,m);default:return h.push({text:`Type d'action inconnu: ${s.type}`,type:"error"}),m}}executeAttack(r,s,u,d){return u.forEach(f=>{const h=this.rollD20(),m=this.getAttackBonus(r,s),g=h+m,v=h===20;if(g>=f.ac||v){let x=this.rollDamage(s.damage);v?(x*=2,d.messages.push({text:`💥 Coup critique ! ${r.name} inflige ${x} dégâts à ${f.name} !`,type:"critical"})):d.messages.push({text:`⚔️ ${r.name} touche ${f.name} et inflige ${x} dégâts`,type:"hit"}),d.damage.push({targetId:f.id,damage:x})}else d.messages.push({text:`❌ ${r.name} manque ${f.name} (${g} vs CA ${f.ac})`,type:"miss"})}),d}executeSpell(r,s,u,d){return d.messages.push({text:`🔮 ${r.name} lance ${s.name}`,type:"spell"}),u.forEach(f=>{if(s.requiresAttackRoll){const h=this.rollD20(),m=this.getSpellAttackBonus(r),g=h+m,v=h===20;if(g>=f.ac||v){let x=0;s.damage&&(x=this.rollDamage(s.damage.dice)+(s.damage.bonus||0),v&&(x*=2)),d.messages.push({text:`⚔️ ${s.name} touche ${f.name} et inflige ${x} dégâts`,type:v?"critical":"hit"}),d.damage.push({targetId:f.id||f.name,damage:x})}else d.messages.push({text:`❌ ${s.name} manque ${f.name} (${g} vs CA ${f.ac})`,type:"miss"})}else{let h=0;s.damage&&(h=this.rollDamage(s.damage.dice)+(s.damage.bonus||0)),d.messages.push({text:`💥 ${s.name} touche automatiquement ${f.name} et inflige ${h} dégâts`,type:"spell-hit"}),d.damage.push({targetId:f.id||f.name,damage:h})}}),d}getAttackBonus(r,s){if(s.attackBonus!==void 0)return s.attackBonus;const u=r.level?Math.ceil(r.level/4)+1:2;if(!r.stats)return console.error("❌ Character.stats manquant dans getAttackBonus:",r),0;let d="force";s.stat?d=s.stat:(s.category==="ranged"||s.type==="ranged"||s.range&&s.range>1)&&(d="dexterite");const f=r.stats[d];return f===void 0?(console.error(`❌ Stat ${d} manquante pour character:`,r),u):ze(f)+u}getSpellAttackBonus(r){const s=r.level?Math.ceil(r.level/4)+1:2;if(!r.spellcasting||!r.spellcasting.ability)return s;const u=r.spellcasting.ability,d=r.stats[u];return ze(d||10)+s}rollDamage(r){const s=r.match(/(\d+)d(\d+)(\+(\d+))?/);if(!s)return 0;const[,u,d,,f]=s;let h=0;for(let m=0;m<parseInt(u);m++)h+=Math.floor(Math.random()*parseInt(d))+1;return h+(parseInt(f)||0)}rollD20(){return Math.floor(Math.random()*20)+1}isDefeated(r){return r.currentHP<=0}checkCombatEnd(r,s,u){const d=this.isDefeated(r),f=s?this.isDefeated(s):!0,h=u.every(m=>this.isDefeated(m));return d&&f?"defeat":h?"victory":null}executeEntityAttack(r,s,u,d){if(!r||!s||!u)return console.error("❌ Paramètres manquants pour executeEntityAttack"),{success:!1,damage:0};if(u.character&&u.character.currentHP<=0)return console.warn(`⚠️ ${r.name} tente d'attaquer ${u.name} qui est déjà mort`),d(`${r.name} réalise que ${u.name} est déjà tombé au combat.`),{success:!1,damage:0};const f=this.rollD20(),h=this.getAttackBonus(r,s);if(isNaN(h))return console.error("❌ Attack bonus est NaN pour:",r,s),{success:!1,damage:0};const m=f+h,g=f===20,v=u.character?u.character.ac:u.ac||10;if(isNaN(v))return console.error("❌ Target AC est NaN pour:",u),{success:!1,damage:0};if(m>=v||g){let x=0;return s.damageDice?x=this.rollDamage(s.damageDice)+(s.damageBonus||0):s.damage?x=this.rollDamage(s.damage):x=1,g?(x*=2,d(`💥 Coup critique ! ${r.name} utilise ${s.name} et inflige ${x} dégâts à ${u.name} !`,"critical")):d(`⚔️ ${r.name} utilise ${s.name} et inflige ${x} dégâts à ${u.name}`,r.type==="enemy"?"enemy-hit":"companion-hit"),{success:!0,damage:x,critical:g}}else return d(`❌ ${r.name} manque ${u.name} avec ${s.name} (${m} vs CA ${v})`,"miss"),{success:!1,damage:0}}executeEntityMovement(r,s,u,d,f){if(!It.validateMovement(r,s,u,d))return console.warn(`❌ Mouvement invalide pour ${r.name}`),f(`${r.name} ne peut pas se déplacer à cette position.`),!1;const m=Math.abs(u.x-s.x)+Math.abs(u.y-s.y);return console.log(`🚶 ${r.name} bouge de (${s.x}, ${s.y}) vers (${u.x}, ${u.y}) - distance: ${m}`),!0}}const Wt=Mi(Di((c,r)=>({isActive:!1,isInitialized:!1,combatPhase:"idle",combatKey:0,encounterData:null,combatEnemies:[],companionCharacter:null,turnOrder:[],currentTurnIndex:0,turnCounter:0,combatPositions:{},showMovementFor:null,showTargetingFor:null,hasMovedThisTurn:!1,playerAction:null,actionTargets:[],selectedAoESquares:[],aoeCenter:null,defeated:!1,victory:!1,totalXpGained:0,initializeCombat:(s,u,d,f=[])=>c(h=>{const m=[];s.enemies.forEach((N,C)=>{const E=jm[N.type];if(!E){console.error("❌ Template ennemi non trouvé:",N.type);return}for(let D=0;D<N.count;D++)m.push({...Lt.deepClone(E),name:`${E.name} ${D+1}`,id:Lt.generateId("enemy"),type:"enemy"})});const g=[],v=Kn(ze(u.stats.dexterite));if(g.push({type:"player",name:u.name,initiative:v,character:u}),f&&f.length>0)console.log(`🎲 COMBAT INIT: ${f.length} compagnons actifs:`,f.map(N=>`${N.name}[${N.id}]`)),f.forEach((N,C)=>{if(N&&N.stats&&N.stats.dexterite){const E=Kn(ze(N.stats.dexterite));g.push({type:"companion",name:N.name,id:N.id,initiative:E,character:N}),console.log(`🎲 COMBAT INIT: [${C}] ${N.name} (${N.role}) initiative=${E}`)}else console.error("❌ COMBAT INIT: Compagnon invalide:",N)});else if(d&&d.stats){const N=Kn(ze(d.stats.dexterite));g.push({type:"companion",name:d.name,initiative:N,character:d}),console.log("🔄 COMBAT INIT: Mode compatibilité - compagnon unique")}else console.log("⚠️ COMBAT INIT: Aucun compagnon disponible");m.forEach(N=>{if(!N.stats||!N.stats.dexterite){console.error("❌ Enemy sans stats.dexterite:",N);return}const C=Kn(ze(N.stats.dexterite));g.push({type:"enemy",name:N.name,initiative:C,character:N})});const b=g.sort((N,C)=>C.initiative===N.initiative?N.type==="player"?-1:C.type==="player"?1:0:C.initiative-N.initiative),x=f.length>0?f.length:d?1:0,A=r().calculateInitialPositions(m,x,s.enemyPositions,f);return A.playerStartPos={...A.player},f&&f.length>0&&f.forEach(N=>{const C=N.id||N.name.toLowerCase();A[C]&&(A[`${C}StartPos`]={...A[C]})}),{...h,isActive:!0,isInitialized:!0,combatPhase:"initiative-display",encounterData:s,combatEnemies:m,companionCharacter:d?Lt.deepClone(d):null,turnOrder:b,currentTurnIndex:0,turnCounter:1,combatPositions:A,hasMovedThisTurn:!1,defeated:!1,victory:!1,totalXpGained:0}}),calculateInitialPositions:(s,u,d={},f=[])=>{const h={player:{x:0,y:5}};return f&&f.length>0?(console.log(`📍 POSITIONS: Placement de ${f.length} compagnons:`),f.forEach((m,g)=>{const v=m.id||m.name.toLowerCase();h[v]={x:1+g,y:5-Math.floor(g/2)},console.log(`📍 POSITIONS: [${g}] ${m.name}[${v}] → (${h[v].x}, ${h[v].y})`)})):u>0&&(h.companion={x:1,y:5}),s.forEach((m,g)=>{if(d[m.name])h[m.name]=d[m.name];else{const v=Math.min(6,Fr-2),b=Math.min(g,eu-1);h[m.name]={x:v+g%2,y:b}}}),h},resetCombat:()=>c({isActive:!1,isInitialized:!1,combatPhase:"idle",encounterData:null,combatEnemies:[],companionCharacter:null,turnOrder:[],currentTurnIndex:0,turnCounter:0,combatPositions:{},showMovementFor:null,showTargetingFor:null,hasMovedThisTurn:!1,playerAction:null,actionTargets:[],selectedAoESquares:[],aoeCenter:null,defeated:!1,victory:!1,totalXpGained:0}),startCombat:()=>c({combatPhase:"turn"}),nextTurn:()=>c(s=>{let u=s.currentTurnIndex+1;u>=s.turnOrder.length&&(u=0,s.turnCounter++);const d=s.turnOrder.length;let f=0;for(;u!==s.currentTurnIndex&&f<d;){const g=s.turnOrder[u];let v=!1;if(g.type==="enemy"){const b=s.combatEnemies.find(x=>x.name===g.name);(!b||b.currentHP<=0)&&(v=!0)}else g.type;if(v){u++,f++,u>=s.turnOrder.length&&(u=0,s.turnCounter++);continue}break}const h=s.turnOrder[u],m={...s.combatPositions};return h?.type==="player"?m.playerStartPos={...s.combatPositions.player}:h?.type==="companion"&&(m.companionStartPos={...s.combatPositions.companion}),{currentTurnIndex:u,turnCounter:s.turnCounter,combatPhase:"turn",hasMovedThisTurn:!1,showMovementFor:null,showTargetingFor:null,playerAction:null,actionTargets:[],combatPositions:m}}),setTurnPhase:s=>c({combatPhase:s}),getCurrentTurn:()=>{const{turnOrder:s,currentTurnIndex:u}=r();return s[u]},moveCharacter:(s,u)=>c(d=>{if(!Zn(u.x,u.y)||Ni(u.x,u.y,d.combatPositions,d.combatEnemies,s))return d;const h=d.combatPositions[s];return r().checkOpportunityAttacks(s,h,u),{combatPositions:{...d.combatPositions,[s]:u},hasMovedThisTurn:s==="player"?!0:d.hasMovedThisTurn}}),checkOpportunityAttacks:(s,u,d)=>{const{combatPositions:f,combatEnemies:h}=r(),m=[];return h.forEach(g=>{if(g.currentHP<=0)return;const v=f[g.name];if(!v)return;const b=wt(u,v)<=1,x=wt(d,v)<=1;b&&!x&&m.push({attacker:g,target:s,position:v})}),m},updateEnemyPosition:(s,u)=>c(d=>({combatPositions:{...d.combatPositions,[s]:u}})),setPlayerAction:s=>c({playerAction:s}),setActionTargets:s=>c({actionTargets:s}),setShowMovementFor:s=>c({showMovementFor:s}),setShowTargetingFor:s=>c({showTargetingFor:s}),setSelectedAoESquares:s=>c({selectedAoESquares:s}),setAoECenter:s=>c({aoeCenter:s}),executeAction:()=>{const{playerAction:s,actionTargets:u,turnOrder:d,currentTurnIndex:f,combatPositions:h}=r();if(!s||u.length===0)return;const m=d[f];h[m.name.toLowerCase()];const v=new Ci().executePlayerAction(m.character,s,u,combatEnemies,h);r().applyActionResults(v)},applyActionResults:s=>c(u=>{const d={...u};return s.damages?.forEach(f=>{if(f.target.type==="enemy"){const h=d.combatEnemies.findIndex(m=>m.name===f.target.name);h!==-1&&(d.combatEnemies[h]={...d.combatEnemies[h],currentHP:Math.max(0,d.combatEnemies[h].currentHP-f.amount)})}}),r().checkCombatEnd(),d}),_onPlayerDamage:null,_onCompanionDamage:null,setDamageCallbacks:(s,u)=>c({_onPlayerDamage:s,_onCompanionDamage:u}),dealDamageToPlayer:s=>{const{_onPlayerDamage:u}=r();u?u(s):console.warn("Player damage callback not set")},dealDamageToCompanion:s=>{const{_onCompanionDamage:u}=r();u?u(s):console.warn("Companion damage callback not set")},dealDamageToEnemy:(s,u)=>c(d=>{const f=d.combatEnemies.findIndex(m=>m.name===s);if(f===-1)return d;const h=[...d.combatEnemies];return h[f]={...h[f],currentHP:Math.max(0,h[f].currentHP-u)},{combatEnemies:h}}),checkCombatEnd:()=>{const{combatEnemies:s}=r();if(s.filter(d=>d.currentHP>0).length===0){r().handleVictory();return}},handleVictory:()=>{const{combatEnemies:s}=r(),u=s.reduce((d,f)=>d+(f.xp||0),0);c(d=>({victory:!0,combatPhase:"end",isActive:!1,totalXpGained:u}))},handleDefeat:()=>c({defeated:!0,combatPhase:"end",isActive:!1}),endCombat:s=>c({[s?"victory":"defeated"]:!0,combatPhase:"end",isActive:!1}),executeEnemyTurn:s=>{const{combatEnemies:u,combatPositions:d,companionCharacter:f}=r(),h=u.find(C=>C.name===s);if(!h||h.currentHP<=0)return;const m=d[s];if(!m)return;console.log("👹 Executing enemy turn:",s);const v={playerCharacter:null,companionCharacter:f,combatEnemies:u,combatPositions:d},b=It.calculateOptimalMovement({...h,type:"enemy"},m,v);b&&(console.log(`🏃 ${s} moves to position (${b.x}, ${b.y})`),r().moveCharacter(s,b));const x=b||m,A=h.attacks?.[0]||{name:"Attaque de base",type:"melee",range:1,damageDice:"1d6",damageBonus:0},N=It.getTargetsInRange({...h,type:"enemy"},x,A,v);if(N.length>0){let C=N.find(B=>d.player&&B.position.x===d.player.x&&B.position.y===d.player.y);C||(C=N[0]),console.log(`⚔️ ${s} attacks ${C.name||"target"}`);const E=It.calculateDamage(A);console.log(`💥 ${s} inflige ${E.damage} dégâts à ${C.name}`);const D=d.player,M=d.companion;D&&C.position.x===D.x&&C.position.y===D.y?r().dealDamageToPlayer(E.damage):M&&C.position.x===M.x&&C.position.y===M.y&&r().dealDamageToCompanion(E.damage)}else console.log(`🤷 ${s} has no targets in range`)},executeCompanionTurn:()=>{const{companionCharacter:s,combatPositions:u,combatEnemies:d}=r();if(!s||s.currentHP<=0)return;const f=u.companion;if(!f)return;console.log("🤝 Executing companion turn:",s.name);const h={playerCharacter:null,companionCharacter:s,combatEnemies:d,combatPositions:u},m=It.calculateOptimalMovement({...s,type:"companion"},f,h);m&&(console.log(`🏃 ${s.name} moves to position (${m.x}, ${m.y})`),r().moveCharacter("companion",m));const g=m||f,v=s.attacks?.[0]||{name:"Attaque de base",type:"melee",range:1,damageDice:"1d6",damageBonus:0},b=It.getTargetsInRange({...s,type:"companion"},g,v,h);if(console.log("🎯 Companion targets found:",b),b.length>0){const x=b.reduce((N,C)=>{if(!N)return C;const E=C.currentHP??0,D=N.currentHP??0;return E<D&&E>0?C:N});if(!x||!x.name){console.log(`🤷 ${s.name} found no valid target`);return}console.log(`⚔️ ${s.name} attacks ${x.name}`);const A=It.calculateDamage(v);console.log(`💥 ${s.name} inflige ${A.damage} dégâts à ${x.name}`),r().dealDamageToEnemy(x.name,A.damage)}else console.log(`🤷 ${s.name} has no targets in range`)},incrementCombatKey:()=>c(s=>({combatKey:s.combatKey+1})),getValidMovementSquares:(s,u=6)=>{const{combatPositions:d,combatEnemies:f}=r(),h=d[s];if(!h)return[];const m=[];for(let g=0;g<Fr;g++)for(let v=0;v<eu;v++)wt(h,{x:g,y:v})<=u&&!Ni(g,v,d,f,s)&&m.push({x:g,y:v});return m},getValidTargetSquares:(s,u)=>{const{combatPositions:d,combatEnemies:f}=r();return It.getTargetsInRange({type:"player"},u,s,{combatPositions:d,combatEnemies:f}).map(h=>d[h.name])}}),{name:"combat-store"})),Xe=Mi(Sv(Di((c,r)=>({openPanels:new Set(["character-sheet"]),collapsedSections:new Set,activeModal:null,modalData:null,modalHistory:[],notifications:[],notificationCounter:0,isMobile:typeof window<"u"?window.innerWidth<=768:!1,sidebarCollapsed:!1,screenSize:typeof window<"u"?window.innerWidth<=480?"mobile":window.innerWidth<=768?"tablet":"desktop":"desktop",showCombatDetails:!0,showHealthBars:!0,showInitiativeOrder:!0,combatAnimationsEnabled:!0,theme:"default",showTooltips:!0,autoScrollLogs:!0,compactMode:!1,loading:!1,loadingMessage:"",hoveredElement:null,focusedElement:null,openPanel:s=>c(u=>({openPanels:new Set([...u.openPanels,s])})),closePanel:s=>c(u=>{const d=new Set(u.openPanels);return d.delete(s),{openPanels:d}}),togglePanel:s=>c(u=>{const d=new Set(u.openPanels);return d.has(s)?d.delete(s):d.add(s),{openPanels:d}}),closeAllPanels:()=>c({openPanels:new Set}),resetPanels:()=>c({openPanels:new Set(["character-sheet"])}),collapseSection:s=>c(u=>({collapsedSections:new Set([...u.collapsedSections,s])})),expandSection:s=>c(u=>{const d=new Set(u.collapsedSections);return d.delete(s),{collapsedSections:d}}),toggleSection:s=>c(u=>{const d=new Set(u.collapsedSections);return d.has(s)?d.delete(s):d.add(s),{collapsedSections:d}}),openModal:(s,u=null)=>c(d=>({modalHistory:d.activeModal?[...d.modalHistory,{type:d.activeModal,data:d.modalData}]:d.modalHistory,activeModal:s,modalData:u})),closeModal:()=>c(s=>{if(s.modalHistory.length>0){const u=s.modalHistory[s.modalHistory.length-1];return{activeModal:u.type,modalData:u.data,modalHistory:s.modalHistory.slice(0,-1)}}return{activeModal:null,modalData:null,modalHistory:[]}}),closeAllModals:()=>c({activeModal:null,modalData:null,modalHistory:[]}),addNotification:s=>c(u=>({notifications:[...u.notifications,{id:`notif-${u.notificationCounter}`,timestamp:Date.now(),type:"info",duration:5e3,...s}],notificationCounter:u.notificationCounter+1})),removeNotification:s=>c(u=>({notifications:u.notifications.filter(d=>d.id!==s)})),clearNotifications:()=>c({notifications:[]}),showSuccess:(s,u={})=>r().addNotification({type:"success",message:s,...u}),showError:(s,u={})=>r().addNotification({type:"error",message:s,duration:8e3,...u}),showWarning:(s,u={})=>r().addNotification({type:"warning",message:s,duration:6e3,...u}),showInfo:(s,u={})=>r().addNotification({type:"info",message:s,...u}),updateScreenSize:()=>c(s=>{const u=window.innerWidth;let d="desktop",f=!1;return u<=480?(d="mobile",f=!0):u<=768&&(d="tablet"),s.isMobile!==f||s.screenSize!==d?{isMobile:f,screenSize:d}:s}),toggleSidebar:()=>c(s=>({sidebarCollapsed:!s.sidebarCollapsed})),setSidebarCollapsed:s=>c({sidebarCollapsed:s}),toggleCombatDetails:()=>c(s=>({showCombatDetails:!s.showCombatDetails})),toggleHealthBars:()=>c(s=>({showHealthBars:!s.showHealthBars})),toggleInitiativeOrder:()=>c(s=>({showInitiativeOrder:!s.showInitiativeOrder})),toggleCombatAnimations:()=>c(s=>({combatAnimationsEnabled:!s.combatAnimationsEnabled})),setCombatUISettings:s=>c(u=>({showCombatDetails:s.showDetails??u.showCombatDetails,showHealthBars:s.showHealthBars??u.showHealthBars,showInitiativeOrder:s.showInitiativeOrder??u.showInitiativeOrder,combatAnimationsEnabled:s.animationsEnabled??u.combatAnimationsEnabled})),setTheme:s=>c({theme:s}),toggleTooltips:()=>c(s=>({showTooltips:!s.showTooltips})),toggleAutoScrollLogs:()=>c(s=>({autoScrollLogs:!s.autoScrollLogs})),toggleCompactMode:()=>c(s=>({compactMode:!s.compactMode})),updatePreferences:s=>c(u=>({theme:s.theme??u.theme,showTooltips:s.showTooltips??u.showTooltips,autoScrollLogs:s.autoScrollLogs??u.autoScrollLogs,compactMode:s.compactMode??u.compactMode})),setLoading:(s,u="")=>c({loading:s,loadingMessage:s?u:""}),setHoveredElement:s=>c({hoveredElement:s}),setFocusedElement:s=>c({focusedElement:s}),clearHover:()=>c({hoveredElement:null}),clearFocus:()=>c({focusedElement:null}),resetUI:()=>c({openPanels:new Set(["character-sheet"]),collapsedSections:new Set,activeModal:null,modalData:null,modalHistory:[],notifications:[],sidebarCollapsed:!1,showCombatDetails:!0,showHealthBars:!0,showInitiativeOrder:!0,combatAnimationsEnabled:!0,hoveredElement:null,focusedElement:null,loading:!1,loadingMessage:""}),savePreferences:()=>{console.log("Preferences saved automatically")}}),{name:"ui-store"}),{name:"rpg-ui-preferences",partialize:c=>({theme:c.theme,showTooltips:c.showTooltips,autoScrollLogs:c.autoScrollLogs,compactMode:c.compactMode,sidebarCollapsed:c.sidebarCollapsed,showCombatDetails:c.showCombatDetails,showHealthBars:c.showHealthBars,showInitiativeOrder:c.showInitiativeOrder,combatAnimationsEnabled:c.combatAnimationsEnabled,openPanels:Array.from(c.openPanels),collapsedSections:Array.from(c.collapsedSections)}),onRehydrateStorage:()=>c=>{c&&(c.openPanels=new Set(c.openPanels||["character-sheet"]),c.collapsedSections=new Set(c.collapsedSections||[]))}}));if(typeof window<"u"){const c=()=>{Xe.getState().updateScreenSize()};window.addEventListener("resize",c)}const xe=({children:c,variant:r="default",size:s="medium",className:u="",onClick:d,disabled:f=!1,...h})=>{const m="card",g=`card--${r}`,v=`card--${s}`,A=[m,g,v,f?"card--disabled":"",d?"card--clickable":"",u].filter(Boolean).join(" ");return i.jsx("div",{className:A,onClick:f?void 0:d,...h,children:c})},Gt=({children:c,className:r=""})=>i.jsx("div",{className:`card__header ${r}`,children:c}),Qe=({children:c,className:r=""})=>i.jsx("div",{className:`card__body ${r}`,children:c}),Ri=({children:c,className:r=""})=>i.jsx("div",{className:`card__footer ${r}`,children:c}),se=({children:c,variant:r="primary",size:s="medium",disabled:u=!1,loading:d=!1,icon:f,iconPosition:h="left",fullWidth:m=!1,className:g="",onClick:v,type:b="button",...x})=>{const A=Xe(ae=>ae.compactMode),N="btn",C=`btn--${r}`,E=`btn--${s}`,le=[N,C,E,A?"btn--compact":"",u?"btn--disabled":"",d?"btn--loading":"",m?"btn--full-width":"",g].filter(Boolean).join(" "),I=ae=>{u||d||v?.(ae)};return i.jsxs("button",{type:b,className:le,onClick:I,disabled:u||d,...x,children:[d&&i.jsx("span",{className:"btn__spinner"}),f&&h==="left"&&i.jsx("span",{className:"btn__icon btn__icon--left",children:f}),i.jsx("span",{className:"btn__content",children:c}),f&&h==="right"&&i.jsx("span",{className:"btn__icon btn__icon--right",children:f})]})},pa=({children:c,variant:r="horizontal",spacing:s="medium",className:u=""})=>{const d=["btn-group",`btn-group--${r}`,`btn-group--spacing-${s}`,u].filter(Boolean).join(" ");return i.jsx("div",{className:d,children:c})},mm=({children:c,variant:r="secondary",size:s="medium",disabled:u=!1,selected:d=!1,cooldown:f=!1,onClick:h,className:m="",...g})=>{const v=["action-button",d&&"action-button--selected",f&&"action-button--cooldown",m].filter(Boolean).join(" ");return i.jsxs(se,{variant:d?"primary":r,size:s,disabled:u||f,onClick:h,className:v,...g,children:[c,f&&i.jsx("div",{className:"action-button__cooldown-overlay",children:i.jsx("span",{className:"action-button__cooldown-text",children:"⏱️"})})]})};var Tv=xm();const Mv=nu(Tv);var _m={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},pm=Oe.createContext&&Oe.createContext(_m),Dv=["attr","size","title"];function Rv(c,r){if(c==null)return{};var s=Ov(c,r),u,d;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(c);for(d=0;d<f.length;d++)u=f[d],!(r.indexOf(u)>=0)&&Object.prototype.propertyIsEnumerable.call(c,u)&&(s[u]=c[u])}return s}function Ov(c,r){if(c==null)return{};var s={};for(var u in c)if(Object.prototype.hasOwnProperty.call(c,u)){if(r.indexOf(u)>=0)continue;s[u]=c[u]}return s}function Ei(){return Ei=Object.assign?Object.assign.bind():function(c){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var u in s)Object.prototype.hasOwnProperty.call(s,u)&&(c[u]=s[u])}return c},Ei.apply(this,arguments)}function hm(c,r){var s=Object.keys(c);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(c);r&&(u=u.filter(function(d){return Object.getOwnPropertyDescriptor(c,d).enumerable})),s.push.apply(s,u)}return s}function Ai(c){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?hm(Object(s),!0).forEach(function(u){zv(c,u,s[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(s)):hm(Object(s)).forEach(function(u){Object.defineProperty(c,u,Object.getOwnPropertyDescriptor(s,u))})}return c}function zv(c,r,s){return r=Hv(r),r in c?Object.defineProperty(c,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):c[r]=s,c}function Hv(c){var r=qv(c,"string");return typeof r=="symbol"?r:r+""}function qv(c,r){if(typeof c!="object"||!c)return c;var s=c[Symbol.toPrimitive];if(s!==void 0){var u=s.call(c,r);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(c)}function Nm(c){return c&&c.map((r,s)=>Oe.createElement(r.tag,Ai({key:s},r.attr),Nm(r.child)))}function Fe(c){return r=>Oe.createElement(Bv,Ei({attr:Ai({},c.attr)},r),Nm(c.child))}function Bv(c){var r=s=>{var{attr:u,size:d,title:f}=c,h=Rv(c,Dv),m=d||s.size||"1em",g;return s.className&&(g=s.className),c.className&&(g=(g?g+" ":"")+c.className),Oe.createElement("svg",Ei({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,u,h,{className:g,style:Ai(Ai({color:c.color||s.color},s.style),c.style),height:m,width:m,xmlns:"http://www.w3.org/2000/svg"}),f&&Oe.createElement("title",null,f),c.children)};return pm!==void 0?Oe.createElement(pm.Consumer,null,s=>r(s)):r(_m)}function Uv(c){return Fe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"},child:[]}]})(c)}function wv(c){return Fe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"},child:[]}]})(c)}function Cm(c){return Fe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"},child:[]}]})(c)}function Em(c){return Fe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"},child:[]}]})(c)}function Lv(c){return Fe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m19 9 1.25-2.75L23 5l-2.75-1.25L19 1l-1.25 2.75L15 5l2.75 1.25zM19 15l-1.25 2.75L15 19l2.75 1.25L19 23l1.25-2.75L23 19l-2.75-1.25zM11.5 9.5 9 4 6.5 9.5 1 12l5.5 2.5L9 20l2.5-5.5L17 12l-5.5-2.5zm-1.51 3.49L9 15.17l-.99-2.18L5.83 12l2.18-.99L9 8.83l.99 2.18 2.18.99-2.18.99z"},child:[]}]})(c)}const su=({type:c,title:r,children:s,size:u="medium",showCloseButton:d=!0,closeOnBackdrop:f=!0,closeOnEscape:h=!0,className:m="",onClose:g})=>{const v=Xe(B=>B.activeModal),b=Xe(B=>B.modalData),x=Xe(B=>B.closeModal),A=Xe(B=>B.isMobile),N=v===c;ee.useEffect(()=>{if(!N||!h)return;const B=V=>{V.key==="Escape"&&C()};return document.addEventListener("keydown",B),()=>document.removeEventListener("keydown",B)},[N,h]),ee.useEffect(()=>{if(N)return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}},[N]);const C=()=>{g?.(),x()},E=B=>{B.target===B.currentTarget&&f&&C()};if(!N)return null;const D=["modal",`modal--${u}`,A&&"modal--mobile",m].filter(Boolean).join(" "),M=i.jsx("div",{className:"modal__backdrop",onClick:E,children:i.jsxs("div",{className:D,role:"dialog","aria-modal":"true",children:[(r||d)&&i.jsxs("div",{className:"modal__header",children:[r&&i.jsx("h2",{className:"modal__title",children:r}),d&&i.jsx(se,{variant:"ghost",size:"small",icon:i.jsx(wv,{}),onClick:C,className:"modal__close-button","aria-label":"Fermer la modal"})]}),i.jsx("div",{className:"modal__content",children:typeof s=="function"?s({data:b,onClose:C}):s})]})});return Mv.createPortal(M,document.body)},$v=()=>{const c=Xe(d=>d.openModal),r=Xe(d=>d.closeModal),s=Xe(d=>d.activeModal),u=Xe(d=>d.modalData);return{openModal:c,closeModal:r,activeModal:s,modalData:u,isOpen:d=>s===d}},Ti=({current:c,max:r,label:s,showNumbers:u=!0,showPercentage:d=!1,size:f="medium",variant:h="health",animated:m=!0,className:g=""})=>{const v=Xe(E=>E.showHealthBars),b=Xe(E=>E.combatAnimationsEnabled);if(!v)return null;const x=r>0?Math.max(0,Math.min(100,c/r*100)):0,A=Math.max(0,c);let N="";x>75?N="health-bar--high":x>50?N="health-bar--medium":x>25?N="health-bar--low":N="health-bar--critical";const C=["health-bar",`health-bar--${f}`,`health-bar--${h}`,"flex flex--column flex--center",N,m&&b&&"health-bar--animated",g].filter(Boolean).join(" ");return i.jsxs("div",{className:C,children:[s&&i.jsxs("div",{className:"health-bar__label",children:[i.jsxs("span",{className:"health-bar__label-text",children:[s," "]}),u&&i.jsxs("span",{className:"health-bar__numbers",children:[A,"/",r,d&&` (${Math.round(x)}%)`]})]}),i.jsxs("div",{className:"health-bar__container",children:[i.jsx("div",{className:"health-bar__background",children:i.jsx("div",{className:"health-bar__fill",style:{width:`${x}%`,transition:m&&b?"width 0.3s ease-out":"none"}})}),!s&&u&&i.jsx("div",{className:"health-bar__overlay",children:i.jsxs("span",{className:"health-bar__overlay-text",children:[A,"/",r,d&&` (${Math.round(x)}%)`]})})]})]})},Gv=({character:c})=>{if(!c?.spellcasting)return null;const s=new ls().getSpellSlots(c);if(!s||Object.keys(s).length===0)return null;const u=Object.values(s).reduce((h,m)=>h+(m?.max||0),0),d=Object.values(s).reduce((h,m)=>h+(m?.used||0),0),f=u-d;return u>0?i.jsx(Ti,{current:f,max:u,label:"✨ Emplacements de sorts",variant:"mana",showNumbers:!0,size:"small"}):null},Pv=({character:c,characterStats:r,layout:s="vertical"})=>{if(!c)return null;const u=["resource-bars",`resource-bars--${s}`].join(" ");return i.jsxs("div",{className:u,children:[i.jsx(Ti,{current:c.currentHP,max:c.maxHP,label:"❤️ Points de vie",variant:"health",showNumbers:!0}),c.hitDice&&i.jsx(Ti,{current:c.hitDice,max:c.level,label:"🎲 Dés de vie",variant:"energy",showNumbers:!0,size:"small"}),i.jsx(Gv,{character:c})]})},ts=({id:c,title:r,children:s,defaultExpanded:u=!0,persistState:d=!0,showIcon:f=!0,headerLevel:h=4,className:m="",headerClassName:g="",contentClassName:v="",onToggle:b})=>{const x=Xe(ae=>d?ae.collapsedSections.has(c):!1),A=Xe(ae=>ae.toggleSection),N=Xe(ae=>ae.combatAnimationsEnabled),[C,E]=Oe.useState(!u),D=d?!x:!C,M=()=>{d&&c?A(c):E(!C),b?.(D)},B=["collapsible-section",D&&"collapsible-section--expanded",N&&"collapsible-section--animated",m].filter(Boolean).join(" "),V=["collapsible-section__header",`collapsible-section__header--h${h}`,g].filter(Boolean).join(" "),le=["collapsible-section__content",v].filter(Boolean).join(" "),I=`h${h}`;return i.jsxs("div",{className:B,children:[i.jsxs(I,{className:V,onClick:M,role:"button",tabIndex:0,onKeyDown:ae=>{(ae.key==="Enter"||ae.key===" ")&&(ae.preventDefault(),M())},"aria-expanded":D,"aria-controls":c?`${c}-content`:void 0,children:[i.jsx("span",{className:"collapsible-section__title",children:r}),f&&i.jsx("span",{className:"collapsible-section__icon",children:D?i.jsx(Cm,{}):i.jsx(Em,{})})]}),D&&i.jsx("div",{className:le,id:c?`${c}-content`:void 0,children:s})]})};function Yv(c){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M500 224h-30.364C455.724 130.325 381.675 56.276 288 42.364V12c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v30.364C130.325 56.276 56.276 130.325 42.364 224H12c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h30.364C56.276 381.675 130.325 455.724 224 469.636V500c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12v-30.364C381.675 455.724 455.724 381.675 469.636 288H500c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12zM288 404.634V364c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40.634C165.826 392.232 119.783 346.243 107.366 288H148c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12h-40.634C119.768 165.826 165.757 119.783 224 107.366V148c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12v-40.634C346.174 119.768 392.217 165.757 404.634 224H364c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40.634C392.232 346.174 346.243 392.217 288 404.634zM288 256c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-17.673 14.327-32 32-32s32 14.327 32 32z"},child:[]}]})(c)}function Xv(c){return Fe({attr:{viewBox:"0 0 480 512"},child:[{tag:"path",attr:{d:"M106.75 215.06L1.2 370.95c-3.08 5 .1 11.5 5.93 12.14l208.26 22.07-108.64-190.1zM7.41 315.43L82.7 193.08 6.06 147.1c-2.67-1.6-6.06.32-6.06 3.43v162.81c0 4.03 5.29 5.53 7.41 2.09zM18.25 423.6l194.4 87.66c5.3 2.45 11.35-1.43 11.35-7.26v-65.67l-203.55-22.3c-4.45-.5-6.23 5.59-2.2 7.57zm81.22-257.78L179.4 22.88c4.34-7.06-3.59-15.25-10.78-11.14L17.81 110.35c-2.47 1.62-2.39 5.26.13 6.78l81.53 48.69zM240 176h109.21L253.63 7.62C250.5 2.54 245.25 0 240 0s-10.5 2.54-13.63 7.62L130.79 176H240zm233.94-28.9l-76.64 45.99 75.29 122.35c2.11 3.44 7.41 1.94 7.41-2.1V150.53c0-3.11-3.39-5.03-6.06-3.43zm-93.41 18.72l81.53-48.7c2.53-1.52 2.6-5.16.13-6.78l-150.81-98.6c-7.19-4.11-15.12 4.08-10.78 11.14l79.93 142.94zm79.02 250.21L256 438.32v65.67c0 5.84 6.05 9.71 11.35 7.26l194.4-87.66c4.03-1.97 2.25-8.06-2.2-7.56zm-86.3-200.97l-108.63 190.1 208.26-22.07c5.83-.65 9.01-7.14 5.93-12.14L373.25 215.06zM240 208H139.57L240 383.75 340.43 208H240z"},child:[]}]})(c)}function Vv(c){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M243.2 189.9V258c26.1 5.9 49.3 15.6 73.6 22.3v-68.2c-26-5.8-49.4-15.5-73.6-22.2zm223.3-123c-34.3 15.9-76.5 31.9-117 31.9C296 98.8 251.7 64 184.3 64c-25 0-47.3 4.4-68 12 2.8-7.3 4.1-15.2 3.6-23.6C118.1 24 94.8 1.2 66.3 0 34.3-1.3 8 24.3 8 56c0 19 9.5 35.8 24 45.9V488c0 13.3 10.7 24 24 24h16c13.3 0 24-10.7 24-24v-94.4c28.3-12.1 63.6-22.1 114.4-22.1 53.6 0 97.8 34.8 165.2 34.8 48.2 0 86.7-16.3 122.5-40.9 8.7-6 13.8-15.8 13.8-26.4V95.9c.1-23.3-24.2-38.8-45.4-29zM169.6 325.5c-25.8 2.7-50 8.2-73.6 16.6v-70.5c26.2-9.3 47.5-15 73.6-17.4zM464 191c-23.6 9.8-46.3 19.5-73.6 23.9V286c24.8-3.4 51.4-11.8 73.6-26v70.5c-25.1 16.1-48.5 24.7-73.6 27.1V286c-27 3.7-47.9 1.5-73.6-5.6v67.4c-23.9-7.4-47.3-16.7-73.6-21.3V258c-19.7-4.4-40.8-6.8-73.6-3.8v-70c-22.4 3.1-44.6 10.2-73.6 20.9v-70.5c33.2-12.2 50.1-19.8 73.6-22v71.6c27-3.7 48.4-1.3 73.6 5.7v-67.4c23.7 7.4 47.2 16.7 73.6 21.3v68.4c23.7 5.3 47.6 6.9 73.6 2.7V143c27-4.8 52.3-13.6 73.6-22.5z"},child:[]}]})(c)}function kv(c){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M496 448H16c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h480c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16zm-304-64l-64-32 64-32 32-64 32 64 64 32-64 32-16 32h208l-86.41-201.63a63.955 63.955 0 0 1-1.89-45.45L416 0 228.42 107.19a127.989 127.989 0 0 0-53.46 59.15L64 416h144l-16-32zm64-224l16-32 16 32 32 16-32 16-16 32-16-32-32-16 32-16z"},child:[]}]})(c)}function Qv(c){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"},child:[]}]})(c)}function Zv(c){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 0C114.6 0 0 100.3 0 224c0 70.1 36.9 132.6 94.5 173.7 9.6 6.9 15.2 18.1 13.5 29.9l-9.4 66.2c-1.4 9.6 6 18.2 15.7 18.2H192v-56c0-4.4 3.6-8 8-8h16c4.4 0 8 3.6 8 8v56h64v-56c0-4.4 3.6-8 8-8h16c4.4 0 8 3.6 8 8v56h77.7c9.7 0 17.1-8.6 15.7-18.2l-9.4-66.2c-1.7-11.7 3.8-23 13.5-29.9C475.1 356.6 512 294.1 512 224 512 100.3 397.4 0 256 0zm-96 320c-35.3 0-64-28.7-64-64s28.7-64 64-64 64 28.7 64 64-28.7 64-64 64zm192 0c-35.3 0-64-28.7-64-64s28.7-64 64-64 64 28.7 64 64-28.7 64-64 64z"},child:[]}]})(c)}function Kv(c){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M214.02 19.115l-.02.06c38.033 14.387 73.867 34.09 106.393 58.446L368.02 158.4C292.254 72.063 181.72 20.678 64.66 20.604c-14.96-.01-30.027.834-45.14 2.535v18.8c108.174-12.774 213.91 21.292 293.527 88.554l42.314 97.416C290.887 132.486 182.425 73.885 66.395 73.21c-2.45-.013-4.9-.002-7.357.036-13.106.2-26.297 1.157-39.522 2.87v18.85c98.998-13.552 196.12 18.532 267.11 82.264l30.708 87.82C263.412 179.47 168.852 126.394 67.348 125.36c-15.818-.162-31.804.958-47.83 3.398v18.914c93.33-15.18 185.38 18.05 247.677 83.27l20.694 83.917C246.555 230.42 160.67 176.716 67.7 175.423c-1.256-.018-2.514-.025-3.774-.024-14.688.02-29.54 1.36-44.408 4.084v19.036c89.513-17.794 178.655 19.16 230.357 89.468l4.62 73.348c-28.973-83.013-107.888-136.692-193.257-135.87-13.8.132-27.768 1.693-41.72 4.78v19.188c77.22-18.904 155.333 13.983 197.095 77.14l5.873 57.49c23.33-6.283 47.534-13.218 68.727-20.873 19.194-6.93 35.884-14.525 46.596-22.038 5.354-3.756 9.142-7.478 11.174-10.574 2.033-3.096 2.47-5.184 2.098-7.59l-1.252-8.123 137.074-39.556C446.897 159.92 363.67 69.964 260.654 19.114H214.02zm278.86 273.922l-40.196 11.6c1.63 18.66-4.666 36.567-16.397 52.043-14.18 18.707-35.934 34.627-62.363 48.257-45.23 23.33-104.45 39.877-164.397 47.97l4.38 16.35c68.63-7.66 143.34-22.038 198.17-48.538 30.517-14.75 54.633-33.123 68.722-55.33 12.74-20.084 17.775-43.384 12.08-72.353zm-58.513 16.885l-65.027 18.765c-.736 4.345-2.345 8.51-4.733 12.147-3.925 5.98-9.462 10.986-16.068 15.62-13.213 9.266-30.996 17.098-50.978 24.316-31.927 11.53-68.41 20.998-99.558 29.134l6.644 24.79c59.027-7.79 117.64-24.153 160.71-46.366 24.828-12.805 44.388-27.573 56.037-42.94 8.804-11.614 13.283-23.135 12.972-35.466zm-261.754 77.43l-33.033 8.85 8.197 30.59c10.812 3.95 18.623 14.38 18.623 26.485 0 6.87-2.52 13.2-6.673 18.114l4.716 17.6 33.034-8.85-24.864-92.788zM138.22 443.79c-1.49 0-2.88.33-4.12.91l-75.6 20.255c2.926 4.706 4.625 10.24 4.625 16.14 0 .67-.03 1.33-.072 1.987l75.96-20.352c4.96-.386 8.698-4.37 8.698-9.453 0-5.35-4.138-9.488-9.49-9.488zM32.327 468.985c-6.798 0-12.11 5.312-12.11 12.11 0 6.798 5.312 12.11 12.11 12.11 6.798 0 12.111-5.312 12.111-12.11 0-6.798-5.313-12.11-12.11-12.11z"},child:[]}]})(c)}function Jv(c){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M30.936 23.332c-.97 100.412 10.37 192.13 100.757 231.064 109.81 47.303 46.883 118.85-58.246 83.002 76.11 65.222 145.665 141.652 200.928 159.985 6.78 2.995 14.26 4.674 22.12 4.674 11.404 0 22.023-3.508 30.835-9.495 31.55 8.544 59.065 11.345 82.4 9.23 19.94-.195 38.412-6.676 53.524-17.556 49.986-33.49 55.46-109.83 11.715-201.34 1.573-8.565 1.077-16.997-1.154-25.322-1.973-9.506-6.227-18.195-12.152-25.476-28.97-42.765-97.358-83.18-159.58-124.506 77.79 99.205 67.214 143.1 10.635 94.234 1.09-7.624-1.225-15.174-6.103-23.178-1.8-3.4-4.032-6.54-6.625-9.343-17.988-22.57-52.22-49.85-87.02-92.078 38.056 186.15-97.83 83.32-182.036-53.895zM267.79 173.836c14.032 0 25.208 11.176 25.208 25.21 0 14.032-11.175 25.208-25.21 25.208-14.032 0-25.208-11.176-25.208-25.21 0-14.032 11.175-25.208 25.21-25.208zm147.575 54.834c22.756 0 41.004 18.248 41.004 41.004 0 22.756-18.248 41.004-41.005 41.004-5.145 0-10.056-.942-14.582-2.65-.746-19.392-10.64-36.512-25.476-47.16 3.997-18.478 20.328-32.198 40.058-32.198zm-75.45 39.473c23.44 0 42.24 18.802 42.24 42.242 0 23.44-18.8 42.242-42.24 42.242s-42.243-18.802-42.243-42.242c0-23.44 18.8-42.242 42.242-42.242zm68.886 65.464c41.396 0 74.755 33.36 74.755 74.754 0 41.397-33.357 74.755-74.754 74.755-23.397 0-44.22-10.662-57.91-27.404.458-2.85.704-5.772.704-8.75 0-15.814-6.752-30.113-17.506-40.183.268-12.963 3.804-25.092 9.828-35.61 23.163-1.518 42.872-16.092 51.803-36.403 4.247-.746 8.613-1.157 13.08-1.157zm-145.53 10.59c12.626 0 22.662 10.038 22.662 22.664 0 12.628-10.035 22.663-22.662 22.663-12.627 0-22.663-10.035-22.663-22.662 0-12.625 10.035-22.663 22.663-22.663zm33.226 66.35c20.22 0 36.414 16.194 36.414 36.414 0 20.222-16.192 36.413-36.414 36.413-20.22 0-36.412-16.192-36.412-36.412s16.19-36.413 36.412-36.413z"},child:[]}]})(c)}function Iv(c){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 23c-3.7 0-7.4.1-11.1.27l.8 17.98c3.4-.16 6.8-.25 10.3-.25 118.8 0 215 96.2 215 215s-96.2 215-215 215c-89.6 0-166.35-54.7-198.65-132.6l27.63-8.3-48.43-34.3-19.05 54.5 22.55-6.7C74.68 428.8 158.4 489 256 489c128.6 0 233-104.4 233-233S384.6 23 256 23zm-30.8 2.04c-13.3 1.75-26.1 4.6-38.6 8.48l5.6 17.09c11.4-3.54 23.3-6.15 35.4-7.75l-2.4-17.82zm-57 15.12c-12.4 5.05-24.2 11.12-35.4 18.12l9.5 15.21c10.3-6.44 21.2-12.03 32.6-16.67l-6.7-16.66zM116.4 69.5a234.139 234.139 0 0 0-29.35 26.12l13.05 12.28c8.3-8.77 17.4-16.81 27-24.06l-4.8-6.57-5.9-7.77zm69.5 8.58l-4.4 17.44 217 55.48 4.4-17.4-217-55.52zM74.07 110.5c-8.19 10.2-15.54 21.2-21.94 32.7l15.65 8.8c5.91-10.7 12.69-20.8 20.26-30.3l-13.97-11.2zm127.63 8.8c-3.9 26 2.8 55.2 14.2 79.2 6.4 13.4 14.2 25.2 21.9 33.8 4.2 4.7 8.4 8.3 12.2 10.9l-5.4 21.2c-4.6.4-10 1.6-16 3.7-10.9 3.8-23.4 10.4-35.4 19.1-21.6 15.6-41.4 37.9-50.4 62.6l167.5 42.9c3.9-26-2.8-55.2-14.2-79.2-6.4-13.4-14.2-25.2-21.9-33.8-4.2-4.7-8.4-8.3-12.2-10.9l5.4-21.2c4.5-.5 10-1.6 16-3.7 10.9-3.8 23.4-10.4 35.4-19.1 21.6-15.6 41.4-37.9 50.4-62.6l-167.5-42.9zM43.24 160.9c-5.33 12-9.7 24.4-13 37.3l17.48 4.2c3.03-11.8 7.04-23.2 11.95-34.2l-16.43-7.3zM26.2 217.5C24.11 230 23 242.9 23 256v.9l18-.2v-.7c0-12.1 1.02-24 2.95-35.6l-17.75-2.9zM113.5 361l-4.4 17.4 217 55.5 4.4-17.4-217-55.5z"},child:[]}]})(c)}function Wv(c){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M230.125 18.156V247h49.313V18.156h-49.313zM78.812 21.438l-16 136.906c48.707 30.112 97.637 47.843 148.625 53.094V33.125c-44.244-1.822-88.46-5.89-132.625-11.688zm349.438.28c-43.398 6.814-86.784 10.647-130.125 11.97v175c46.732-7.458 95.816-24.375 148.438-50.844L428.25 21.72zm-1.938 166.532c-44.474 19.847-87.06 32.836-128.187 38.97V247h37.031v143.188h-37.031v8.718c0 34.41-20.516 56.084-43.25 56.28-22.734.2-43.438-21.34-43.438-56.28v-8.72l-27.656.002h-9.343V247h37.001v-17.188c-43.774-4.164-86.14-16.857-127.687-38.062 5.04 92.69 3.66 185.37-5.063 278.063 117.402 32.047 234.788 31.002 352.188 0-6.853-93.858-9.223-187.706-4.563-281.563zm-233.187 77.438V371.5H316.47V265.687H193.124zm20.47 18.156H296v67.5H213.594v-67.5zm18.686 18.687v30.126h45.032V302.53h-45.03zm-2.155 87.658v8.718c0 28.23 13.32 37.692 24.594 37.594 11.27-.098 24.718-10.018 24.718-37.594v-8.72l-49.313.002z"},child:[]}]})(c)}function Fv(c){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 16c-22.5 72-45 72-45 120 0 0 22.5 24 45 24s45-24 45-24c0-48-22.5-48-45-120zm0 144c-49.706 0-90 42.98-90 96s40.294 96 90 96c49.705 0 90-42.98 90-96s-40.295-96-90-96zm0 192c-22.5 0-45 24-45 24 0 48 22.5 48 45 120 22.5-72 45-72 45-120 0 0-22.5-24-45-24zm-22.5-168h45v48h45v48h-45v48h-45v-48h-45v-48h45v-48z"},child:[]}]})(c)}function eg(c){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M319.61 20.654c13.145 33.114 13.144 33.115-5.46 63.5 33.114-13.145 33.116-13.146 63.5 5.457-13.145-33.114-13.146-33.113 5.457-63.498-33.114 13.146-33.113 13.145-63.498-5.459zM113.024 38.021c-11.808 21.04-11.808 21.04-35.724 24.217 21.04 11.809 21.04 11.808 24.217 35.725 11.808-21.04 11.808-21.04 35.724-24.217-21.04-11.808-21.04-11.808-24.217-35.725zm76.55 56.184c-.952 50.588-.95 50.588-41.991 80.18 50.587.95 50.588.95 80.18 41.99.95-50.588.95-50.588 41.99-80.18-50.588-.95-50.588-.95-80.18-41.99zm191.177 55.885c-.046 24.127-.048 24.125-19.377 38.564 24.127.047 24.127.046 38.566 19.375.047-24.126.046-24.125 19.375-38.564-24.126-.047-24.125-.046-38.564-19.375zm-184.086 83.88c-1.191.024-2.36.07-3.492.134-18.591 1.064-41.868 8.416-77.445 22.556L76.012 433.582c78.487-20.734 132.97-21.909 170.99-4.615V247.71c-18.076-8.813-31.79-13.399-46.707-13.737a91.166 91.166 0 0 0-3.629-.002zm122.686 11.42c-2.916-.026-5.81.011-8.514.098-12.81.417-27.638 2.215-45.84 4.522V427.145c43.565-7.825 106.85-4.2 171.244 7.566l-39.78-177.197c-35.904-8.37-56.589-11.91-77.11-12.123zm2.289 16.95c18.889.204 36.852 2.768 53.707 5.02l4.437 16.523c-23.78-3.75-65.966-4.906-92.467-.98l-.636-17.805c11.959-2.154 23.625-2.88 34.959-2.758zm-250.483 4.658l-10.617 46.004h24.094l10.326-46.004H71.158zm345.881 0l39.742 177.031 2.239 9.973 22.591-.152-40.855-186.852h-23.717zm-78.857 57.82c16.993.026 33.67.791 49.146 2.223l3.524 17.174c-32.645-3.08-72.58-2.889-102.995 0l-.709-17.174c16.733-1.533 34.04-2.248 51.034-2.223zm-281.793 6.18l-6.924 30.004h24.394l6.735-30.004H56.389zm274.418 27.244c4.656.021 9.487.085 14.716.203l2.555 17.498c-19.97-.471-47.115.56-59.728 1.05l-.7-17.985c16.803-.493 29.189-.828 43.157-.766zm41.476.447c8.268.042 16.697.334 24.121.069l2.58 17.74c-8.653-.312-24.87-.83-32.064-.502l-2.807-17.234a257.25 257.25 0 0 1 8.17-.073zm-326.97 20.309l-17.985 77.928 25.035-.17 17.455-77.758H45.313zm303.164 11.848c19.608-.01 38.66.774 56.449 2.572l2.996 20.787c-34.305-4.244-85.755-7.697-119.1-3.244l-.14-17.922c20.02-1.379 40.186-2.183 59.795-2.193zm-166.606 44.05c-30.112.09-67.916 6.25-115.408 19.76l-7.22 2.053 187.759-1.27v-6.347c-16.236-9.206-37.42-14.278-65.13-14.196zm134.41 6.174c-19.63.067-37.112 1.439-51.283 4.182v10.064l177.594-1.203c-44.322-8.634-89.137-13.17-126.31-13.043zM26 475v18h460v-18H26z"},child:[]}]})(c)}function tg(c){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 29.816l-231 154v106.368l231-154 231 154V183.816zm0 128.043L105 259.783v90.283l151-101.925 151 101.925v-90.283zm0 112l-87 58.725v67.6l87-58 87 58v-67.6zm0 89.957l-87 58v64.368l87-58 87 58v-64.368z"},child:[]}]})(c)}const gt=(c,r="")=>({className:s="",...u})=>i.jsx(c,{className:`icon ${r} ${s}`,...u}),Am=gt(Qv,"heal-icon"),ag=gt(Kv,"damage-icon"),ng=gt(kv,"magic-icon"),lg=gt(Xv,"dice-icon"),sg=gt(Yv,"miss-icon"),ig=gt(Zv,"defeat-icon"),cg=gt(Vv,"victory-icon"),rg=gt(Wv,"bag-icon"),ug=gt(tg,"upgrade-icon"),og=gt(Fv,"levelup-icon"),dg=gt(Lv,"exp-icon"),fg=gt(eg,"spell-icon"),mg=gt(Jv,"burning-blobs-icon"),pg=gt(Iv,"duration-icon"),vt={PLAYER_DAMAGE:"player-damage",ENEMY_DAMAGE:"enemy-damage",VICTORY:"victory",HEAL:"heal",MISS:"miss",DEFEAT:"defeat",INITIATIVE:"initiative",BAG:"bag",UPGRADE:"upgrade",LEVEL_UP:"levelup",EXPERIENCE:"experience",SPELL:"spell",BURNING_BLOBS:"burning-blobs",DURATION:"duration"},hg=c=>{const s={[vt.PLAYER_DAMAGE]:ng,[vt.ENEMY_DAMAGE]:ag,[vt.VICTORY]:cg,[vt.HEAL]:Am,[vt.MISS]:sg,[vt.DEFEAT]:ig,[vt.INITIATIVE]:lg,[vt.BAG]:rg,[vt.UPGRADE]:ug,[vt.LEVEL_UP]:og,[vt.EXPERIENCE]:dg,[vt.SPELL]:fg,[vt.BURNING_BLOBS]:mg,[vt.DURATION]:pg}[c];return s?i.jsx(s,{}):null},vg=Oe.memo(({entry:c,showTimestamp:r=!1})=>{const s=c.timestamp?new Date(c.timestamp).toLocaleTimeString():"";return i.jsxs("div",{className:`combat-log__entry combat-log__entry--${c.type}`,children:[i.jsxs("div",{className:"combat-log__entry-content",children:[i.jsx("span",{className:"combat-log__entry-icon",children:hg(c.type)}),i.jsx("span",{className:"combat-log__entry-message",children:c.message})]}),r&&s&&i.jsx("span",{className:"combat-log__entry-timestamp",children:s})]})}),as=({title:c="Journal",maxEntries:r=100,showTimestamps:s=!1,showClearButton:u=!0,collapsible:d=!1,compact:f=!1,className:h=""})=>{const m=ee.useRef(null),g=ha(B=>B.combatLog),v=ha(B=>B.clearCombatLog),b=Xe(B=>B.autoScrollLogs),x=Xe(B=>B.compactMode),[A,N]=Oe.useState(!1);ee.useEffect(()=>{b&&m.current&&!A&&(m.current.scrollTop=m.current.scrollHeight)},[g,b,A]);const C=ee.useMemo(()=>g.slice(-r),[g,r]),E=ee.useMemo(()=>C.map(B=>i.jsx(vg,{entry:B,showTimestamp:s},B.id||`${B.message}-${B.timestamp}`)),[C,s]),D=["combat-log",f||x?"combat-log--compact":"",A?"combat-log--collapsed":"",h].filter(Boolean).join(" "),M=C.length>0;return i.jsxs("div",{className:D,children:[i.jsxs("div",{className:"combat-log__header",children:[i.jsxs("div",{className:"combat-log__title-section",children:[d&&i.jsx("button",{className:"combat-log__toggle",onClick:()=>N(!A),"aria-expanded":!A,children:A?i.jsx(Em,{}):i.jsx(Cm,{})}),i.jsx("h3",{className:"combat-log__title",children:c}),M&&i.jsxs("span",{className:"combat-log__count",children:["(",C.length,")"]})]}),u&&M&&!A&&i.jsx(se,{size:"small",variant:"ghost",icon:i.jsx(Uv,{}),onClick:v,className:"combat-log__clear-button",title:"Vider le journal",children:"Vider"})]}),!A&&i.jsxs("div",{className:"combat-log__content",children:[i.jsx("div",{className:"combat-log__entries",ref:m,children:M?E:i.jsxs("div",{className:"combat-log__empty",children:[i.jsx("span",{className:"combat-log__empty-icon",children:"📝"}),i.jsx("p",{className:"combat-log__empty-message",children:"En attente d'actions..."})]})}),M&&!b&&i.jsx("div",{className:"combat-log__controls",children:i.jsx(se,{size:"small",variant:"ghost",onClick:()=>{m.current&&(m.current.scrollTop=m.current.scrollHeight)},children:"↓ Aller au bas"})})]})]})};Oe.memo(as);const sn=({label:c,value:r,modifier:s,tooltip:u,size:d="medium",variant:f="default",showModifier:h=!1,onClick:m,className:g=""})=>{const v=Xe(C=>C.showTooltips),b=Xe(C=>C.compactMode),x=["stat-block",`stat-block--${d}`,`stat-block--${f}`,b&&"stat-block--compact",m&&"stat-block--clickable",g].filter(Boolean).join(" "),A=s!==void 0?s:typeof r=="number"&&h?Math.floor((r-10)/2):null,N=i.jsxs("div",{className:x,onClick:m,children:[i.jsx("div",{className:"stat-block__label",children:c}),i.jsxs("div",{className:"stat-block__value",children:[r,A!==null&&i.jsxs("span",{className:"stat-block__modifier",children:["(",A>=0?"+":"",A,")"]})]})]});return u&&v?i.jsx("div",{className:"stat-block-wrapper",title:u,children:N}):N},Tm=({children:c,layout:r="horizontal",spacing:s="medium",className:u=""})=>{const d=["stat-group",`stat-group--${r}`,`stat-group--spacing-${s}`,u].filter(Boolean).join(" ");return i.jsx("div",{className:d,children:c})},gg=Oe.memo(({statName:c,score:r,hasSaveProficiency:s=!1,proficiencyBonus:u=0,onClick:d,showSaveBonus:f=!1,compact:h=!1})=>{const m=ze(r),g=m+(s?u:0),v={force:"FOR",dexterite:"DEX",constitution:"CON",intelligence:"INT",sagesse:"SAG",charisme:"CHA"},b={force:"Force",dexterite:"Dextérité",constitution:"Constitution",intelligence:"Intelligence",sagesse:"Sagesse",charisme:"Charisme"},x=h?v[c]||c.toUpperCase():b[c]||c,A=`${b[c]}: ${r} (${m>=0?"+":""}${m})${f?`
Jet de sauvegarde: ${g>=0?"+":""}${g}`:""}`;return i.jsxs("div",{className:`ability-score ${h?"ability-score--compact":""}`,children:[i.jsx(sn,{label:x,value:r,modifier:m,tooltip:A,variant:s?"highlighted":"default",onClick:d,size:h?"small":"medium",showModifier:!0}),f&&i.jsxs("div",{className:`ability-score__save ${s?"ability-score__save--proficient":""}`,children:[i.jsx("span",{className:"ability-score__save-label",children:"JdS:"}),i.jsxs("span",{className:"ability-score__save-value",children:[g>=0?"+":"",g]})]})]})}),yg=({stats:c,saves:r=[],proficiencyBonus:s=2,onStatClick:u,layout:d="grid",compact:f=!1,showSaveBonuses:h=!1})=>{const m=["ability-scores",`ability-scores--${d}`,f&&"ability-scores--compact"].filter(Boolean).join(" "),g=["force","dexterite","constitution","intelligence","sagesse","charisme"];return i.jsx("div",{className:m,children:i.jsx(Tm,{layout:d==="grid"?"grid":d,children:g.map(v=>i.jsx(gg,{statName:v,score:c[v]||10,hasSaveProficiency:r.includes(v),proficiencyBonus:s,onClick:()=>u?.(v),showSaveBonus:h,compact:f},v))})})},tu={acrobaties:"dexterite",arcanes:"intelligence",athletisme:"force",discretion:"dexterite",dressage:"sagesse",escamotage:"dexterite",histoire:"intelligence",intimidation:"charisme",intuition:"sagesse",investigation:"intelligence",medecine:"sagesse",nature:"intelligence",perception:"sagesse",persuasion:"charisme",religion:"intelligence",representation:"charisme",survie:"sagesse",tromperie:"charisme"},Mm={acrobaties:"Acrobaties",arcanes:"Arcanes",athletisme:"Athlétisme",discretion:"Discrétion",dressage:"Dressage",escamotage:"Escamotage",histoire:"Histoire",intimidation:"Intimidation",intuition:"Intuition",investigation:"Investigation",medecine:"Médecine",nature:"Nature",perception:"Perception",persuasion:"Persuasion",religion:"Religion",representation:"Représentation",survie:"Survie",tromperie:"Tromperie"},bg={force:"FOR",dexterite:"DEX",constitution:"CON",intelligence:"INT",sagesse:"SAG",charisme:"CHA"},Ir=Oe.memo(({skillName:c,character:r,proficiencyBonus:s,onSkillClick:u,layout:d="default",showProficiencyIndicator:f=!0})=>{const h=tu[c],m=r.proficiencies?.skills?.includes(c)||!1,g=ze(r.stats[h]||10),v=g+(m?s:0),b=Mm[c]||c,x=bg[h]||h.toUpperCase(),A=["skill-item",`skill-item--${d}`,m&&"skill-item--proficient"].filter(Boolean).join(" "),N=`${b} (${x}): ${v>=0?"+":""}${v}${m?" (maîtrisé)":""}`;return d==="compact"?i.jsx("div",{className:A,children:i.jsx(sn,{label:b,value:`${v>=0?"+":""}${v}`,variant:m?"highlighted":"default",size:"small",tooltip:N,onClick:()=>u?.(c)})}):i.jsxs("div",{className:A,onClick:()=>u?.(c),children:[i.jsxs("div",{className:"skill-item__header",children:[f&&i.jsx("div",{className:`skill-item__proficiency ${m?"skill-item__proficiency--active":""}`,children:m?"●":"○"}),i.jsxs("div",{className:"skill-item__name",children:[b,i.jsxs("span",{className:"skill-item__stat",children:["(",x,")"]})]}),i.jsxs("div",{className:"skill-item__bonus",children:[v>=0?"+":"",v]})]}),d==="detailed"&&i.jsx("div",{className:"skill-item__details",children:i.jsxs("div",{className:"skill-item__breakdown",children:["Stat: ",g>=0?"+":"",g,m&&i.jsxs("span",{children:[" + Maîtrise: +",s]})]})})]})}),xg=({character:c,proficiencyBonus:r=2,onSkillClick:s,layout:u="default",groupByAbility:d=!1,showSearch:f=!1,compact:h=!1})=>{const[m,g]=Oe.useState(""),v=Object.keys(tu).filter(x=>!m||Mm[x].toLowerCase().includes(m.toLowerCase())),b=["skills-list",`skills-list--${u}`,h&&"skills-list--compact"].filter(Boolean).join(" ");if(d){const x={};v.forEach(N=>{const C=tu[N];x[C]||(x[C]=[]),x[C].push(N)});const A={force:"Force",dexterite:"Dextérité",constitution:"Constitution",intelligence:"Intelligence",sagesse:"Sagesse",charisme:"Charisme"};return i.jsxs("div",{className:b,children:[f&&i.jsx("div",{className:"skills-list__search",children:i.jsx("input",{type:"text",placeholder:"Rechercher une compétence...",value:m,onChange:N=>g(N.target.value),className:"skills-list__search-input"})}),Object.entries(x).map(([N,C])=>i.jsx(ts,{id:`skills-${N}`,title:`${A[N]} (${C.length})`,defaultExpanded:!h,children:i.jsx("div",{className:"skills-list__ability-group",children:C.map(E=>i.jsx(Ir,{skillName:E,character:c,proficiencyBonus:r,onSkillClick:s,layout:h?"compact":u},E))})},N))]})}return i.jsxs("div",{className:b,children:[f&&i.jsx("div",{className:"skills-list__search",children:i.jsx("input",{type:"text",placeholder:"Rechercher une compétence...",value:m,onChange:x=>g(x.target.value),className:"skills-list__search-input"})}),i.jsx("div",{className:"skills-list__items",children:u==="compact"?i.jsx(Tm,{layout:"grid",children:v.map(x=>i.jsx(Ir,{skillName:x,character:c,proficiencyBonus:r,onSkillClick:s,layout:u},x))}):v.map(x=>i.jsx(Ir,{skillName:x,character:c,proficiencyBonus:r,onSkillClick:s,layout:u},x))})]})},Sg=({currentXP:c=0,nextLevelXP:r,progress:s=0,level:u,showNumbers:d=!0,showLevelUpIndicator:f=!0,size:h="medium",animated:m=!0})=>{const g=$t(N=>N.levelUpPending),v=$t(N=>N.experienceGains),b=v.length>0,x=b?v[v.length-1]:null,A=["xp-bar",`xp-bar--${h}`,m&&"xp-bar--animated",g&&"xp-bar--can-level-up",b&&"xp-bar--recent-gain"].filter(Boolean).join(" ");return i.jsxs("div",{className:A,children:[d&&i.jsx("div",{className:"xp-bar__info",children:i.jsx("div",{className:"xp-bar__current",children:i.jsxs("span",{className:"xp-bar__value",children:["✨ XP:  ",Math.max(0,Math.round(c))," / ",Math.max(0,Math.round(r))]})})}),i.jsxs("div",{className:"xp-bar__container",children:[i.jsxs("div",{className:"xp-bar__background",children:[i.jsx("div",{className:"xp-bar__fill",style:{width:`${Math.min(100,s)}%`,transition:m?"width 0.5s ease-out":"none"}}),b&&i.jsxs("div",{className:"xp-bar__recent-gain-indicator",children:["+",x.amount," XP"]})]}),g&&f&&i.jsx("div",{className:"xp-bar__level-up-indicator",children:"🎯 Niveau suivant disponible !"})]}),s>=100&&!g&&i.jsx("div",{className:"xp-bar__max-level",children:"Niveau maximum atteint"})]})},Dm=({characterType:c="player",compact:r=!1,showControls:s=!1})=>{const u=$t(h=>c==="player"?h.playerCharacter:h.playerCompanion),d=ee.useMemo(()=>{if(!u)return null;const h=qe.getXPToNextLevel(u.level),m=qe.getXPForLevel(u.level),g=u.currentXP||u.experience||0,v=qe.generateSpellSlotsForLevel(u.level,u.class),b=g-m,x=h-m,A=x>0?b/x*100:100,N=u.spellcasting?qe.getAttackBonus(u,{actionType:"spell"}):null,C=u.class==="Roublard"?"dexterite":"force",E=ze(u.stats[C])+qe.getProficiencyBonus(u.level),D=u.spellcasting?qe.getSpellSaveDC(u):null;return{xpToNext:x,xpProgress:A,spellAttackBonus:N,weaponAttackBonus:E,spellSaveDC:D,spellSlots:v,proficiencyBonus:qe.getProficiencyBonus(u.level)}},[u]);if(!u)return i.jsx(xe,{className:"character-sheet character-sheet--empty",children:i.jsx(Qe,{children:i.jsxs("p",{children:["Aucun ",c==="player"?"personnage":"compagnon"]})})});const f=["character-sheet",r&&"character-sheet--compact",`character-sheet--${c}`].filter(Boolean).join(" ");return i.jsxs(xe,{className:f,children:[i.jsx(Gt,{children:i.jsxs("div",{className:"character-sheet__header",children:[i.jsx("h3",{className:"character-sheet__name",children:u.name}),!r&&i.jsx(Sg,{currentXP:Math.max(0,(u.currentXP||u.experience||0)-qe.getXPForLevel(u.level)),nextLevelXP:d.xpToNext,progress:d.xpProgress,level:u.level}),i.jsxs("p",{className:"character-sheet__details",children:["Niv. ",u.level," ",u.race," ",u.class]}),u.historic&&i.jsx("p",{className:"character-sheet__background",children:u.historic})]})}),i.jsxs(Qe,{children:[i.jsxs("div",{className:"character-sheet__main-stats",children:[i.jsx("div",{className:"character-sheet__combat-stats",children:i.jsx(sn,{label:"CA",value:u.ac,tooltip:"Classe d'Armure"})}),!r&&i.jsx(ts,{id:`${c}-resources`,title:"Ressources",defaultExpanded:!0,children:i.jsx(Pv,{character:u,characterStats:d,layout:"vertical"})})]}),i.jsx(ts,{id:`${c}-abilities`,title:"Caractéristiques",defaultExpanded:r,children:i.jsx(yg,{stats:u.stats,saves:u.proficiencies?.saves||[],proficiencyBonus:d.proficiencyBonus,compact:!r,showSaveBonus:!1})}),i.jsx(ts,{id:`${c}-combat`,title:"Combat",defaultExpanded:r,children:i.jsxs("div",{className:"character-sheet__combat-info",children:[i.jsx(sn,{label:"Bonus de Maîtrise",value:`+${d.proficiencyBonus}`}),d.spellAttackBonus!==null&&i.jsx(sn,{label:"Att. Sorts",value:`+${d.spellAttackBonus}`,tooltip:"Bonus d'attaque des sorts"}),i.jsx(sn,{label:"Att. Armes",value:`+${d.weaponAttackBonus}`,tooltip:"Bonus d'attaque des armes"}),d.spellSaveDC&&i.jsx(sn,{label:"DD des sorts",value:d.spellSaveDC,tooltip:"Difficulté des jets de sauvegarde contre vos sorts"})]})}),i.jsx(ts,{id:`${c}-skills`,title:"Compétences",defaultExpanded:r,children:i.jsx(xg,{character:u,proficiencyBonus:d.proficiencyBonus,compact:r})})]})]})},jg=({characterType:c="player"})=>i.jsx(Dm,{characterType:c,compact:!0}),_g=({character:c,isSelected:r=!1,onSelect:s,onPreview:u,icon:d,description:f,showStats:h=!0,className:m=""})=>{const g=["character-selection-card",r&&"character-selection-card--selected",m].filter(Boolean).join(" "),v=b=>{b.target.closest("button")||s?.(c)};return c.stats.force,c.stats.dexterite,c.stats.constitution,c.stats.intelligence,c.stats.sagesse,c.stats.charisme,i.jsxs(xe,{className:g,onClick:v,variant:r?"primary":"default",children:[i.jsx(Gt,{children:i.jsxs("div",{className:"character-portrait",children:[i.jsx("div",{className:"character-avatar",children:d}),i.jsxs("div",{className:"character-info",children:[i.jsx("h3",{className:"character-selection-card__name",children:c.name}),i.jsxs("p",{className:"character-selection-card__class",children:[c.race," ",c.class]}),i.jsxs("p",{className:"character-selection-card__level",children:["Niveau ",c.level]})]})]})}),i.jsxs(Qe,{children:[i.jsxs("div",{className:"character-stats-preview",children:[i.jsxs("div",{className:"stat-preview",children:[i.jsx("span",{className:"main-stat__label",children:"❤️"}),i.jsxs("span",{className:"main-stat__value",children:[c.maxHP," PV"]})]}),i.jsxs("div",{className:"stat-preview",children:[i.jsx("span",{className:"main-stat__label",children:"🛡️"}),i.jsxs("span",{className:"main-stat__value",children:["CA ",c.ac]})]})]}),i.jsxs("div",{className:"character-specialties",children:[c.class==="Magicien"&&i.jsx("div",{className:"specialty",children:"🔮 Sorts puissants"}),c.class==="Guerrier"&&i.jsx("div",{className:"specialty",children:"⚔️ Combat rapproché"}),c.class==="Roublard"&&i.jsx("div",{className:"specialty",children:"🎯 Attaques précises"}),c.class==="Paladin"&&i.jsx("div",{className:"specialty",children:"🛡️ Défense sacrée"})]})]})]})},Ng=({onCharacterSelect:c})=>{const[r,s]=ee.useState(null),[u,d]=ee.useState(!1),f=ha(C=>C.setGamePhase),h=$t(C=>C.setPlayerCharacter),{openModal:m}=$v(),g=[Si.wizard,Si.warrior,Si.rogue,Si.paladin].filter(Boolean),v=C=>{s(C)},b=C=>{m("character-preview",C)},x=async()=>{if(r){d(!0);try{await new Promise(C=>setTimeout(C,500)),h(r),c?.(r),f("game")}catch(C){console.error("Erreur lors de la sélection du personnage:",C)}finally{d(!1)}}},A=C=>({Magicien:"Maître des arcanes, ce personnage utilise des sorts puissants pour vaincre ses ennemis. Fragile mais redoutable à distance, il excelle dans le contrôle du champ de bataille.",Guerrier:"Combattant expérimenté, ce héros excelle au corps-à-corps avec ses armes. Robuste et polyvalent au combat, il peut encaisser et infliger de lourds dégâts.",Roublard:"Expert en furtivité, ce personnage frappe avec précision et évite les coups. Agile et mortel par surprise, il excelle dans les situations qui demandent de la finesse.",Paladin:"Chevalier sacré, ce héros allie force et foi. Capable de soigner ses alliés et de frapper avec puissance, il est un pilier de défense et de soutien."})[C.class]||"Un aventurier prêt à affronter tous les défis.",N=C=>({Magicien:"🧙‍♂️",Guerrier:"⚔️",Roublard:"🗡️",Paladin:"🛡️"})[C]||"🗡️";return i.jsxs("div",{className:"character-selection-screen",children:[i.jsxs("div",{className:"selection-header",children:[i.jsx("h1",{className:"character-selection__title",children:"✨ Choisis ton Héros ✨"}),i.jsx("p",{className:"character-selection__subtitle",children:"Sélectionne le personnage avec lequel tu veux vivre cette aventure épique !"})]}),i.jsx("div",{className:"character-grid",children:g.map((C,E)=>i.jsx(_g,{character:C,isSelected:r?.name===C.name,onSelect:()=>v(C),onPreview:()=>b(C),icon:N(C.class),description:A(C)},`${C.name}-${E}`))}),r&&i.jsxs(xe,{className:"character-details",children:[i.jsxs(Gt,{children:[i.jsxs("h3",{children:[N(r.class)," ",r.name]}),i.jsxs("p",{children:[r.level,"e niveau ",r.race," ",r.class]})]}),i.jsxs(Qe,{children:[i.jsx("p",{className:"character-selection__description",children:A(r)}),i.jsxs("div",{className:"character-stats-preview",children:[i.jsxs("div",{className:"stat-preview",children:[i.jsx("span",{className:"quick-stat__label",children:"❤️ PV "}),i.jsx("span",{className:"quick-stat__value",children:r.maxHP})]}),i.jsxs("div",{className:"stat-preview",children:[i.jsx("span",{className:"quick-stat__label",children:"🛡️ CA "}),i.jsx("span",{className:"quick-stat__value",children:r.ac})]}),i.jsxs("div",{className:"stat-preview",children:[i.jsx("span",{className:"quick-stat__label",children:"⚡ Initiative "}),i.jsxs("span",{className:"quick-stat__value",children:["+ ",Math.floor((r.stats.dexterite-10)/2)]})]})]})]}),i.jsx(Ri,{children:i.jsx("div",{className:"character-selection__actions",children:i.jsx(se,{variant:"primary",onClick:x,loading:u,disabled:!r,size:"large",children:u?"Préparation...":"🚀 Commencer l'aventure !"})})})]}),!r&&i.jsx("div",{className:"character-selection__help",children:i.jsx(xe,{variant:"ghost",className:"character-selection__help-card",children:i.jsx(Qe,{children:i.jsx("p",{children:'👆 Clique sur un personnage pour le sélectionner, ou sur "Voir les détails" pour examiner ses caractéristiques complètes.'})})})}),i.jsx(su,{type:"character-preview",size:"large",title:"Aperçu du personnage",children:({data:C,onClose:E})=>i.jsx("div",{className:"character-preview-modal",children:C&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"character-preview-modal__header",children:[i.jsxs("h2",{children:[N(C.class)," ",C.name]}),i.jsxs("p",{children:[C.level,"e niveau ",C.race," ",C.class]})]}),i.jsxs("div",{className:"character-preview-modal__content",children:[i.jsx("div",{className:"character-preview-modal__description",children:i.jsx("p",{children:A(C)})}),i.jsx("div",{className:"character-preview-modal__sheet",children:i.jsx(jg,{characterData:C})})]}),i.jsxs("div",{className:"character-preview-modal__actions",children:[i.jsx(se,{variant:"secondary",onClick:E,children:"Fermer"}),i.jsx(se,{variant:"primary",onClick:()=>{s(C),E()},children:"Choisir ce personnage"})]})]})})})]})},Cg=({character:c,variant:r="default",className:s="",onAbilityUse:u})=>{if(!c?.specialAbilities||Object.keys(c.specialAbilities).length===0)return null;const d=["special-abilities-panel",`special-abilities-panel--${r}`,s].filter(Boolean).join(" "),f=(h,m)=>{u&&m.uses&&m.uses.current>0&&u(h,m)};return i.jsxs(xe,{className:d,children:[i.jsx(Gt,{children:i.jsx("h4",{children:"Capacités Spéciales"})}),i.jsx(Qe,{children:i.jsx("div",{className:"abilities-list",children:Object.entries(c.specialAbilities).map(([h,m])=>i.jsxs("div",{className:"ability-item",children:[i.jsxs("div",{className:"ability-header",children:[i.jsx("h5",{className:"ability-name",children:m.name}),m.level&&i.jsxs("span",{className:"ability-level",children:["Niveau ",m.level]})]}),i.jsx("p",{className:"ability-description",children:m.description}),m.damage&&i.jsx("div",{className:"ability-stats",children:i.jsxs("span",{className:"ability-damage",children:["Dégâts: ",m.damage]})}),m.uses&&i.jsxs("div",{className:"ability-uses",children:[i.jsxs("span",{className:"ability-uses-text",children:["Utilisations: ",m.uses.current||0,"/",m.uses.max]}),r==="interactive"&&m.uses.current>0&&i.jsx("button",{className:"ability-use-button",onClick:()=>f(h,m),title:`Utiliser ${m.name}`,children:"Utiliser"})]}),m.skills&&i.jsx("div",{className:"ability-skills",children:i.jsxs("span",{className:"ability-skills-text",children:["Compétences affectées: ",m.skills.join(", ")]})})]},h))})})]})},Rm=({companion:c,variant:r="default",className:s="",showActions:u=!1,showRole:d=!1,onAction:f})=>{if(!c)return null;const h=["companion-display",`companion-display--${r}`,s].filter(Boolean).join(" "),m=c.maxHP>0?Math.max(0,c.currentHP/c.maxHP*100):0,g=c.currentHP>0,v=m<=25&&m>0,b=A=>{switch(A){case"tank":return"🛡️";case"healer":return"❤️";case"dps":return"⚔️";default:return"🤝"}},x=A=>{switch(A){case"tank":return"Tank";case"healer":return"Soigneur";case"dps":return"DPS";default:return"Compagnon"}};return i.jsxs(xe,{className:h,children:[i.jsx(Gt,{children:i.jsxs("h4",{children:[d&&c.role&&i.jsx("span",{className:"companion-role-icon",title:x(c.role),children:b(c.role)}),d?x(c.role):"Compagnon"]})}),i.jsx(Qe,{children:i.jsxs("div",{className:"companion-card",children:[c.image&&i.jsx("div",{className:"companion-image-container",children:i.jsx("img",{src:c.image,alt:c.name,className:"companion-image"})}),i.jsxs("div",{className:"companion-info",children:[i.jsxs("div",{className:"companion-header",children:[i.jsx("span",{className:"companion-name",children:c.name}),r!=="compact"&&i.jsxs("span",{className:"companion-ac",children:["CA: ",c.ac]})]}),i.jsxs("div",{className:"companion-health",children:[i.jsxs("div",{className:"companion-hp-display",children:[i.jsx(Am,{className:`hp-icon ${g?"":"hp-icon--dead"}`}),i.jsxs("span",{className:`hp-text ${g?"":"hp-text--dead"}`,children:[Math.max(0,c.currentHP)," / ",c.maxHP," PV"]})]}),i.jsx(Ti,{current:c.currentHP,max:c.maxHP,size:r==="compact"?"small":"medium",animated:!0,showPercentage:r==="detailed"})]}),r==="detailed"&&i.jsxs("div",{className:"companion-details",children:[i.jsxs("div",{className:"companion-stats",children:[i.jsxs("span",{children:["Initiative: +",qe.getInitiativeModifier(c)]}),i.jsxs("span",{children:["Vitesse: ",c.speed||30," ft"]})]}),c.attacks&&c.attacks.length>0&&i.jsxs("div",{className:"companion-attacks",children:[i.jsx("h5",{children:"Attaques:"}),c.attacks.map((A,N)=>i.jsxs("div",{className:"attack-info",children:[i.jsx("span",{className:"attack-name",children:A.name}),i.jsxs("span",{className:"attack-damage",children:["(",A.damage,")"]})]},N))]})]}),u&&g&&i.jsxs("div",{className:"companion-actions",children:[i.jsx("button",{className:"action-button action-button--heal",onClick:()=>f?.("heal",c),disabled:c.currentHP>=c.maxHP,children:"Soigner"}),i.jsx("button",{className:"action-button action-button--rest",onClick:()=>f?.("rest",c),children:"Repos"})]}),!g&&i.jsxs("div",{className:"companion-status companion-status--dead",children:[i.jsx("span",{children:"💀 Inconscient"}),u&&i.jsx("button",{className:"action-button action-button--revive",onClick:()=>f?.("revive",c),children:"Ranimer"})]}),v&&g&&i.jsx("div",{className:"companion-status companion-status--wounded",children:i.jsx("span",{children:"⚠️ Gravement blessé"})})]})]})})]})},Eg=({companions:c=[],variant:r="default",showRoles:s=!0,layout:u="grid",className:d="",onCompanionAction:f})=>{if(!c||c.length===0)return i.jsx("div",{className:"companion-party companion-party--empty",children:i.jsx("p",{children:"Aucun compagnon actif"})});const h=["companion-party",`companion-party--${u}`,`companion-party--${r}`,d].filter(Boolean).join(" ");return i.jsxs("div",{className:h,children:[u!=="compact"&&i.jsx("div",{className:"companion-party__header",children:i.jsxs("h3",{children:["Compagnons (",c.length,"/3)"]})}),i.jsx("div",{className:"companion-party__grid",children:c.map((m,g)=>i.jsx(Rm,{companion:m,variant:r,showRole:s,showActions:r==="interactive",onAction:(v,b)=>f?.(v,b)},m.id||m.name||g))}),c.length<3&&r==="management"&&i.jsx("div",{className:"companion-party__add-slot",children:i.jsx("div",{className:"companion-add-button",children:i.jsx("span",{children:"+ Recruter un compagnon"})})})]})},Ag=({playerCharacter:c,playerCompanion:r,activeCompanions:s=[],enemies:u,positions:d,selectedAction:f,selectedTargets:h,currentTurn:m,phase:g,onTargetSelect:v,onMoveCharacter:b})=>{const[C,E]=ee.useState(null),[D,M]=ee.useState([]),B=ee.useCallback((w,$)=>{if(d.player?.x===w&&d.player?.y===$)return{...c,id:"player",type:"player"};if(s&&s.length>0)for(const j of s){const L=j.id||j.name.toLowerCase(),X=d[L];if(X?.x===w&&X?.y===$)return{...j,id:L,type:"companion"}}for(const j of u){const L=d[j.name];if(L?.x===w&&L?.y===$&&j.currentHP>0)return j}return null},[d,c,r,s,u]),V=(w,$)=>{const j=w/$;return j>.6?"#4caf50":j>.3?"#ff9800":"#f44336"},le=(w,$,j,L)=>Math.abs(w-j)+Math.abs($-L),I=(w,$)=>{if(g!=="player-movement")return!1;const j=d.player,L=d.playerStartPos||j;return!j||!L?!1:le(L.x,L.y,w,$)<=6&&!B(w,$)},ae=(w,$)=>{if(!f||g!=="player-turn")return!1;const j=B(w,$);return f.type==="attack"?j?.type==="enemy"&&j.currentHP>0:f.areaOfEffect?!0:f.type==="spell"?j?.type==="enemy"&&j.currentHP>0:!1},J=ee.useCallback((w,$,j)=>{const L=[];switch(j.shape){case"sphere":{const X=Math.floor(j.radius/5);for(let Q=0;Q<8;Q++)for(let S=0;S<6;S++)Math.sqrt(Math.pow(Q-w,2)+Math.pow(S-$,2))<=X&&L.push({x:Q,y:S});break}case"cube":{const X=Math.floor(j.size/5);for(let Q=w;Q<Math.min(w+X,8);Q++)for(let S=$;S<Math.min($+X,6);S++)Q>=0&&S>=0&&L.push({x:Q,y:S});break}}return L},[]),te=(w,$)=>{if(E({x:w,y:$}),f?.areaOfEffect&&g==="player-turn"){const j=J(w,$,f.areaOfEffect);M(j)}else M([])},K=()=>{E(null),M([])},me=(w,$)=>{if(g==="player-movement"){I(w,$)&&b?.("player",{x:w,y:$});return}if(g==="player-turn"&&f)if(f.areaOfEffect)v?.({x:w,y:$,isPosition:!0});else{const j=B(w,$);j&&ae(w,$)&&v?.(j)}},ie=(w,$)=>{const j=["combat-grid__cell"],L=B(w,$);return L&&(j.push("combat-grid__cell--occupied"),j.push(`combat-grid__cell--${L.type}`),m<d.turnOrder?.length&&d.turnOrder[m]?.id===L.id&&j.push("combat-grid__cell--current-turn"),h.some(X=>X.id===L.id)&&j.push("combat-grid__cell--selected-target")),C?.x===w&&C?.y===$&&j.push("combat-grid__cell--hovered"),D.some(X=>X.x===w&&X.y===$)&&j.push("combat-grid__cell--aoe-highlight"),I(w,$)&&j.push("combat-grid__cell--valid-movement"),ae(w,$)&&j.push("combat-grid__cell--valid-target"),j.join(" ")},Ee=w=>{switch(w.type){case"player":return"🧙‍♂️";case"companion":return"🐺";case"enemy":return"👹";default:return"❓"}},Le=(w,$)=>{const j=B(w,$),L=`${w}-${$}`;return i.jsxs("div",{className:ie(w,$),onMouseEnter:()=>te(w,$),onMouseLeave:K,onClick:()=>me(w,$),title:j?`${j.name} (${j.currentHP}/${j.maxHP} PV)`:`Case (${w}, ${$})`,children:[i.jsxs("span",{className:"combat-grid__coordinates",children:[w,",",$]}),j&&i.jsxs("div",{className:"combat-grid__combatant",children:[j.image?i.jsx("img",{src:j.image,alt:j.name,className:"combat-grid__combatant-image"}):i.jsx("span",{className:"combat-grid__combatant-icon",children:Ee(j)}),i.jsx("span",{className:"combat-grid__combatant-name",children:j.name}),i.jsxs("span",{className:"combat-grid__combatant-ac",children:["CA",j.ac]}),i.jsxs("span",{className:"combat-gird-health",children:[j.currentHP,"/",j.maxHP,"❤️"]}),i.jsx("div",{className:"combat-grid__health-bar w-95",children:i.jsx("div",{className:"combat-grid__health-fill",style:{width:`${j.currentHP/j.maxHP*100}%`,backgroundColor:V(j.currentHP,j.maxHP)}})})]}),I(w,$)&&i.jsx("div",{className:"combat-grid__movement-indicator",children:"🏃"}),ae(w,$)&&!j&&i.jsx("div",{className:"combat-grid__target-indicator",children:"🎯"})]},L)};return i.jsxs("div",{className:"combat-grid",children:[i.jsx("div",{className:"combat-grid__container",style:{gridTemplateColumns:"repeat(8, 1fr)",gridTemplateRows:"repeat(6, 1fr)"},children:Array.from({length:6},(w,$)=>Array.from({length:8},(j,L)=>Le(L,$)))}),i.jsxs("div",{className:"combat-grid__legend",children:[i.jsxs("div",{className:"combat-grid__legend-item",children:[i.jsx("span",{className:"combat-grid__legend-icon",children:"🧙‍♂️"}),i.jsx("span",{children:"Joueur"})]}),r&&i.jsxs("div",{className:"combat-grid__legend-item",children:[i.jsx("span",{className:"combat-grid__legend-icon",children:"🐺"}),i.jsx("span",{children:"Compagnon"})]}),i.jsxs("div",{className:"combat-grid__legend-item",children:[i.jsx("span",{className:"combat-grid__legend-icon",children:"👹"}),i.jsx("span",{children:"Ennemis"})]})]})]})},Tg=({currentTurn:c,turnOrder:r,phase:s,onPhaseChange:u,onNextTurn:d})=>{const{combatEnemies:f,combatPositions:h,dealDamageToEnemy:m,updateEnemyPosition:g,setDamageCallbacks:v}=Wt(),{addCombatMessage:b}=ha(),{takeDamagePlayer:x,takeDamageCompanionById:A,playerCharacter:N,playerCompanion:C,getActiveCompanions:E}=$t(),D=new Ci;ee.useEffect(()=>{v(x,A)},[v,x,A]);const M=ee.useCallback((w,$)=>{const j=w.type==="companion"?w.id||"companion":w.name,L=$.combatPositions[j];if(!L)return console.warn(`⚠️ Position manquante pour ${w.name} (clé: ${j})`),{moved:!1,newPosition:L};const X=It.calculateOptimalMovement(w,L,$);if(!X)return console.log(`🚫 ${w.name} ne bouge pas - déjà bien placé`),{moved:!1,newPosition:L};if(D.executeEntityMovement(w,L,X,$,b)){g(j,X);const S=Math.abs(X.x-L.x)+Math.abs(X.y-L.y);return b(`${w.name} se déplace de ${S} case(s).`),console.log(`✅ ${w.name} bouge vers (${X.x}, ${X.y})`),{moved:!0,newPosition:X}}else return console.warn(`❌ Mouvement échoué pour ${w.name}`),{moved:!1,newPosition:L}},[D,g,b]),B=ee.useCallback((w,$)=>{const j=w.type==="companion"?w.id||"companion":w.name,L=$.combatPositions[j],X=E(),Q=It.findBestTarget(w,L,{...$,playerCharacter:N,companionCharacter:C,activeCompanions:X});return Q||(console.log(`🎯 ${w.name}: Aucune cible trouvée`),b(`${w.name} ne trouve aucune cible.`)),Q},[N,C,b,E]),V=ee.useCallback((w,$)=>{w.type==="player"?x($):w.type==="companion"?(console.log(w),console.log(w.name),A(w.character.id,$),console.log(w)):w.type==="enemy"&&(m(w.name,$),setTimeout(()=>{const j=f.find(L=>L.name===w.name);j&&j.currentHP<=0&&b(`💀 ${w.name} tombe au combat !`,"enemy-death")},100))},[x,A,m,b,f]),le=ee.useCallback((w,$)=>{const j=w.filter(Q=>Q.attacks.some(S=>{const U=S.range||1;return $<=U}));if(j.length===0)return null;const L=j.filter(Q=>Q.attacks.some(S=>S.type==="melee"&&$<=(S.range||1))),X=j.filter(Q=>Q.attacks.some(S=>S.type==="ranged"&&$<=(S.range||6)));return $<=1&&L.length>0?L[0]:X.length>0?X[0]:j[0]},[]),I=ee.useCallback((w,$,j,L)=>{const Q=(w.attacks||[{name:"Attaque de base",damageDice:"1d6",damageBonus:0,range:1}]).filter(k=>{const Z=k.range||1;return L<=Z});if(Q.length===0)return console.log(`🤷 ${w.name} est trop loin pour attaquer (distance: ${L})`),b(`${w.name} est trop loin pour attaquer.`),!1;const S=Q[Math.floor(Math.random()*Q.length)],U=D.executeEntityAttack(w,S,$,b);return U.success&&V($,U.damage),U.success},[D,b,V]),ae=ee.useCallback((w,$,j,L)=>{const X=le(w.attackSets,L);if(!X)return console.log(`🤷 ${w.name} n'a pas d'attaque viable à distance ${L}`),b(`${w.name} ne peut pas attaquer à cette distance.`),!1;console.log(`⚔️ ${w.name} utilise: ${X.name}`),b(`${w.name} lance ${X.name}.`);let Q=!1,S=0;for(const U of X.attacks){if($.character.currentHP<=0){console.log(`💀 ${$.name} est mort, arrêt des attaques restantes`);break}S++;const k=D.executeEntityAttack(w,U,$,b);k.success&&(Q=!0,V($,k.damage),S<X.attacks.length&&setTimeout(()=>{},200))}return Q},[D,b,le,V]),J=ee.useCallback((w,$,j)=>{if(!$||!$.character)return console.warn(`⚠️ Cible invalide pour ${w.name}`),!1;if($.character.currentHP<=0)return console.log(`💀 ${$.name} est déjà mort, ${w.name} passe son tour`),b(`${w.name} réalise que ${$.name} est déjà tombé au combat.`),!1;const L=w.type==="companion"?w.id||"companion":w.name,X=j.combatPositions[L],Q=wt(X,$.position);return w.attackSets&&w.attackSets.length>0?ae(w,$,j,Q):I(w,$,j,Q)},[ae,I,b]),te=ee.useCallback(w=>{console.log(`👹 === Tour de ${w.name} ===`);const $=f.find(k=>k.name===w.name);if(!$||$.currentHP<=0){console.log(`💀 ${w.name} est mort, tour passé`),setTimeout(()=>{ie(!1),d()},200);return}const j=E(),L={combatPositions:Wt.getState().combatPositions,combatEnemies:f,playerCharacter:N,companionCharacter:C,activeCompanions:j},X=M($,L),Q=f.find(k=>k.name===w.name);if(!Q||Q.currentHP<=0){console.log(`💀 ${w.name} est mort pendant le mouvement, tour annulé`),setTimeout(()=>{ie(!1),d()},200);return}const S={...L,combatPositions:Wt.getState().combatPositions,activeCompanions:j},U=B(Q,S);if(!U){setTimeout(()=>{ie(!1),d()},200);return}setTimeout(()=>{const k=f.find(F=>F.name===w.name);if(!k||k.currentHP<=0){console.log(`💀 ${w.name} est mort avant l'attaque, tour annulé`),ie(!1),d();return}const Z=J(k,U,S);console.log(Z?`✅ ${w.name} a terminé son attaque`:`❌ ${w.name} n'a pas pu attaquer`),setTimeout(()=>{ie(!1),d()},300)},X.moved?800:400)},[f,N,C,M,B,J,d,u]),K=ee.useCallback(w=>{console.log(`🤝 ${w.name} agit`);const $=E(),j=w.character||C;if(!j||j.currentHP<=0){console.log(`💀 TURN: ${w.name} est mort, tour passé`),b(`${w.name} est trop blessé pour agir.`),setTimeout(()=>{ie(!1),d()},500);return}const L={combatPositions:Wt.getState().combatPositions,combatEnemies:f.filter(U=>U.currentHP>0),playerCharacter:null,companionCharacter:null},X={...j,name:w.name,id:w.id||w.name.toLowerCase(),type:"companion",attacks:j.attacks||[{name:"Attaque de base",damageDice:"1d6",damageBonus:0,range:1}]},Q=M(X,L),S={...L,combatPositions:Wt.getState().combatPositions,activeCompanions:$};setTimeout(()=>{const U=B(X,S);if(!U){b(`${w.name} ne trouve aucune cible.`),setTimeout(()=>{ie(!1),d()},500);return}const k=J(X,U,S);console.log(k?`✅ ${w.name} a attaqué avec succès`:`❌ ${w.name} n'a pas pu attaquer`),setTimeout(()=>{ie(!1),d()},500)},Q.moved?1e3:500)},[C,f,D,g,b,J,d,u]),[me,ie]=Oe.useState(!1),[Ee,Le]=Oe.useState(null);return ee.useEffect(()=>{if(s!=="executing-turn"||!c||me)return;const{turnCounter:w,currentTurnIndex:$}=Wt.getState(),j=`${c.name}-${c.type}-${w}-${$}`;if(Ee===j){console.log(`🔄 Tour déjà exécuté: ${j}`);return}console.log(`🎮 Exécution du tour: ${c.name} (${c.type}) - Round: ${w}, Index: ${$}`),ie(!0),Le(j);const L=f.every(U=>U.currentHP<=0),X=!N||N.currentHP<=0;if(L){console.log("🎉 Victoire ! Tous les ennemis sont morts"),ie(!1),u("victory");return}else if(X){console.log("💀 Défaite ! Le joueur est mort"),ie(!1),u("defeat");return}if((()=>{if(c.type==="player")return!N||N.currentHP<=0;if(c.type==="companion")return!C||C.currentHP<=0;if(c.type==="enemy"){const U=f.find(k=>k.name===c.name);return!U||U.currentHP<=0}return!1})()){console.log(`💀 ${c.name} est mort, tour passé automatiquement`),ie(!1);const U=f.every(Z=>Z.currentHP<=0),k=!N||N.currentHP<=0;if(U){console.log("🎉 Tous les ennemis sont morts - Victoire !"),u("victory");return}else if(k){console.log("💀 Le joueur est mort - Défaite !"),u("defeat");return}d();return}const S=U=>{try{U()}catch(k){console.error(`❌ Erreur pendant l'exécution du tour ${c.name}:`,k),ie(!1),d()}};switch(c.type){case"enemy":S(()=>{te(c),setTimeout(()=>ie(!1),800)});break;case"companion":S(()=>{K(c),setTimeout(()=>ie(!1),800)});break;case"player":N&&N.currentHP>0?(console.log(`👤 Tour du joueur: ${c.name}`),ie(!1),setTimeout(()=>{f.every(k=>k.currentHP<=0)&&(console.log("🎉 Victoire détectée après le tour du joueur !"),u("victory"))},100)):(console.log("💀 Joueur mort, fin de combat"),ie(!1),u("defeat"));break;default:console.warn(`❓ Type de tour inconnu: ${c.type}`),ie(!1),d()}},[s,c,me,Ee,te,K,d,u,N,C,f]),null},Mg=({playerCharacter:c,selectedAction:r,selectedTargets:s,onSelectAction:u,onExecuteAction:d,onPassTurn:f,canMove:h=!0,onMoveToggle:m})=>{const v=(()=>{const E=[];if(c.equipment?.mainHand){const M=c.equipment.mainHand,B=cn[M];B&&E.push({...B,id:M})}const D=(c.weapons||[]).map(M=>cn[M]).filter(M=>M).map(M=>({...M,id:M.id}));return E.push(...D),E})(),b=v.length>0?v.map(E=>({id:`attack_${E.id||E.name}`,type:"attack",name:E.name,description:`Attaque avec ${E.name}`,damage:typeof E.damage=="object"?`${E.damage.dice}${E.damage.bonus>0?`+${E.damage.bonus}`:""}`:E.damage,damageType:E.damageType,range:E.category==="ranged"?E.range?.ranged:E.range?.melee||1,stat:E.stat,icon:E.category==="ranged"?"🏹":"⚔️"})):[{id:"attack_unarmed",type:"attack",name:"Attaque à mains nues",description:"Attaque de base sans arme",damage:"1d4",damageType:"contondant",range:1,stat:"force",icon:"👊"}],x=[];if(c.spellcasting){const E=(c.spellcasting.cantrips||[]).map(M=>{const B=$a[M]||{};return{id:`cantrip_${M}`,type:"spell",name:M,description:`Cantrip: ${M}`,level:0,range:B.range||60,projectiles:B.projectiles||1,damage:B.damage,requiresAttackRoll:B.requiresAttackRoll,icon:"✨"}}),D=(c.spellcasting.preparedSpells||[]).filter(M=>{const V=($a[M]||{}).level||1,le=c.spellcasting.spellSlots||{};for(let I=V;I<=9;I++){const ae=le[I];if(ae&&ae.available>0)return!0}return!1}).map(M=>{const B=$a[M]||{};return{id:`spell_${M}`,type:"spell",name:M,description:`Sort: ${M}`,level:B.level||1,range:B.range||30,projectiles:B.projectiles||1,damage:B.damage,requiresAttackRoll:B.requiresAttackRoll,icon:"🔮"}});x.push(...E,...D)}const A=E=>i.jsx(mm,{variant:r?.id===E.id?"primary":"secondary",onClick:()=>u(E),disabled:r&&r.id!==E.id,children:i.jsxs("div",{className:"action-button__content",children:[i.jsx("span",{className:"action-button__icon",children:E.icon}),i.jsxs("div",{className:"action-button__details",children:[i.jsx("span",{className:"action-button__name",children:E.name}),E.damage&&i.jsxs("span",{className:"action-button__damage",children:["Dégâts: ",typeof E.damage=="string"?E.damage:`${E.damage.dice}${E.damage.bonus>0?`+${E.damage.bonus}`:""}`]}),E.level>0&&i.jsxs("span",{className:"action-button__level",children:["Niveau ",E.level]})]})]})},E.id);r&&s.length>0;const N=r?.projectiles||1,C=s.length<N;return i.jsxs(xe,{className:"combat-action-panel",children:[i.jsxs(Gt,{children:[i.jsxs("h3",{children:["🎯 Actions de ",c.name]}),i.jsx("div",{className:"combat-action-panel__status",children:r&&i.jsxs("span",{className:"selected-action",children:[r.name," sélectionné",C&&i.jsxs("span",{className:"target-count",children:["(",s.length,"/",N," cibles)"]})]})})]}),i.jsxs(Qe,{children:[h&&i.jsxs("div",{className:"combat-action-section",children:[i.jsx("h4",{children:"Mouvement"}),i.jsx(mm,{variant:"ghost",onClick:m,disabled:!!r,children:i.jsxs("div",{className:"action-button__content",children:[i.jsx("span",{className:"action-button__icon",children:"🏃"}),i.jsx("span",{className:"action-button__name",children:"Se déplacer"})]})})]}),b.length>0&&i.jsxs("div",{className:"combat-action-section",children:[i.jsx("h4",{children:"Attaques"}),i.jsx("div",{className:"combat-actions-grid",children:b.map(A)})]}),x.length>0&&i.jsxs("div",{className:"combat-action-section",children:[i.jsx("h4",{children:"Sorts"}),i.jsx("div",{className:"combat-actions-grid",children:x.map(A)})]}),r&&i.jsx("div",{className:"combat-action-instructions",children:i.jsx("p",{children:r.areaOfEffect?"Cliquez sur une case pour cibler la zone d'effet":C?`Sélectionnez ${N-s.length} cible(s) pour exécuter l'action`:"Action prête à être exécutée"})}),s.length>0&&i.jsxs("div",{className:"combat-selected-targets",children:[i.jsx("h5",{children:"Cibles sélectionnées:"}),i.jsx("ul",{className:"combat-selected-targets__list",children:s.map((E,D)=>i.jsxs("li",{className:"selected-target",children:[E.name," (PV: ",E.currentHP,"/",E.maxHP,")"]},D))})]})]}),i.jsx(Ri,{children:i.jsxs("div",{className:"combat-action-panel__controls",children:[r&&i.jsx(se,{variant:"ghost",onClick:()=>u(null),children:"Annuler"}),i.jsx(se,{variant:"secondary",onClick:f,children:"Passer le tour"})]})})]})},Dg=({playerCharacter:c,playerCompanion:r,activeCompanions:s=[],encounterData:u,onCombatEnd:d,onReplayCombat:f,combatKey:h})=>{const{combatPhase:m,currentTurnIndex:g,turnOrder:v,combatEnemies:b,combatPositions:x,playerAction:A,actionTargets:N,defeated:C,victory:E,isInitialized:D,initializeCombat:M,startCombat:B,setTurnPhase:V,nextTurn:le,setPlayerAction:I,setActionTargets:ae,resetCombat:J,moveCharacter:te}=Wt(),K=v[g],me=()=>ae([]),{addCombatMessage:ie,combatLog:Ee,clearCombatLog:Le}=ha();ee.useEffect(()=>{if(!(!u||!u.enemies?.length)&&(h!==void 0&&J(),!D)){const Q=s.length>0?s[0]:r;M(u,c,Q,s)}},[u,h,D,c,r,s,M,B,J,ie,v]),ee.useEffect(()=>{m==="initiative-display"&&(ie("Un combat commence !","combat-start"),v.forEach(Q=>{const S=`${Q.name} a obtenu ${Q.initiative} en initiative !`;ie(S,"combat-start")}))},[m]),ee.useEffect(()=>{if(m==="turn"&&K){console.log(`🎮 Phase 'turn' détectée pour ${K.name} (${K.type})`);const Q=b.every(U=>U.currentHP<=0),S=!c||c.currentHP<=0;if(Q){console.log("🎉 Victoire détectée dans la transition de phase !"),V("victory");return}else if(S){console.log("💀 Défaite détectée dans la transition de phase !"),V("defeat");return}K.type==="player"?(console.log(`👤 Passage en phase player-turn pour ${K.name}`),V("player-turn")):(K.type==="enemy"||K.type==="companion")&&(console.log(`🤖 Passage en phase executing-turn pour ${K.name}`),V("executing-turn"))}},[m,K,V,b,c,r]);const w=ee.useCallback(Q=>{I(Q)},[I]),$=ee.useCallback(Q=>{if(!A)return;const S=[...N,Q];ae(S);const U=A.projectiles||1;S.length>=U&&setTimeout(()=>{const Z=new Ci().executePlayerAction(c,A,S,b,x);Z.messages.forEach(F=>ie(F.text,F.type)),Z.damage&&Z.damage.length>0&&Z.damage.forEach(F=>{const fe=b.find(ce=>ce.name===F.targetId||ce.id===F.targetId);if(fe){const{dealDamageToEnemy:ce}=Wt.getState();ce(fe.name,F.damage),setTimeout(()=>{const Ze=b.find(_e=>_e.name===fe.name);Ze&&Ze.currentHP<=0&&fe.currentHP>0&&ie(`💀 ${fe.name} tombe au combat !`,"enemy-death")},100)}}),me(),I(null),le()},500)},[A,N,ae,c,b,x,ie,me,I,le]),j=ee.useCallback(()=>{if(!A||!N.length)return;new Ci().executePlayerAction(c,A,N,b,x).messages.forEach(U=>ie(U.text,U.type)),me(),I(null),le()},[A,N,c,b,x,ie,me,I,le]),L=()=>{ie(`${c.name} passe son tour.`),me(),I(null),le()},X=()=>{switch(m){case"initializing":return i.jsx(xe,{children:i.jsxs("div",{className:"combat-phase-content",children:[i.jsx("h3",{children:"Initialisation du combat..."}),i.jsx("p",{children:"Préparation des combattants et jets d'initiative"})]})});case"initiative-display":return i.jsx(xe,{children:i.jsxs("div",{className:"combat-phase-content",children:[i.jsx("h3",{children:"Initiative lancée !"}),i.jsx("p",{children:"Les jets d'initiative ont été effectués. Prêt à commencer le combat ?"}),i.jsx(se,{onClick:()=>B(),children:"Commencer le combat"})]})});case"player-turn":return i.jsx(Mg,{playerCharacter:c,selectedAction:A,selectedTargets:N,onSelectAction:w,onExecuteAction:j,onPassTurn:L,canMove:!x.playerHasMoved,onMoveToggle:()=>V("player-movement")});case"player-movement":return i.jsx(xe,{children:i.jsxs("div",{className:"combat-phase-content",children:[i.jsx("h3",{children:"Phase de mouvement"}),i.jsx("p",{children:"Cliquez sur une case pour vous déplacer (maximum 6 cases)"}),i.jsx(se,{onClick:()=>V("player-turn"),children:"Terminer le mouvement"})]})});case"victory":return i.jsx(xe,{children:i.jsxs("div",{className:"combat-phase-content",children:[i.jsx("h3",{children:"🎉 Victoire !"}),i.jsx("p",{children:"Tous les ennemis ont été vaincus !"}),i.jsx(se,{onClick:()=>{Le(),d?.(u)},children:"Continuer l'aventure"})]})});case"defeat":return i.jsx(xe,{variant:"danger",children:i.jsxs("div",{className:"combat-phase-content",children:[i.jsx("h3",{children:"💀 Défaite"}),i.jsx("p",{children:"Vous avez été vaincu..."}),i.jsx("div",{className:"combat-defeat-actions",children:i.jsx(se,{variant:"secondary",onClick:f,children:"Rejouer le combat"})})]})});case"enemy-turn":case"companion-turn":case"executing-turn":return i.jsx(xe,{children:i.jsxs("div",{className:"combat-phase-content",children:[i.jsx("h3",{children:"Tour en cours"}),i.jsxs("p",{children:[K?.type==="enemy"&&`${K.name} réfléchit...`,K?.type==="companion"&&`${K.name} agit...`,(!K||K.type==="player")&&"Attendez la fin du tour en cours..."]})]})});default:return i.jsx(xe,{children:i.jsxs("div",{className:"combat-phase-content",children:[i.jsx("h3",{children:"Combat en cours"}),i.jsxs("p",{children:["Phase: ",m," - Attendez..."]})]})})}};return D?i.jsxs("div",{className:"combat-container",children:[i.jsx(Tg,{currentTurn:K,turnOrder:v,phase:m,onPhaseChange:V,onNextTurn:le}),i.jsxs("div",{className:"combat-layout",children:[i.jsx("div",{className:"combat-grid-section",children:i.jsx(Ag,{playerCharacter:c,playerCompanion:r,activeCompanions:s,enemies:b,positions:x,selectedAction:A,selectedTargets:N,currentTurn:K,phase:m,onTargetSelect:$,onMoveCharacter:(Q,S)=>{te(Q,S)}})}),i.jsxs("div",{className:"combat-side-container",children:[i.jsx("div",{className:"combat-controls",children:X()}),i.jsx("div",{className:"combat-log-section",children:i.jsx(as,{title:"Combat",maxEntries:10,showTimestamps:!1})})]})]})]}):i.jsx("div",{className:"combat-container",children:i.jsx(xe,{children:i.jsx("div",{className:"combat-loading",children:i.jsx("h3",{children:"Chargement du combat..."})})})})},Rg=({item:c,character:r,viewMode:s="grid",onClick:u,onUse:d,onEquip:f,onUnequip:h,className:m=""})=>{const g=c.nom||c.name||"Objet inconnu",v=c.description||"Aucune description",b=c.quantity||1,x=c.poids||c.weight||.1,A=c.rarity||"commun",N=c.type||"misc",C=c.equipped||!1,E=["inventory-item",`inventory-item--${s}`,`inventory-item--${N}`,`inventory-item--${A.replace(/\s+/g,"-")}`,C&&"inventory-item--equipped",m].filter(Boolean).join(" "),D=()=>{switch(N){case"weapon":case"arme":return"⚔️";case"armor":case"armure":return"🛡️";case"consumable":case"potion":return"🧪";case"accessory":case"accessoire":return"💎";case"outil":return"🔧";case"livre":return"📚";default:return"📦"}},M=()=>{switch(A?.toLowerCase()){case"commun":return"🪙";case"peu commun":return"💰";case"rare":return"💎";case"très rare":return"🏆";case"légendaire":return"🌟";case"artéfact":return"🗝️";default:return"📦"}},B=J=>{switch(J?.toLowerCase()){case"commun":return"#9e9e9e";case"peu commun":return"#4caf50";case"rare":return"#2196f3";case"très rare":return"#9c27b0";case"légendaire":return"#ff9800";case"artéfact":return"#f44336";default:return"#9e9e9e"}},V=()=>["weapon","armor","accessory"].includes(N)&&!C,le=()=>c.effet||c.action||N==="potion"||N==="consumable",I=()=>i.jsx(xe,{className:E,onClick:u,style:{borderColor:B(A)},children:i.jsxs("div",{className:"inventory-item__content",children:[i.jsxs("div",{className:"inventory-item__header",title:`${g} - ${v} item ${A}`,children:[i.jsx("span",{className:"inventory-item__icon",children:D()}),i.jsx("h5",{className:"inventory-item__name",children:g}),b>1&&i.jsxs("span",{className:"inventory-item__quantity",children:["x ",b]}),i.jsx("span",{className:"inventory-item__icon",children:M()}),C&&i.jsx("span",{className:"inventory-item__equipped-badge",children:"✓"})]}),i.jsx("div",{className:"inventory-item__info",children:s!=="compact"&&i.jsxs(i.Fragment,{children:[i.jsx("p",{className:"inventory-item__description",children:v.length>100?`${v.substring(0,100)}...`:v}),i.jsxs("div",{className:"inventory-item__stats",children:[x>0&&i.jsxs("span",{className:"inventory-item__weight",children:["⚖️ ",x," kg"]}),i.jsx("span",{className:"inventory-item__rarity",children:A})]})]})}),s!=="compact"&&i.jsxs("div",{className:"inventory-item__actions",children:[le()&&i.jsx(se,{size:"small",variant:"primary",onClick:J=>{J.stopPropagation(),d?.()},children:"Utiliser"}),V()&&i.jsx(se,{size:"small",variant:"secondary",onClick:J=>{J.stopPropagation(),f?.()},children:"Équiper"}),C&&i.jsx(se,{size:"small",variant:"ghost",onClick:J=>{J.stopPropagation(),h?.()},children:"Retirer"})]})]})}),ae=()=>i.jsx("div",{className:E,onClick:u,children:i.jsxs("div",{className:"inventory-item__list-content",children:[i.jsxs("div",{className:"inventory-item__header",title:`${g} - ${v} item ${A}`,children:[i.jsx("span",{className:"inventory-item__icon",children:D()}),i.jsx("h5",{className:"inventory-item__name",children:g}),b>1&&i.jsxs("span",{className:"inventory-item__quantity",children:["x ",b]}),i.jsx("span",{className:"inventory-item__icon",children:M()}),C&&i.jsx("span",{className:"inventory-item__equipped-badge",children:"✓"})]}),i.jsxs("div",{className:"inventory-item__list-actions",children:[le()&&i.jsx(se,{size:"small",variant:"primary",onClick:J=>{J.stopPropagation(),d?.()},children:"Utiliser"}),V()&&i.jsx(se,{size:"small",variant:"secondary",onClick:J=>{J.stopPropagation(),f?.()},children:"Équiper"}),C&&i.jsx(se,{size:"small",variant:"ghost",onClick:J=>{J.stopPropagation(),h?.()},children:"Retirer"})]})]})});switch(s){case"list":return ae();case"compact":case"grid":default:return I()}},Og=({items:c=[],viewMode:r="grid",onItemClick:s,onItemUse:u,onItemEquip:d,onItemUnequip:f,character:h,className:m=""})=>{const g=["inventory-grid",`inventory-grid--${r}`,m].filter(Boolean).join(" ");return c.length===0?i.jsx("div",{className:"inventory-grid-empty"}):i.jsx("div",{className:g,children:c.map((v,b)=>i.jsx(Rg,{item:v,character:h,viewMode:r,onClick:()=>s?.(v),onUse:()=>u?.(v),onEquip:()=>d?.(v),onUnequip:()=>f?.(v)},v.id||v.nom||v.name||b))})},zg=({filters:c={},onFilterChange:r,sortBy:s="name",onSortChange:u,availableItems:d=[],className:f=""})=>{const h=D=>{r?.({searchTerm:D.target.value})},m=D=>{r?.({category:D})},g=D=>{r?.({rarity:D})},v=()=>{r?.({category:"all",rarity:"all",searchTerm:""})},b=D=>D.type==="weapon"||D.type==="arme"||D.degats?"weapons":D.type==="armor"||D.type==="armure"||D.ca?"armor":D.type==="consumable"||D.type==="potion"||D.effet?"consumables":D.type==="accessoire"?"accessories":"misc",x=[{value:"all",label:"Tout",icon:"📦"},{value:"weapons",label:"Armes",icon:"⚔️"},{value:"armor",label:"Armures",icon:"🛡️"},{value:"consumables",label:"Consommables",icon:"🧪"},{value:"accessories",label:"Accessoires",icon:"💎"},{value:"misc",label:"Divers",icon:"🎒"}],A=Oe.useMemo(()=>{const D=new Set(["all"]);return d.forEach(M=>{D.add(b(M))}),x.filter(M=>D.has(M.value))},[d]),N=[{value:"all",label:"Toutes",color:"#9e9e9e",icon:"📦"},{value:"commun",label:"Commun",color:"#9e9e9e",icon:"🪙"},{value:"peu commun",label:"Peu commun",color:"#4caf50",icon:"💰"},{value:"rare",label:"Rare",color:"#2196f3",icon:"💎"},{value:"très rare",label:"Très rare",color:"#9c27b0",icon:"🏆"},{value:"légendaire",label:"Légendaire",color:"#ff9800",icon:"🌟"}],C=Oe.useMemo(()=>{const D=new Set(["all"]);return d.forEach(M=>{const B=M.rarity||"commun";D.add(B)}),N.filter(M=>D.has(M.value))},[d]),E=[{value:"name",label:"Nom",icon:"🔤"},{value:"type",label:"Type",icon:"📁"},{value:"weight",label:"Poids",icon:"⚖️"},{value:"rarity",label:"Rareté",icon:"⭐"}];return i.jsxs("div",{className:`inventory-filters ${f}`,children:[i.jsx("div",{className:"inventory-filters__search",children:i.jsxs("div",{className:"search-input-group",children:[i.jsx("span",{className:"search-icon",children:"🔍"}),i.jsx("input",{type:"text",placeholder:"Rechercher un objet...",value:c.searchTerm||"",onChange:h,className:"search-input"}),c.searchTerm&&i.jsx("button",{type:"button",className:"search-clear",onClick:()=>r?.({searchTerm:""}),children:"✕"})]})}),i.jsxs("div",{className:"inventory-filters__section",children:[i.jsx("h5",{className:"inventory-filters__label",children:"Catégories"}),i.jsx(pa,{className:"inventory-filters__category-buttons",children:A.map(D=>i.jsxs(se,{variant:c.category===D.value?"primary":"ghost",size:"small",onClick:()=>m(D.value),children:[i.jsx("span",{className:"button-icon",children:D.icon}),D.label]},D.value))})]}),i.jsxs("div",{className:"inventory-filters__section",children:[i.jsx("h5",{className:"inventory-filters__label",children:"Rareté"}),i.jsx(pa,{className:"inventory-filters__rarity-buttons",children:C.map(D=>i.jsxs(se,{variant:c.rarity===D.value?"primary":"ghost",size:"small",onClick:()=>g(D.value),style:c.rarity===D.value?{borderColor:D.color}:{},children:[i.jsx("span",{className:"button-icon",children:D.icon}),D.label]},D.value))})]}),i.jsxs("div",{className:"inventory-filters__section",children:[i.jsx("h5",{className:"inventory-filters__label",children:"Trier par"}),i.jsx(pa,{className:"inventory-filters__sort-buttons",children:E.map(D=>i.jsxs(se,{variant:s===D.value?"primary":"ghost",size:"small",onClick:()=>u?.(D.value),children:[i.jsx("span",{className:"button-icon",children:D.icon}),D.label]},D.value))})]}),i.jsx("div",{className:"inventory-filters__actions",children:i.jsx(se,{variant:"ghost",size:"small",onClick:v,disabled:c.category==="all"&&c.rarity==="all"&&!c.searchTerm,children:"🗑️ Effacer les filtres"})})]})},Hg=({item:c,character:r,onClose:s,onUse:u,onEquip:d,onUnequip:f})=>{if(!c)return null;const h=c.nom||c.name||"Objet inconnu",m=c.description||"Aucune description disponible",g=c.quantity||1,v=c.poids||c.weight||0,b=c.rarity||"commun",x=c.type||"misc",A=c.equipped||!1,N=()=>{const V=[];return c.degats&&V.push({label:"Dégâts",value:c.degats,icon:"⚔️"}),c.ca!==void 0&&V.push({label:"Classe d'Armure",value:`+${c.ca}`,icon:"🛡️"}),c.portee&&V.push({label:"Portée",value:`${c.portee} m`,icon:"🏹"}),c.proprietes&&c.proprietes.length>0&&V.push({label:"Propriétés",value:c.proprietes.join(", "),icon:"⭐"}),c.effet&&V.push({label:"Effet",value:c.effet,icon:"✨"}),c.duree&&V.push({label:"Durée",value:c.duree,icon:"⏱️"}),c.prix&&V.push({label:"Prix",value:`${c.prix} po`,icon:"💰"}),V},C=()=>{switch(x){case"arme":return"⚔️";case"armure":return"🛡️";case"potion":return"🧪";case"accessoire":return"💎";case"outil":return"🔧";case"livre":return"📚";case"gemme":return"💎";case"composant":return"🧪";default:return"📦"}},E=V=>{switch(V?.toLowerCase()){case"commun":return"#9e9e9e";case"peu commun":return"#4caf50";case"rare":return"#2196f3";case"très rare":return"#9c27b0";case"légendaire":return"#ff9800";case"artéfact":return"#f44336";default:return"#9e9e9e"}},D=()=>["arme","armure","accessoire"].includes(x)&&!A,M=()=>c.effet||c.action||x==="potion",B=N();return i.jsx(su,{onClose:s,size:"medium",children:i.jsxs(xe,{className:"item-detail-modal",children:[i.jsx(Gt,{children:i.jsxs("div",{className:"item-detail-header",children:[i.jsxs("div",{className:"item-detail-icon-container",children:[i.jsx("span",{className:"item-detail-icon",style:{color:E(b)},children:C()}),g>1&&i.jsxs("span",{className:"item-detail-quantity",children:["x",g]})]}),i.jsxs("div",{className:"item-detail-title",children:[i.jsx("h2",{className:"item-detail-name",children:h}),i.jsxs("div",{className:"item-detail-meta",children:[i.jsx("span",{className:"item-detail-rarity",style:{color:E(b)},children:b}),i.jsx("span",{className:"item-detail-type",children:x}),A&&i.jsx("span",{className:"item-detail-equipped",children:"✓ Équipé"})]})]})]})}),i.jsxs(Qe,{children:[i.jsxs("div",{className:"item-detail-section",children:[i.jsx("h4",{children:"Description"}),i.jsx("p",{className:"item-detail-description",children:m})]}),B.length>0&&i.jsxs("div",{className:"item-detail-section",children:[i.jsx("h4",{children:"Propriétés"}),i.jsx("div",{className:"item-detail-properties",children:B.map((V,le)=>i.jsxs("div",{className:"item-detail-property",children:[i.jsx("span",{className:"property-icon",children:V.icon}),i.jsxs("span",{className:"property-label",children:[V.label,":"]}),i.jsx("span",{className:"property-value",children:V.value})]},le))})]}),i.jsxs("div",{className:"item-detail-section",children:[i.jsx("h4",{children:"Informations"}),i.jsxs("div",{className:"item-detail-stats",children:[i.jsxs("div",{className:"stat-item",children:[i.jsx("span",{className:"stat-icon",children:"⚖️"}),i.jsx("span",{className:"stat-label",children:"Poids:"}),i.jsxs("span",{className:"stat-value",children:[v," kg"]})]}),g>1&&i.jsxs("div",{className:"stat-item",children:[i.jsx("span",{className:"stat-icon",children:"📦"}),i.jsx("span",{className:"stat-label",children:"Quantité:"}),i.jsx("span",{className:"stat-value",children:g})]})]})]}),(c.prerequis||c.restrictions)&&i.jsxs("div",{className:"item-detail-section",children:[i.jsx("h4",{children:"Restrictions"}),i.jsxs("div",{className:"item-detail-restrictions",children:[c.prerequis&&i.jsxs("p",{className:"restriction",children:[i.jsx("span",{className:"restriction-icon",children:"⚠️"}),"Prérequis: ",c.prerequis]}),c.restrictions&&i.jsxs("p",{className:"restriction",children:[i.jsx("span",{className:"restriction-icon",children:"🚫"}),c.restrictions]})]})]})]}),i.jsx(Ri,{children:i.jsxs("div",{className:"item-detail-actions",children:[i.jsx(se,{variant:"ghost",onClick:s,children:"Fermer"}),M()&&i.jsx(se,{variant:"primary",onClick:()=>{u?.(c),s()},children:"🧪 Utiliser"}),D()&&i.jsx(se,{variant:"secondary",onClick:()=>{d?.(c),s()},children:"⚔️ Équiper"}),A&&i.jsx(se,{variant:"ghost",onClick:()=>{f?.(c),s()},children:"🗲 Retirer"})]})})]})})},qg=({className:c="",characterInventory:r,onUseItem:s})=>{const{selectedCharacter:u,useItem:d,equipItem:f,unequipItem:h}=$t(),m=u,{addCombatMessage:g}=ha(),[v,b]=ee.useState(null),[x,A]=ee.useState({category:"all",rarity:"all",searchTerm:""}),[N,C]=ee.useState("name"),[E,D]=ee.useState("grid"),M=ee.useMemo(()=>{if(!m)return{items:[],totalWeight:0,maxWeight:0,allItems:[]};const te=m.equipment?Object.values(m.equipment).filter(Boolean).map($=>{const j=cn[$];return j?{...j,id:$,equipped:!0}:null}).filter(Boolean):[],K=[...m.inventory||[],...te,...m.equipement?.inventaire||[],...m.equipement?.armes||[],...m.equipement?.armures||[],...m.equipement?.accessoires||[]];let me=K.filter($=>{if(x.category!=="all"&&au($)!==x.category||x.rarity!=="all"&&($.rarity||"commun")!==x.rarity)return!1;if(x.searchTerm){const j=x.searchTerm.toLowerCase();return $.nom?.toLowerCase().includes(j)||$.description?.toLowerCase().includes(j)||$.name?.toLowerCase().includes(j)}return!0});me=Bg(me,N);const ie=K.reduce(($,j)=>$+(j.poids||j.weight||.1)*(j.quantity||1),0),Ee=Ug(m),Le=K.reduce(($,j)=>$+(j.quantity||1),0),w=me.reduce(($,j)=>$+(j.quantity||1),0);return{items:me,totalWeight:ie,maxWeight:Ee,totalItemCount:Le,filteredItemCount:w,allItems:K}},[m?.inventory,m?.equipement,x,N]),B=te=>{try{const K=d(te.id||te.nom||te.name);K.success?(g(K.message,"item"),console.log(te.name,K.message),s&&s(te.id||te.nom||te.name)):g(K.message,"error")}catch(K){console.error("Erreur lors de l'utilisation de l'objet:",K),g(`Erreur: ${K.message}`,"error")}},V=te=>{try{const K=te.id||te.name||te.nom;f(K,"player"),g(`${te.nom||te.name} équipé !`,"success")}catch(K){console.error("Erreur lors de l'équipement:",K),g(`Erreur lors de l'équipement: ${K.message}`,"error")}},le=te=>{try{const K=te.id||te.name||te.nom;h(K,"player"),g(`${te.nom||te.name} retiré !`,"info")}catch(K){console.error("Erreur lors du déséquipement:",K),g(`Erreur lors du déséquipement: ${K.message}`,"error")}},I=te=>{A({...x,...te})},ae=te=>{C(te)};if(!m)return i.jsx(xe,{className:`inventory-panel ${c}`,children:i.jsx(Qe,{children:i.jsx("p",{children:"Aucun personnage sélectionné"})})});const J=M.totalWeight>M.maxWeight;return i.jsxs(xe,{className:`inventory-panel ${c}`,children:[i.jsx(Gt,{children:i.jsxs("div",{className:"inventory-panel__header",children:[i.jsxs("h3",{className:"inventory--title",children:["🎒 Inventaire de ",m.name]}),i.jsxs("div",{className:"inventory-panel__stats",children:[i.jsxs("div",{className:`inventory-weight ${J?"inventory-weight--overloaded":""}`,children:[i.jsxs("span",{children:["⚖️ Poids: ",M.totalWeight.toFixed(1),"/",M.maxWeight," kg"]}),J&&i.jsx("span",{className:"overload-warning",children:"⚠️ Surcharge"})]}),i.jsx("div",{className:"inventory-count",children:i.jsxs("span",{children:["📦 Objets: ",M.filteredItemCount,"/",M.totalItemCount]})})]}),i.jsxs("div",{className:"inventory-panel__controls",children:[i.jsx(se,{variant:E==="grid"?"primary":"ghost",size:"small",onClick:()=>D("grid"),children:"🔳 Grille"}),i.jsx(se,{variant:E==="list"?"primary":"ghost",size:"small",onClick:()=>D("list"),children:"📝 Liste"})]})]})}),i.jsxs(Qe,{children:[i.jsx(zg,{filters:x,onFilterChange:I,sortBy:N,onSortChange:ae,availableItems:M.allItems}),i.jsx(Og,{items:M.items,viewMode:E,onItemClick:b,onItemUse:B,onItemEquip:V,onItemUnequip:le,character:m}),M.items.length===0&&i.jsx("div",{className:"inventory-empty",children:M.allItemsCount===0?i.jsx("p",{children:"🎒 Votre inventaire est vide"}):i.jsx("p",{children:"🔍 Aucun objet ne correspond aux filtres appliqués"})})]}),v&&i.jsx(Hg,{item:v,character:m,onClose:()=>b(null),onUse:B,onEquip:V,onUnequip:le})]})};function au(c){return c.type==="weapon"||c.type==="arme"||c.degats?"weapons":c.type==="armor"||c.type==="armure"||c.ca?"armor":c.type==="consumable"||c.type==="potion"||c.effet?"consumables":c.type==="accessoire"?"accessories":"misc"}function Bg(c,r){return[...c].sort((s,u)=>{switch(r){case"name":return(s.nom||s.name||"").localeCompare(u.nom||u.name||"");case"weight":return(s.poids||s.weight||0)-(u.poids||u.weight||0);case"rarity":const d={commun:0,"peu commun":1,rare:2,"très rare":3,légendaire:4};return(d[s.rarity]||0)-(d[u.rarity]||0);case"type":return au(s).localeCompare(au(u));default:return 0}})}function Ug(c){return c?.stats?.force?c.stats.force*7.5:50}const wg=({spellSlots:c={},onSlotUse:r,onSlotRestore:s,showDetails:u=!0,className:d=""})=>{const f=Object.keys(c).map(v=>parseInt(v)).sort((v,b)=>v-b);if(f.length===0)return i.jsx(xe,{className:`spell-slot-tracker ${d}`,children:i.jsx("div",{className:"spell-slot-tracker__empty",children:i.jsx("p",{children:"Aucun emplacement de sort disponible"})})});const h=f.reduce((v,b)=>{const x=c[b];return v+(x?.max||0)},0),m=f.reduce((v,b)=>{const x=c[b];return v+(x?.used||0)},0),g=h-m;return i.jsx(xe,{className:`spell-slot-tracker ${d}`,children:i.jsxs("div",{className:"spell-slot-tracker__content",children:[i.jsxs("div",{className:"spell-slot-tracker__header",children:[i.jsx("h4",{className:"spell-slot-tracker__title",children:"🔮 Emplacements de sorts"}),i.jsx("div",{className:"spell-slot-tracker__summary",children:i.jsxs("span",{className:"slot-summary",children:[g,"/",h," disponibles"]})})]}),i.jsx("div",{className:"spell-slot-tracker__grid",children:f.map(v=>{const b=c[v];if(!b||b.max===0)return null;const x=b.max-(b.used||0),A=b.max>0?(b.used||0)/b.max*100:0;return i.jsxs("div",{className:"spell-slot-level",children:[i.jsxs("div",{className:"spell-slot-level__header",children:[i.jsxs("h5",{className:"spell-slot-level__title",children:["Niveau ",v]}),i.jsxs("span",{className:"spell-slot-level__count",children:[x,"/",b.max]})]}),i.jsx("div",{className:"spell-slot-level__progress",children:i.jsx("div",{className:"spell-slot-progress-bar",children:i.jsx("div",{className:"spell-slot-progress-fill",style:{width:`${100-A}%`,backgroundColor:x>0?"#4caf50":"#f44336"}})})}),u&&i.jsx("div",{className:"spell-slot-level__details",children:i.jsx("div",{className:"spell-slot-dots",children:Array.from({length:b.max},(N,C)=>i.jsx("span",{className:`spell-slot-dot ${C<(b.used||0)?"spell-slot-dot--used":"spell-slot-dot--available"}`,title:C<(b.used||0)?"Emplacement utilisé":"Emplacement disponible",children:C<(b.used||0)?"●":"○"},C))})})]},v)})}),m===h&&i.jsxs("div",{className:"spell-slot-tracker__warning",children:[i.jsx("span",{className:"warning-icon",children:"⚠️"}),i.jsx("span",{children:"Tous les emplacements de sorts ont été utilisés"})]})]})})},vm=({spell:c,character:r,spellSlots:s={},viewMode:u="list",actions:d={},isOutOfCombat:f=!1,onClick:h,onCast:m,onPrepare:g,onUnprepare:v,className:b=""})=>{const[x,A]=ee.useState(!1),N=["spell-item",`spell-item--${u}`,`spell-item--level-${c.level}`,`spell-item--${c.school?.toLowerCase().replace(/\s+/g,"-")}`,b].filter(Boolean).join(" "),C=()=>{switch(c.school){case"Évocation":return"🔥";case"Abjuration":return"🛡️";case"Enchantement":return"🧠";case"Illusion":return"🌟";case"Divination":return"👁️";case"Invocation":return"👹";case"Nécromancie":return"💀";case"Transmutation":return"🔄";default:return"✨"}},E=()=>{if(!d.canCast||f&&c.castableOutOfCombat!==!0||f&&c.castableOutOfCombat===!0&&new ls().isSpellActive(c.id,r))return!1;if(c.level===0)return!0;for(let J=c.level;J<=9;J++){const te=s[J];if(te&&te.available>0)return!0}return!1},D=()=>{if(c.level===0)return[];const J=[];for(let te=c.level;te<=9;te++){const K=s[te];K&&K.available>0&&J.push(te)}return J},M=(J=null)=>{m?.(c,J),A(!1)},B=()=>{const J=D();c.level===0||J.length<=1?M(J[0]||c.level):A(!0)},V=()=>i.jsx("div",{className:N,onClick:h,children:i.jsxs("div",{className:"spell-item__compact-content",children:[i.jsx("span",{className:"spell-item__icon",children:C()}),i.jsxs("div",{className:"spell-item__compact-info",children:[i.jsx("span",{className:"spell-item__name",children:c.name}),i.jsx("span",{className:"spell-item__level",children:c.level===0?"Cantrip":`Niv. ${c.level}`})]}),d.canCast&&E()&&i.jsx(se,{size:"small",variant:"primary",onClick:J=>{J.stopPropagation(),B()},children:"Lancer"})]})}),le=()=>i.jsx(xe,{className:N,onClick:h,children:i.jsxs("div",{className:"spell-item__grid-content",children:[i.jsxs("div",{className:"spell-item__header",children:[C(),c.name,i.jsxs("div",{className:"spell-item__title",children:[i.jsx("h4",{className:"spell-item__name",children:c.name}),i.jsxs("div",{className:"spell-item__meta",children:[i.jsx("span",{className:"spell-item__level",children:c.level===0?"Cantrip":`Niveau ${c.level}`}),i.jsx("span",{className:"spell-item__school",children:c.school})]})]})]}),i.jsx("div",{className:"spell-item__description",children:i.jsx("p",{children:c.description?.length>80?`${c.description.substring(0,80)}...`:c.description})}),i.jsxs("div",{className:"spell-item__properties",children:[c.castingTime&&i.jsxs("span",{className:"spell-property",children:["⏱️ ",c.castingTime]}),c.range&&i.jsxs("span",{className:"spell-property",children:["📏 ",c.range]}),c.duration&&i.jsxs("span",{className:"spell-property",children:["⏳ ",c.duration]})]}),i.jsx("div",{className:"spell-item__actions",children:ae()})]})}),I=()=>i.jsx("div",{className:N,onClick:h,children:i.jsxs("div",{className:"spell-item__list-content",children:[i.jsxs("div",{className:"spell-item__list-header",children:[C()," ",i.jsx("h4",{className:"spell-item__name",children:c.name}),i.jsx("span",{className:"spell-item__level",children:c.level===0?"Cantrip":`Niveau ${c.level}`}),i.jsx("span",{className:"spell-item__school",children:c.school}),i.jsxs("div",{className:"spell-item__list-properties",children:[c.castingTime&&i.jsxs("span",{children:["⏱️ ",c.castingTime]}),c.range&&i.jsxs("span",{children:["📏 ",c.range]}),c.duration&&i.jsxs("span",{children:["⏳ ",c.duration]}),c.components&&i.jsxs("span",{children:["🧪 ",c.components.join(", ")]})]})]}),i.jsx("div",{className:"spell-item__list-info",children:c.description&&i.jsx("p",{className:"spell-item__list-description",children:c.description})}),i.jsx("div",{className:"spell-item__list-actions",children:ae()})]})}),ae=()=>i.jsx("div",{className:"spell-item__action-buttons",children:x?i.jsxs("div",{className:"spell-casting-options",children:[i.jsx("span",{className:"casting-options-label",children:"Lancer au niveau:"}),i.jsx(pa,{children:D().map(J=>i.jsx(se,{size:"small",variant:"primary",onClick:te=>{te.stopPropagation(),M(J)},children:J},J))}),i.jsx(se,{size:"small",variant:"ghost",onClick:J=>{J.stopPropagation(),A(!1)},children:"Annuler"})]}):i.jsxs(i.Fragment,{children:[d.canCast&&E()&&i.jsx(se,{size:"small",variant:"primary",onClick:J=>{J.stopPropagation(),B()},children:"🔮 Lancer"}),d.canPrepare&&i.jsx(se,{size:"small",variant:"secondary",onClick:J=>{J.stopPropagation(),g?.(c)},children:"📋 Préparer"}),d.canUnprepare&&i.jsx(se,{size:"small",variant:"ghost",onClick:J=>{J.stopPropagation(),v?.(c)},children:"❌ Retirer"})]})});switch(u){case"compact":return V();case"grid":return le();case"list":default:return I()}},Lg=({spells:c=[],character:r,activeTab:s="prepared",spellSlots:u={},isOutOfCombat:d=!1,viewMode:f="list",onSpellClick:h,onCastSpell:m,onPrepareSpell:g,onUnprepareSpell:v,className:b=""})=>{const x=["spell-list",`spell-list--${f}`,`spell-list--${s}`,b].filter(Boolean).join(" "),A=c.reduce((D,M)=>{const B=M.level===0?"Cantrips":`Niveau ${M.level}`;return D[B]||(D[B]=[]),D[B].push(M),D},{}),N=Object.keys(A).sort((D,M)=>{if(D==="Cantrips")return-1;if(M==="Cantrips")return 1;const B=parseInt(D.replace("Niveau ","")),V=parseInt(M.replace("Niveau ",""));return B-V});if(c.length===0)return i.jsx("div",{className:"spell-list-empty",children:i.jsxs("div",{className:"spell-empty-state",children:[i.jsx("span",{className:"spell-empty-icon",children:"🔮"}),i.jsx("p",{children:"Aucun sort à afficher"})]})});const E=(()=>{switch(s){case"prepared":return{canCast:!0,canUnprepare:!0,canPrepare:!1};case"grimoire":case"unprepared":return{canCast:!1,canUnprepare:!1,canPrepare:!0};case"cantrips":return{canCast:!0,canUnprepare:!1,canPrepare:!1};default:return{canCast:!1,canUnprepare:!1,canPrepare:!1}}})();return i.jsx("div",{className:x,children:f==="compact"?i.jsx("div",{className:"spell-list__compact",children:c.map((D,M)=>i.jsx(vm,{spell:D,character:r,spellSlots:u,viewMode:"compact",actions:E,isOutOfCombat:d,onClick:()=>h?.(D),onCast:m,onPrepare:g,onUnprepare:v},D.id||M))}):i.jsx("div",{className:"spell-list__grouped",children:N.map(D=>i.jsxs("div",{className:"spell-level-group",children:[i.jsxs("h4",{className:"spell-level-group__title",children:[D,i.jsxs("span",{className:"spell-level-group__count",children:["(",A[D].length,")"]})]}),i.jsx("div",{className:`spell-level-group__content spell-level-group__content--${f}`,children:A[D].map((M,B)=>i.jsx(vm,{spell:M,character:r,spellSlots:u,viewMode:f,actions:E,isOutOfCombat:d,onClick:()=>h?.(M),onCast:m,onPrepare:g,onUnprepare:v},M.id||B))})]},D))})})},$g=({filters:c={},onFilterChange:r,activeTab:s="prepared",availableSpells:u=[],className:d=""})=>{const f=C=>{r?.({searchTerm:C.target.value})},h=C=>{r?.({school:C})},m=C=>{r?.({level:C})},g=()=>{r?.({castableOnly:!c.castableOnly})},v=()=>{r?.({school:"all",level:"all",searchTerm:"",castableOnly:!1})},b=[{value:"all",label:"Toutes les écoles",icon:"🎓"},{value:"Abjuration",label:"Abjuration",icon:"🛡️"},{value:"Invocation",label:"Invocation",icon:"👹"},{value:"Divination",label:"Divination",icon:"👁️"},{value:"Enchantement",label:"Enchantement",icon:"🧠"},{value:"Évocation",label:"Évocation",icon:"🔥"},{value:"Illusion",label:"Illusion",icon:"🌟"},{value:"Nécromancie",label:"Nécromancie",icon:"💀"},{value:"Transmutation",label:"Transmutation",icon:"🔄"}],x=[{value:"all",label:"Tous niveaux"},{value:"0",label:"Tours de magie"},{value:"1",label:"Niveau 1"},{value:"2",label:"Niveau 2"},{value:"3",label:"Niveau 3"},{value:"4",label:"Niveau 4"},{value:"5",label:"Niveau 5"},{value:"6",label:"Niveau 6"},{value:"7",label:"Niveau 7"},{value:"8",label:"Niveau 8"},{value:"9",label:"Niveau 9"}],A=Oe.useMemo(()=>{const C=new Set(["all"]);return u.forEach(E=>{E.school&&C.add(E.school)}),b.filter(E=>C.has(E.value))},[u]),N=Oe.useMemo(()=>{const C=new Set(["all"]);return u.forEach(E=>{C.add(E.level.toString())}),x.filter(E=>C.has(E.value))},[u]);return i.jsxs("div",{className:`spell-filters ${d}`,children:[i.jsx("div",{className:"spell-filters__search",children:i.jsxs("div",{className:"search-input-group",children:[i.jsx("span",{className:"search-icon",children:"🔍"}),i.jsx("input",{type:"text",placeholder:"Rechercher un sort...",value:c.searchTerm||"",onChange:f,className:"search-input"}),c.searchTerm&&i.jsx("button",{type:"button",className:"search-clear",onClick:()=>r?.({searchTerm:""}),children:"✕"})]})}),i.jsxs("div",{className:"spell-filters__controls",children:[i.jsxs("div",{className:"spell-filters__section",children:[i.jsx("h5",{className:"spell-filters__label",children:"École de magie"}),i.jsx("div",{className:"spell-filters__school-grid",children:A.map(C=>i.jsxs(se,{variant:c.school===C.value?"primary":"ghost",size:"small",onClick:()=>h(C.value),className:"school-filter-button",title:C.label,children:[i.jsx("span",{className:"button-icon",children:C.icon}),C.value==="all"?"Toutes":C.value]},C.value))})]}),i.jsxs("div",{className:"spell-filters__section",children:[i.jsx("h5",{className:"spell-filters__label",children:"Niveau de sort"}),i.jsx(pa,{className:"spell-filters__level-buttons",children:N.slice(0,6).map(C=>i.jsx(se,{variant:c.level===C.value?"primary":"ghost",size:"small",onClick:()=>m(C.value),children:C.value==="all"?"Tous":C.value==="0"?"CT":C.value},C.value))}),N.length>6&&i.jsx(pa,{className:"spell-filters__level-buttons spell-filters__level-buttons--high",children:N.slice(6).map(C=>i.jsx(se,{variant:c.level===C.value?"primary":"ghost",size:"small",onClick:()=>m(C.value),children:C.value},C.value))})]}),i.jsxs("div",{className:"spell-filters__section",children:[i.jsx("h5",{className:"spell-filters__label",children:"Options"}),i.jsx("div",{className:"spell-filters__options",children:s==="prepared"&&i.jsxs(se,{variant:c.castableOnly?"primary":"ghost",size:"small",onClick:g,children:[c.castableOnly?"✓":"○"," Lançables uniquement"]})})]}),i.jsx("div",{className:"spell-filters__actions",children:i.jsx(se,{variant:"ghost",size:"small",onClick:v,disabled:c.school==="all"&&c.level==="all"&&!c.searchTerm&&!c.castableOnly,children:"🗑️ Effacer"})})]})]})},Gg=({spell:c,character:r,spellSlots:s={},onClose:u,onCast:d,onPrepare:f,onUnprepare:h})=>{const[m,g]=ee.useState(null);if(!c)return null;const v=()=>{switch(c.school){case"Évocation":return"🔥";case"Abjuration":return"🛡️";case"Enchantement":return"🧠";case"Illusion":return"🌟";case"Divination":return"👁️";case"Invocation":return"👹";case"Nécromancie":return"💀";case"Transmutation":return"🔄";default:return"✨"}},b=()=>({0:"#9e9e9e",1:"#4caf50",2:"#2196f3",3:"#ff9800",4:"#9c27b0",5:"#f44336",6:"#795548",7:"#607d8b",8:"#e91e63",9:"#ffc107"})[c.level]||"#9e9e9e",x=()=>{if(c.level===0)return!0;for(let M=c.level;M<=9;M++){const B=s[M];if(B&&B.available>0)return!0}return!1},A=()=>{if(c.level===0)return[];const M=[];for(let B=c.level;B<=9;B++){const V=s[B];V&&V.available>0&&M.push(B)}return M},N=M=>{if(!c.upcast||M<=c.level)return null;const B=M-c.level;return c.upcast.replace(/\{level\}/g,B.toString())},C=()=>{const M=m||c.level;d?.(c,M>0?M:null),u()},E=A(),D=c.level===0;return i.jsx(su,{onClose:u,size:"large",children:i.jsxs(xe,{className:"spell-detail-modal",children:[i.jsx(Gt,{children:i.jsxs("div",{className:"spell-detail-header",children:[i.jsx("div",{className:"spell-detail-icon-container",children:i.jsx("span",{className:"spell-detail-icon",style:{color:b()},children:v()})}),i.jsxs("div",{className:"spell-detail-title",children:[i.jsx("h2",{className:"spell-detail-name",children:c.name}),i.jsxs("div",{className:"spell-detail-meta",children:[i.jsx("span",{className:"spell-detail-level",style:{color:b()},children:D?"Tour de magie":`Sort de niveau ${c.level}`}),i.jsx("span",{className:"spell-detail-school",children:c.school})]})]})]})}),i.jsxs(Qe,{children:[i.jsxs("div",{className:"spell-detail-section",children:[i.jsx("h4",{children:"Description"}),i.jsx("p",{className:"spell-detail-description",children:c.description})]}),i.jsxs("div",{className:"spell-detail-section",children:[i.jsx("h4",{children:"Lancement"}),i.jsxs("div",{className:"spell-detail-casting-properties",children:[i.jsxs("div",{className:"spell-casting-property",children:[i.jsx("span",{className:"property-icon",children:"⏱️"}),i.jsx("span",{className:"property-label",children:"Temps d'incantation:"}),i.jsx("span",{className:"property-value",children:c.castingTime||"Action"})]}),i.jsxs("div",{className:"spell-casting-property",children:[i.jsx("span",{className:"property-icon",children:"📏"}),i.jsx("span",{className:"property-label",children:"Portée:"}),i.jsx("span",{className:"property-value",children:c.range||"Personnel"})]}),i.jsxs("div",{className:"spell-casting-property",children:[i.jsx("span",{className:"property-icon",children:"🧪"}),i.jsx("span",{className:"property-label",children:"Composants:"}),i.jsx("span",{className:"property-value",children:c.components?c.components.join(", "):"Aucun"})]}),i.jsxs("div",{className:"spell-casting-property",children:[i.jsx("span",{className:"property-icon",children:"⏳"}),i.jsx("span",{className:"property-label",children:"Durée:"}),i.jsx("span",{className:"property-value",children:c.duration||"Instantané"})]}),c.concentration&&i.jsxs("div",{className:"spell-casting-property",children:[i.jsx("span",{className:"property-icon",children:"🧘"}),i.jsx("span",{className:"property-label",children:"Concentration:"}),i.jsx("span",{className:"property-value",children:"Oui"})]}),c.ritual&&i.jsxs("div",{className:"spell-casting-property",children:[i.jsx("span",{className:"property-icon",children:"🕯️"}),i.jsx("span",{className:"property-label",children:"Rituel:"}),i.jsx("span",{className:"property-value",children:"Oui"})]})]})]}),(c.damage||c.healing||c.effect)&&i.jsxs("div",{className:"spell-detail-section",children:[i.jsx("h4",{children:"Effets"}),i.jsxs("div",{className:"spell-detail-effects",children:[c.damage&&i.jsxs("div",{className:"spell-effect",children:[i.jsx("span",{className:"effect-icon",children:"⚔️"}),i.jsx("span",{className:"effect-label",children:"Dégâts:"}),i.jsx("span",{className:"effect-value",children:c.damage})]}),c.healing&&i.jsxs("div",{className:"spell-effect",children:[i.jsx("span",{className:"effect-icon",children:"💚"}),i.jsx("span",{className:"effect-label",children:"Soins:"}),i.jsx("span",{className:"effect-value",children:c.healing})]}),c.effect&&i.jsxs("div",{className:"spell-effect",children:[i.jsx("span",{className:"effect-icon",children:"✨"}),i.jsx("span",{className:"effect-label",children:"Effet:"}),i.jsx("span",{className:"effect-value",children:c.effect})]}),c.areaOfEffect&&i.jsxs("div",{className:"spell-effect",children:[i.jsx("span",{className:"effect-icon",children:"💥"}),i.jsx("span",{className:"effect-label",children:"Zone d'effet:"}),i.jsxs("span",{className:"effect-value",children:[c.areaOfEffect.shape," de ",c.areaOfEffect.radius||c.areaOfEffect.size,c.areaOfEffect.shape==="sphere"?" pieds de rayon":" pieds"]})]})]})]}),c.upcast&&!D&&i.jsxs("div",{className:"spell-detail-section",children:[i.jsx("h4",{children:"Aux niveaux supérieurs"}),i.jsx("p",{className:"spell-detail-upcast",children:c.upcast})]}),x()&&!D&&E.length>1&&i.jsxs("div",{className:"spell-detail-section",children:[i.jsx("h4",{children:"Niveau de lancement"}),i.jsxs("div",{className:"spell-casting-levels",children:[i.jsx(pa,{children:E.map(M=>i.jsxs(se,{variant:m===M?"primary":"secondary",size:"small",onClick:()=>g(M),children:["Niveau ",M,i.jsxs("span",{className:"level-slots",children:["(",s[M]?.available," empl.)"]})]},M))}),m&&m>c.level&&i.jsxs("div",{className:"upcast-preview",children:[i.jsxs("h5",{children:["Effet au niveau ",m,":"]}),i.jsx("p",{children:N(m)})]})]})]}),c.classes&&i.jsxs("div",{className:"spell-detail-section",children:[i.jsx("h4",{children:"Classes"}),i.jsx("div",{className:"spell-detail-classes",children:c.classes.map(M=>i.jsx("span",{className:"spell-class-tag",children:M},M))})]})]}),i.jsx(Ri,{children:i.jsxs("div",{className:"spell-detail-actions",children:[i.jsx(se,{variant:"ghost",onClick:u,children:"Fermer"}),x()&&i.jsxs(se,{variant:"primary",onClick:C,disabled:!D&&E.length===0,children:["🔮 Lancer",m?` (Niv. ${m})`:""]}),f&&i.jsx(se,{variant:"secondary",onClick:()=>{f(c),u()},children:"📋 Préparer"}),h&&i.jsx(se,{variant:"ghost",onClick:()=>{h(c),u()},children:"❌ Retirer"})]})})]})})},Pg=({className:c="",character:r,onCastSpell:s,isOutOfCombat:u=!1})=>{const{selectedCharacter:d,castSpell:f,prepareSpell:h,unprepareSpell:m}=$t(),g=r||d,{addCombatMessage:v}=ha(),b=ee.useMemo(()=>new ls,[]),[x,A]=ee.useState(null),[N,C]=ee.useState("prepared"),[E,D]=ee.useState({school:"all",level:"all",searchTerm:"",castableOnly:!1});if(!g?.spellcasting)return i.jsx(xe,{className:`spell-panel ${c}`,children:i.jsx(Qe,{children:i.jsxs("div",{className:"spell-panel__no-spells",children:[i.jsx("span",{className:"no-spells-icon",children:"🚫"}),i.jsx("p",{children:"Ce personnage ne peut pas lancer de sorts"})]})})});const M=ee.useMemo(()=>{const me=g.spellcasting.ability||"intelligence",ie=b.getSpellAttackBonus(g),Ee=b.getSpellSaveDC(g);let Le=b.getPreparedSpells(g),w=b.getGrimoireSpells(g),$=b.getUnpreparedSpells(g),j=b.getCantrips(g);(u||s)&&(Le=Le.filter(Q=>Q.castableOutOfCombat===!0?!b.isSpellActive(Q.id,g):!0),j=j.filter(Q=>Q.castableOutOfCombat===!0));const L=b.getMaxPreparedSpells(g),X=b.getSpellSlots(g);return{spellcastingAbility:me,spellAttackBonus:ie,spellSaveDC:Ee,grimoireSpells:w,preparedSpells:Le,unpreparedSpells:$,cantrips:j,maxPrepared:L,spellSlots:X}},[g,b]),B=ee.useMemo(()=>{let K=[];switch(N){case"prepared":K=M.preparedSpells;break;case"grimoire":K=M.unpreparedSpells;break;case"cantrips":K=M.cantrips;break;default:K=[]}return b.filterSpells(K,E)},[M,N,E,b]),V=async(K,me=null)=>{try{if(s){s(K,me);return}const ie=await f(K.id,me);ie.success?v(`${K.name} lancé avec succès !`,"spell-cast"):v(ie.message,"error")}catch(ie){console.error("Erreur lors du lancement du sort:",ie),v(`Impossible de lancer ${K.name}: ${ie.message}`,"error")}},le=async K=>{try{const me=await h(K.id);me.success?v(`${K.name} préparé`,"spell-prepare"):v(me.message,"error")}catch(me){console.error("Erreur lors de la préparation:",me),v(`Impossible de préparer ${K.name}`,"error")}},I=async K=>{try{const me=await m(K.id);me.success?v(`${K.name} retiré des sorts préparés`,"spell-unprepare"):v(me.message,"error")}catch(me){console.error("Erreur lors de la suppression:",me)}},ae=K=>{C(K)},J=K=>{D({...E,...K})},te={prepared:M.preparedSpells.length,grimoire:M.unpreparedSpells.length,cantrips:M.cantrips.length};return i.jsxs(xe,{className:`spell-panel ${c}`,children:[i.jsx(Gt,{children:i.jsxs("div",{className:"spell-panel__header",children:[i.jsxs("h3",{children:["🔮 Sorts de ",g.name]}),i.jsxs("div",{className:"spell-panel__stats",children:[i.jsxs("div",{className:"spell-stat",children:[i.jsx("span",{className:"spell-stat__label",children:"Bonus d'attaque:"}),i.jsxs("span",{className:"spell-stat__value",children:["+",M.spellAttackBonus]})]}),i.jsxs("div",{className:"spell-stat",children:[i.jsx("span",{className:"spell-stat__label",children:"DD de sauvegarde:"}),i.jsx("span",{className:"spell-stat__value",children:M.spellSaveDC})]}),i.jsxs("div",{className:"spell-stat",children:[i.jsx("span",{className:"spell-stat__label",children:"Sorts préparés:"}),i.jsxs("span",{className:"spell-stat__value",children:[M.preparedSpells.length,"/",M.maxPrepared]})]})]})]})}),i.jsxs(Qe,{children:[i.jsx(wg,{spellSlots:M.spellSlots,onSlotUse:K=>{}}),i.jsxs("div",{className:"spell-panel__tabs",children:[i.jsxs(se,{variant:N==="prepared"?"primary":"ghost",onClick:()=>ae("prepared"),children:["📋 Préparés (",te.prepared,")"]}),i.jsxs(se,{variant:N==="grimoire"?"primary":"ghost",onClick:()=>ae("grimoire"),children:["📜 Grimoire (",te.grimoire,")"]})]}),i.jsx($g,{filters:E,onFilterChange:J,activeTab:N,availableSpells:(()=>{switch(N){case"prepared":return M.preparedSpells;case"grimoire":return M.unpreparedSpells;case"cantrips":return M.cantrips;default:return[]}})()}),i.jsx(Lg,{spells:B,character:g,activeTab:N,spellSlots:M.spellSlots,isOutOfCombat:u||!!s,onSpellClick:A,onCastSpell:V,onPrepareSpell:le,onUnprepareSpell:I}),B.length===0&&i.jsx("div",{className:"spell-panel__empty",children:N==="prepared"&&M.preparedSpells.length===0?i.jsx("p",{children:"🔮 Aucun sort préparé. Préparez des sorts depuis votre grimoire."}):N==="grimoire"&&M.grimoireSpells.length===0?i.jsx("p",{children:"📜 Aucun sort disponible dans le grimoire. Montez de niveau pour débloquer plus de sorts."}):N==="cantrips"&&M.cantrips.length===0?i.jsx("p",{children:"✨ Aucun tour de magie connu."}):i.jsx("p",{children:"🔍 Aucun sort ne correspond aux filtres appliqués."})})]}),x&&i.jsx(Gg,{spell:x,character:g,spellSlots:M.spellSlots,onClose:()=>A(null),onCast:V,onPrepare:le,onUnprepare:I})]})};class Yg{canTakeShortRest(r){return!0}canTakeLongRest(r){return!0}getShortRestBenefits(r){const s={hitDiceRecovery:!1,spellSlotRecovery:[],classFeatureRecovery:[],description:[]};if(r.hitDice>0&&r.currentHP<r.maxHP&&(s.hitDiceRecovery=!0,s.description.push("Possibilité de dépenser des dés de vie pour récupérer des PV")),r.class==="Magicien"&&r.level>=1){const u=r.level,d=Math.ceil(u/2);s.spellSlotRecovery.push({level:d,amount:1,source:"Récupération arcanique"}),s.description.push(`Récupération d'un emplacement de sort de niveau ${d} ou moins`)}return r.class==="Guerrier"&&r.level>=3&&(s.classFeatureRecovery.push("Action Surge"),s.description.push("Récupération de l'Action Surge")),r.class==="Roublard"&&r.level>=3&&(s.classFeatureRecovery.push("Cunning Action uses"),s.description.push("Récupération des utilisations d'actions spéciales")),s}getLongRestBenefits(r){const s={fullHPRecovery:!0,hitDiceRecovery:Math.max(1,Math.floor(r.level/2)),allSpellSlotsRecovery:!0,allClassFeaturesRecovery:!0,description:[]};return s.description.push("Récupération complète des points de vie"),s.description.push(`Récupération de ${s.hitDiceRecovery} dé${s.hitDiceRecovery>1?"s":""} de vie`),r.spellcasting&&s.description.push("Récupération de tous les emplacements de sorts"),s.description.push("Récupération de toutes les capacités de classe"),s}calculateHitDieHealing(r){const s=r.hitDiceType||8,u=ze(r.stats.constitution),d=Math.floor(Math.random()*s)+1,f=d+u;return{roll:d,modifier:u,total:Math.max(1,f)}}applyShortRest(r){const s={...r},u={success:!0,message:"Repos court terminé",changes:[]};if(r.class==="Magicien"&&r.level>=1){const d=r.level,f=Math.ceil(d/2);if(s.spellcasting?.spellSlots)for(let h=f;h>=1;h--){const m=s.spellcasting.spellSlots[h];if(m&&m.used>0){m.used=Math.max(0,m.used-1),m.available=m.max-m.used,u.changes.push(`Récupération d'un emplacement de sort de niveau ${h}`);break}}}if(r.class==="Ensorceleur"&&r.sorceryPoints){const d=r.level;s.sorceryPoints.current=d,u.changes.push("Récupération des points de sorcellerie")}return r.class==="Guerrier"&&r.level>=2&&s.classFeatures?.actionSurge&&(s.classFeatures.actionSurge.used=0,u.changes.push("Récupération de l'Action Surge")),{character:s,results:u}}applyLongRest(r){const s={...r},u={success:!0,message:"Repos long terminé",changes:[]},d=r.maxHP-r.currentHP;s.currentHP=r.maxHP,d>0&&u.changes.push(`${d} points de vie récupérés`);const f=Math.max(1,Math.floor(r.level/2)),h=r.level,m=r.hitDice||0,g=Math.min(h,m+f);if(g>m&&(s.hitDice=g,u.changes.push(`${g-m} dé${g-m>1?"s":""} de vie récupéré${g-m>1?"s":""}`)),s.spellcasting?.spellSlots){let v=0;Object.values(s.spellcasting.spellSlots).forEach(b=>{b.used>0&&(v+=b.used,b.used=0,b.available=b.max)}),v>0&&u.changes.push("Tous les emplacements de sorts récupérés")}return s.classFeatures&&(Object.values(s.classFeatures).forEach(v=>{v.used!==void 0&&(v.used=0)}),u.changes.push("Toutes les capacités de classe récupérées")),r.class==="Moine"&&s.ki&&(s.ki.current=s.ki.max,u.changes.push("Points de ki récupérés")),r.class==="Ensorceleur"&&s.sorceryPoints&&(s.sorceryPoints.current=s.sorceryPoints.max,u.changes.push("Points de sorcellerie récupérés")),s.activeSpells&&(Object.keys(s.activeSpells).forEach(v=>{delete s.activeSpells[v]}),u.changes.push("Sorts temporaires dissipés")),{character:s,results:u}}hasUsedSpellSlots(r){return r.spellcasting?.spellSlots?Object.values(r.spellcasting.spellSlots).some(s=>s.used>0):!1}getRestDuration(r){switch(r){case"short":return{duration:1,unit:"heure",description:"Au moins 1 heure de repos léger"};case"long":return{duration:8,unit:"heures",description:"Au moins 8 heures de sommeil ou de repos"};default:return null}}canInterruptRest(r,s){return r==="short"||r==="long"?s<60:!1}calculateInterruptionPenalties(r,s){const u={lostProgress:!1,reducedBenefits:!1,description:[]};return r==="short"&&(u.lostProgress=!0,u.description.push("Le repos court doit être recommencé")),r==="long"&&s<480&&(u.reducedBenefits=!0,u.description.push("Bénéfices du repos long perdus")),u}}const Xg=({character:c,restData:r,onSpendHitDie:s,onCompleteRest:u,onCancelRest:d,className:f=""})=>{const h=()=>r.hitDiceAvailable>0&&r.currentHP<r.maxHP,m=async()=>{if(h())try{await s()}catch(v){console.error("Erreur lors de la dépense du dé de vie:",v)}},g=r.currentHP>=r.maxHP;return i.jsx(xe,{className:`short-rest-manager ${f}`,children:i.jsx(Qe,{children:i.jsxs("div",{className:"short-rest-manager__content",children:[i.jsxs("div",{className:"short-rest-manager__header",children:[i.jsx("h4",{children:"🌅 Repos court en cours"}),i.jsx("p",{className:"rest-description",children:"Prenez une heure pour vous reposer et récupérer des forces. Vous pouvez dépenser des dés de vie pour récupérer des points de vie."})]}),i.jsx("div",{className:"short-rest-manager__status",children:i.jsxs("div",{className:"rest-status-grid",children:[i.jsxs("div",{className:"rest-status-item",children:[i.jsx("span",{className:"rest-status-label",children:"Points de vie"}),i.jsxs("span",{className:"rest-status-value",children:[r.currentHP,"/",r.maxHP]})]}),i.jsxs("div",{className:"rest-status-item",children:[i.jsx("span",{className:"rest-status-label",children:"Dés de vie restants"}),i.jsxs("span",{className:"rest-status-value",children:[r.hitDiceAvailable," (d",r.hitDiceType,")"]})]})]})}),i.jsxs("div",{className:"short-rest-manager__health-bar",children:[i.jsx("div",{className:"health-bar-container",children:i.jsx("div",{className:"health-bar-fill",style:{width:`${r.currentHP/r.maxHP*100}%`}})}),i.jsxs("span",{className:"health-bar-label",children:["PV : ",r.currentHP,"/",r.maxHP]})]}),i.jsxs("div",{className:"short-rest-manager__hit-dice",children:[i.jsx("h5",{children:"Dés de vie"}),i.jsxs("p",{className:"hit-dice-description",children:["Lancez un dé de vie (d",r.hitDiceType,") et ajoutez votre modificateur de Constitution (+",Math.floor((c.stats.constitution-10)/2),") pour récupérer des points de vie."]}),i.jsxs("div",{className:"hit-dice-controls",children:[i.jsxs(se,{variant:"secondary",disabled:!h(),onClick:m,children:["🎲 Dépenser un dé de vie",!h()&&i.jsx("span",{className:"button-disabled-reason",children:r.hitDiceAvailable===0?" (aucun restant)":" (PV au maximum)"})]}),i.jsx("div",{className:"hit-dice-info",children:i.jsxs("span",{children:["Dés restants : ",r.hitDiceAvailable]})})]})]}),i.jsxs("div",{className:"short-rest-manager__benefits",children:[i.jsx("h5",{children:"Autres bénéfices du repos court"}),i.jsxs("ul",{className:"rest-benefits-list",children:[c.class==="Magicien"&&c.level>=1&&i.jsx("li",{children:"✨ Récupération arcanique disponible"}),c.class==="Guerrier"&&c.level>=2&&i.jsx("li",{children:"⚔️ Action Surge récupérée"}),c.class==="Ensorceleur"&&i.jsx("li",{children:"🔮 Points de sorcellerie récupérés"}),i.jsx("li",{children:"🧘 Récupération mentale et physique"})]})]}),g&&i.jsxs("div",{className:"rest-message rest-message--success",children:[i.jsx("span",{className:"rest-message-icon",children:"✅"}),i.jsx("span",{children:"Vous êtes à pleine santé ! Vous pouvez terminer le repos."})]}),!g&&r.hitDiceAvailable>0&&i.jsxs("div",{className:"rest-message rest-message--info",children:[i.jsx("span",{className:"rest-message-icon",children:"💡"}),i.jsx("span",{children:"Vous pouvez dépenser d'autres dés de vie ou terminer le repos maintenant."})]}),i.jsx("div",{className:"short-rest-manager__actions",children:i.jsxs(pa,{children:[i.jsx(se,{variant:"primary",onClick:u,children:"✅ Terminer le repos"}),i.jsx(se,{variant:"ghost",onClick:d,children:"❌ Annuler le repos"})]})})]})})})},Vg=({character:c,restData:r,onCompleteRest:s,onCancelRest:u,className:d=""})=>{const[f,h]=ee.useState(0),[m,g]=ee.useState(!1);ee.useEffect(()=>{const C=setInterval(()=>{h(E=>{const D=E+30;return D>=480?(g(!0),clearInterval(C),480):D})},1e3);return()=>clearInterval(C)},[]);const b=(()=>{const C=[],E=r.maxHP-r.currentHP;E>0&&C.push({icon:"❤️",text:`+${E} points de vie (récupération complète)`});const D=Math.max(1,Math.floor(c.level/2)),M=c.level,B=r.hitDiceAvailable,V=Math.min(D,M-B);return V>0&&C.push({icon:"🎲",text:`+${V} dé${V>1?"s":""} de vie`}),c.spellcasting?.spellSlots&&Object.values(c.spellcasting.spellSlots).reduce((I,ae)=>I+(ae.used||0),0)>0&&C.push({icon:"🔮",text:"Tous les emplacements de sorts récupérés"}),C.push({icon:"⚡",text:"Toutes les capacités de classe récupérées"}),c.class==="Magicien"&&C.push({icon:"📚",text:"Possibilité de changer les sorts préparés"}),c.class==="Ensorceleur"&&C.push({icon:"✨",text:"Points de sorcellerie récupérés"}),c.class==="Moine"&&C.push({icon:"🧘",text:"Points de ki récupérés"}),C})(),x=f/480*100,A=Math.floor(f/60),N=f%60;return i.jsx(xe,{className:`long-rest-manager ${d}`,children:i.jsx(Qe,{children:i.jsxs("div",{className:"long-rest-manager__content",children:[i.jsxs("div",{className:"long-rest-manager__header",children:[i.jsx("h4",{children:"🌙 Repos long en cours"}),i.jsx("p",{className:"rest-description",children:"Prenez 8 heures pour dormir ou vous reposer paisiblement. Toutes vos capacités seront restaurées."})]}),i.jsxs("div",{className:"long-rest-manager__progress",children:[i.jsxs("div",{className:"rest-progress-header",children:[i.jsx("h5",{children:"Progression du repos"}),i.jsxs("span",{className:"rest-time",children:[A,"h ",N,"min / 8h 00min"]})]}),i.jsx("div",{className:"rest-progress-bar",children:i.jsx("div",{className:"rest-progress-fill",style:{width:`${x}%`}})}),i.jsx("div",{className:"rest-progress-status",children:m?i.jsx("span",{className:"rest-status-complete",children:"✅ Repos terminé ! Vous vous sentez complètement reposé."}):i.jsxs("span",{className:"rest-status-resting",children:["😴 Repos en cours... (",Math.floor(100-x),"% restant)"]})})]}),i.jsxs("div",{className:"long-rest-manager__benefits",children:[i.jsx("h5",{children:"Bénéfices du repos long"}),i.jsx("div",{className:"rest-benefits-grid",children:b.map((C,E)=>i.jsxs("div",{className:`rest-benefit-item ${m?"rest-benefit-item--available":""}`,children:[i.jsx("span",{className:"rest-benefit-icon",children:C.icon}),i.jsx("span",{className:"rest-benefit-text",children:C.text}),m&&i.jsx("span",{className:"rest-benefit-check",children:"✓"})]},E))})]}),i.jsx("div",{className:"long-rest-manager__health-comparison",children:i.jsxs("div",{className:"health-comparison-grid",children:[i.jsxs("div",{className:"health-comparison-item",children:[i.jsx("h6",{children:"État actuel"}),i.jsxs("div",{className:"health-stats",children:[i.jsxs("span",{className:"health-stat",children:["❤️ PV: ",r.currentHP,"/",r.maxHP]}),i.jsxs("span",{className:"health-stat",children:["🎲 Dés: ",r.hitDiceAvailable]})]})]}),i.jsx("div",{className:"health-comparison-arrow",children:"→"}),i.jsxs("div",{className:"health-comparison-item",children:[i.jsx("h6",{children:"Après le repos"}),i.jsxs("div",{className:"health-stats",children:[i.jsxs("span",{className:"health-stat health-stat--improved",children:["❤️ PV: ",r.maxHP,"/",r.maxHP]}),i.jsxs("span",{className:"health-stat health-stat--improved",children:["🎲 Dés: ",Math.min(c.level,r.hitDiceAvailable+Math.max(1,Math.floor(c.level/2)))]})]})]})]})}),!m&&i.jsx("div",{className:"long-rest-manager__info",children:i.jsxs("div",{className:"rest-info-box",children:[i.jsx("h6",{children:"💡 Pendant votre repos"}),i.jsxs("ul",{className:"rest-info-list",children:[i.jsx("li",{children:"Votre corps et votre esprit récupèrent naturellement"}),i.jsx("li",{children:"Les blessures guérissent complètement"}),i.jsx("li",{children:"Votre énergie magique se régénère"}),i.jsx("li",{children:"Vos capacités spéciales retrouvent leur pleine puissance"})]})]})}),i.jsxs("div",{className:"long-rest-manager__warnings",children:[i.jsxs("div",{className:"rest-warning",children:[i.jsx("span",{className:"rest-warning-icon",children:"⚠️"}),i.jsx("span",{className:"rest-warning-text",children:"Vous ne pouvez bénéficier que d'un repos long par période de 24 heures."})]}),!m&&i.jsxs("div",{className:"rest-warning",children:[i.jsx("span",{className:"rest-warning-icon",children:"⏰"}),i.jsx("span",{className:"rest-warning-text",children:"Annuler maintenant vous fera perdre les bénéfices du repos long."})]})]}),i.jsx("div",{className:"long-rest-manager__actions",children:i.jsxs(pa,{children:[i.jsx(se,{variant:"primary",disabled:!m,onClick:s,children:m?"✅ Terminer le repos":`⏳ Repos en cours... ${Math.floor(100-x)}%`}),i.jsx(se,{variant:"ghost",onClick:u,children:"❌ Annuler le repos"})]})})]})})})},kg=({character:c,restData:r,onSelect:s,className:u=""})=>{const d=(m,g,v,b,x,A=!0)=>i.jsxs(xe,{className:`rest-option ${A?"":"rest-option--disabled"}`,children:[i.jsxs("div",{className:"rest-option__header",children:[i.jsx("span",{className:"rest-option__icon",children:v}),i.jsx("h4",{className:"rest-option__title",children:g}),i.jsx("span",{className:"rest-option__duration",children:b})]}),i.jsxs("div",{className:"rest-option__benefits",children:[i.jsx("h5",{children:"Bénéfices :"}),i.jsx("ul",{className:"rest-benefits-list",children:x.map((N,C)=>i.jsx("li",{className:"rest-benefit",children:N},C))})]}),i.jsx("div",{className:"rest-option__actions",children:i.jsx(se,{variant:"primary",disabled:!A,onClick:()=>s(m),children:A?`Commencer le ${g.toLowerCase()}`:"Indisponible"})})]},m),f=[];if(r.hitDiceAvailable>0&&r.currentHP<r.maxHP&&f.push(`Dépenser jusqu'à ${r.hitDiceAvailable} dé${r.hitDiceAvailable>1?"s":""} de vie pour récupérer des PV`),c.class==="Magicien"&&c.level>=1){const m=Math.ceil(c.level/2);f.push(`Récupération arcanique (1 emplacement ≤ niv. ${m})`)}c.class==="Guerrier"&&c.level>=2&&f.push("Récupération de l'Action Surge"),c.class==="Ensorceleur"&&f.push("Récupération des points de sorcellerie"),f.length===0&&f.push("Moment de récupération et de planification");const h=["Récupération complète des points de vie",`Récupération de ${Math.max(1,Math.floor(c.level/2))} dé${Math.floor(c.level/2)>1?"s":""} de vie`];return c.spellcasting&&h.push("Récupération de tous les emplacements de sorts"),h.push("Récupération de toutes les capacités de classe"),c.class==="Magicien"&&h.push("Préparation de nouveaux sorts"),i.jsxs("div",{className:`rest-type-selector ${u}`,children:[i.jsx("div",{className:"rest-type-selector__intro",children:i.jsx("p",{children:"Choisissez le type de repos que vous souhaitez prendre. Un repos permet de récupérer des forces et des capacités."})}),i.jsxs("div",{className:"rest-options",children:[d("short","Repos court","🌅","1 heure",f,r.canTakeShortRest),d("long","Repos long","🌙","8 heures",h,r.canTakeLongRest)]}),i.jsxs("div",{className:"rest-type-selector__info",children:[i.jsxs("div",{className:"rest-info-section",children:[i.jsx("h5",{children:"État actuel :"}),i.jsxs("ul",{children:[i.jsxs("li",{children:["Points de vie : ",r.currentHP,"/",r.maxHP,r.currentHP<r.maxHP&&i.jsx("span",{className:"rest-info-highlight",children:" (récupération nécessaire)"})]}),i.jsxs("li",{children:["Dés de vie : ",r.hitDiceAvailable," disponible",r.hitDiceAvailable>1?"s":"","(d",r.hitDiceType,")"]}),c.spellcasting&&i.jsxs("li",{children:["Emplacements de sorts :",Object.entries(c.spellcasting.spellSlots||{}).some(([,m])=>m.used>0)?" certains utilisés":" tous disponibles"]})]})]}),i.jsxs("div",{className:"rest-info-section",children:[i.jsx("h5",{children:"Conseils :"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Les repos courts sont idéaux pour une récupération rapide entre les combats"}),i.jsx("li",{children:"Les repos longs restaurent toutes vos capacités mais prennent plus de temps"}),i.jsx("li",{children:"Vous ne pouvez bénéficier que d'un repos long par période de 24 heures"})]})]})]})]})},gm=({type:c,character:r,onRestComplete:s,className:u=""})=>{const{playerCharacter:d,shortRestPlayer:f,longRestPlayer:h,spendHitDie:m}=$t(),g=r||d,{addCombatMessage:v,gamePhase:b,setGamePhase:x}=ha(),A=ee.useMemo(()=>new Yg,[]),[N,C]=ee.useState(c||null),[E,D]=ee.useState(!1);if(!g)return i.jsx(xe,{className:`rest-panel ${u}`,children:i.jsx(Qe,{children:i.jsxs("div",{className:"rest-panel__no-character",children:[i.jsx("span",{className:"no-character-icon",children:"😴"}),i.jsx("p",{children:"Aucun personnage sélectionné pour se reposer"})]})})});const M=ee.useMemo(()=>({canTakeShortRest:A.canTakeShortRest(g),canTakeLongRest:A.canTakeLongRest(g),shortRestBenefits:A.getShortRestBenefits(g),longRestBenefits:A.getLongRestBenefits(g),hitDiceAvailable:g.hitDice||0,hitDiceType:g.hitDiceType||8,currentHP:g.currentHP||0,maxHP:g.maxHP||0,needsRest:g.currentHP<g.maxHP||g.spellcasting&&A.hasUsedSpellSlots(g)}),[g,A]),B=J=>{C(J)},V=()=>{try{f(),v("Repos court terminé !","rest-complete"),D(!1),C(null),s?.("short")}catch(J){console.error("Erreur lors du repos court:",J),v("Erreur lors du repos court","error")}},le=()=>{try{h(),v("Repos long terminé ! Tous vos points de vie et emplacements de sorts ont été restaurés.","rest-complete"),D(!1),C(null),s?.("long")}catch(J){console.error("Erreur lors du repos long:",J),v("Erreur lors du repos long","error")}},I=()=>{try{m("player"),v("Dé de vie dépensé !","healing")}catch(J){console.error("Erreur lors de la dépense du dé de vie:",J),v("Impossible de dépenser le dé de vie","error")}},ae=()=>{D(!1),C(null),x("normal"),v("Repos annulé","rest-cancel")};return!N&&!E?i.jsxs(xe,{className:`rest-panel ${u}`,children:[i.jsxs(Gt,{children:[i.jsxs("h3",{children:["😴 Repos pour ",g.name]}),i.jsxs("div",{className:"rest-panel__status",children:[i.jsxs("div",{className:"rest-status-item",children:[i.jsx("span",{className:"rest-status-label",children:"Points de vie:"}),i.jsxs("span",{className:`rest-status-value ${M.currentHP<M.maxHP?"rest-status-value--low":""}`,children:[M.currentHP,"/",M.maxHP]})]}),i.jsxs("div",{className:"rest-status-item",children:[i.jsx("span",{className:"rest-status-label",children:"Dés de vie:"}),i.jsxs("span",{className:"rest-status-value",children:[M.hitDiceAvailable," disponible",M.hitDiceAvailable>1?"s":""]})]}),M.needsRest&&i.jsxs("div",{className:"rest-need-indicator",children:[i.jsx("span",{className:"rest-need-icon",children:"⚠️"}),i.jsx("span",{children:"Repos recommandé"})]})]})]}),i.jsx(Qe,{children:i.jsx(kg,{character:g,restData:M,onSelect:B})})]}):i.jsxs(xe,{className:`rest-panel ${u}`,children:[i.jsx(Gt,{children:i.jsxs("h3",{children:["😴 ",N==="short"?"Repos court":"Repos long"," en cours"]})}),i.jsx(Qe,{children:N==="short"?i.jsx(Xg,{character:g,restData:M,onSpendHitDie:I,onCompleteRest:V,onCancelRest:ae}):i.jsx(Vg,{character:g,restData:M,onCompleteRest:le,onCancelRest:ae})})]})},Qg=(c,r=20)=>{const[s,u]=ee.useState(""),[d,f]=ee.useState(!0),h=ee.useRef(0),m=ee.useRef(null),g=ee.useCallback(()=>{m.current&&(clearInterval(m.current),m.current=null),u(c),f(!1)},[c]);return ee.useEffect(()=>(u(""),h.current=0,f(!0),m.current&&clearInterval(m.current),m.current=setInterval(()=>{u(v=>{if(h.current>=c.length)return clearInterval(m.current),m.current=null,f(!1),v;const b=c.charAt(h.current);return h.current+=1,v+b})},r),()=>{m.current&&(clearInterval(m.current),m.current=null)}),[c,r]),{displayedText:s,isTyping:d,skipTyping:g}},Zg=Oe.memo(({choice:c,onChoice:r})=>{const s=ee.useCallback(()=>{const u=c.next||c.action;r(u)},[c,r]);return i.jsx("button",{onClick:s,children:c.text})}),Kg=({text:c,choices:r=[],onChoice:s})=>{const{displayedText:u,isTyping:d,skipTyping:f}=Qg(c),h=ee.useCallback(()=>{d&&f()},[d,f]),m=r.map((g,v)=>i.jsx(Zg,{choice:g,onChoice:s},`${v}-${g.text}`));return i.jsxs("div",{className:"scene scene-container",children:[i.jsx("div",{className:"scene-text",onClick:h,role:"button",tabIndex:0,onKeyDown:g=>g.key==="Enter"&&h(),children:u}),i.jsx("div",{className:"scene-choices",children:m})]})},Jg=Oe.memo(Kg),ym=(c,r)=>{if(typeof c=="string")return c;if(typeof c=="object")switch(c.type){case"combat":return{...c,enemies:c.enemies,enemyPositions:c.enemyPositions,next:c.next};case"longRest":return r.startLongRest(c.nextScene),null;case"shortRest":return r.startShortRest(c.nextScene),null;case"item":return r.handleItemGain(c.item),c.nextScene;case"ally":const s=Sm[c.ally];if(s){const d={...s,id:c.ally.toLowerCase()};if(r.addCompanion){r.addCompanion(d);const h=[...$t.getState().activeCompanions,d.id];r.setActiveCompanions(h)}return r.setPlayerCompanion&&!$t.getState().playerCompanion&&r.setPlayerCompanion(s),r.addCombatMessage(`${s.name} te rejoint dans ton aventure !`,"upgrade"),console.log(`✅ RECRUIT: ${s.name} (${s.role}) avec ID=${d.id}`),c.nextScene}else return console.error(`Compagnon '${c.ally}' introuvable.`),null;case"skillCheck":const u=$t.getState().playerCharacter;return u?(r.handleSkillCheck(c.skill,c.dc,c.onSuccess,c.onPartialSuccess,c.onFailure,u),null):(console.error("Aucun personnage joueur trouvé pour le test de compétence"),null);default:return console.warn("Type d'action inconnu :",c.type),null}return null};function bm({error:c,resetErrorBoundary:r}){return i.jsxs("div",{className:"error-boundary",children:[i.jsx("h2",{children:"Quelque chose s'est mal passé :"}),i.jsx("pre",{children:c.message}),i.jsx("button",{onClick:r,children:"Réessayer"})]})}function Ig(){const{gamePhase:c,currentScene:r,combatLog:s,isShortResting:u,isLongResting:d,nextSceneAfterRest:f,combatKey:h,setGamePhase:m,setCurrentScene:g,addCombatMessage:v,handleSkillCheck:b,startShortRest:x,startLongRest:A,endShortRest:N,endLongRest:C}=ha(),{playerCharacter:E,playerCompanion:D,playerCompanions:M,activeCompanions:B,setPlayerCharacter:V,setPlayerCompanion:le,addCompanion:I,setActiveCompanions:ae,getActiveCompanions:J,takeDamagePlayer:te,takeDamageCompanion:K,addItemToInventory:me,useItem:ie,castSpellPlayer:Ee,shortRestPlayer:Le,longRestPlayer:w,longRestAll:$,addExperience:j}=$t(),{isActive:L,initializeCombat:X,resetCombat:Q,incrementCombatKey:S}=Wt(),{showError:U}=Xe(),k=nt=>{V(nt),m("game")},Z=()=>{const{totalXpGained:nt,combatEnemies:yt}=Wt.getState(),Se=nt||yt.reduce((Tt,ss)=>Tt+(ss.xp||0),0);Se>0&&(j(Se,"player"),v(`Vous gagnez ${Se} points d'expérience !`,"victory"),D&&(j(Se,"companion"),v(`${D.name} gagne aussi ${Se} points d'expérience !`,"victory")));const ct=r.next;if(Q(),v("Combat terminé ! Victoire !","victory"),ct){const Tt=ym(ct,{startLongRest:A,startShortRest:x,handleItemGain:F,setPlayerCompanion:le,addCompanion:I,setActiveCompanions:ae,addCombatMessage:v,handleSkillCheck:b});Tt&&g(Tt)}else console.warn("Aucune scène suivante n'est définie après le combat."),g("fin_du_jeu")},F=nt=>{(Array.isArray(nt)?nt:[nt]).forEach(Se=>{let ct=es[Se];if(ct||(ct=cn[Se]),ct){const Tt={...ct,id:Se};me(Tt),v(`Objet obtenu : ${ct.name}`,"item")}else console.error(`❌ Item non trouvé dans items.js ou weapons.js : ${Se}`)})},fe=()=>{Le(),N()},ce=()=>{$(),C(),v("Repos long terminé - PV et sorts restaurés","rest")},Ze=(nt,yt=null)=>{try{Ee(nt,yt?{spellLevel:yt}:{}),v(`Sort lancé : ${nt.name}`,"spell")}catch(Se){console.error("Erreur lors du lancement du sort:",Se),U(`Impossible de lancer le sort : ${Se.message}`)}};if(c==="character-selection")return i.jsx(rm,{FallbackComponent:bm,children:i.jsx(Ng,{onCharacterSelect:k})});if(!E)return i.jsx("div",{className:"game-container",children:i.jsx("div",{className:"main-content",children:i.jsx("p",{children:"Chargement de ton personnage..."})})});const _e=typeof r=="object"&&r.type==="combat",Vt=`game-container ${_e?"combat-mode":""}`,In=`main-content ${_e?"combat-mode":""}`,rn=`sidebar ${_e?"combat-mode":""}`,Wn=()=>{if(d)return i.jsxs("div",{className:"long-rest-panel",children:[i.jsx(gm,{type:"long",character:E,onRestComplete:ce}),i.jsx(as,{title:"Journal",compact:!0})]});if(u)return i.jsxs("div",{className:"short-rest-panel",children:[i.jsx(gm,{type:"short",character:E,onRestComplete:fe}),i.jsx(as,{title:"Journal",compact:!0})]});if(typeof r=="object"&&r.type==="combat")return i.jsx(Dg,{playerCharacter:E,playerCompanion:D,activeCompanions:J(),encounterData:r,onCombatEnd:Z,onReplayCombat:()=>{E&&V({...E,currentHP:E.maxHP}),D&&le({...D,currentHP:D.maxHP}),Q(),S(),v("🔄 Combat réinitialisé !","info"),setTimeout(()=>{const yt={...E,currentHP:E.maxHP},Se=J().map(Tt=>({...Tt,currentHP:Tt.maxHP})),ct=Se.length>0?Se[0]:null;X(r,yt,ct,Se)},100)}},h);const nt=uv[r];return nt?i.jsxs("div",{className:"scene-textuel",children:[i.jsx(Jg,{text:nt.text,choices:nt.choices,onChoice:yt=>{const Se=typeof yt=="function"?yt():yt,ct=ym(Se,{startLongRest:A,startShortRest:x,handleItemGain:F,setPlayerCompanion:le,addCompanion:I,setActiveCompanions:ae,addCombatMessage:v,handleSkillCheck:b});ct&&g(ct)}}),i.jsx(as,{title:"Journal",compact:!0})]}):i.jsx("p",{children:"Fin du jeu"})},Fn=E?.spellcasting;E?.weapons&&E.weapons.length>0;const el=E?.specialAbilities;return i.jsx(rm,{FallbackComponent:bm,children:i.jsxs("div",{className:Vt,children:[i.jsx("div",{className:In,children:Wn()}),i.jsxs("div",{className:`${rn} right-sidebar`,children:[i.jsx(Dm,{character:E,variant:"interactive"}),i.jsx(Eg,{companions:J(),variant:"default",showRoles:!0}),!J().length&&D&&i.jsx(Rm,{companion:D}),i.jsx(qg,{}),Fn&&i.jsx(Pg,{character:E,onCastSpell:Ze,isOutOfCombat:!0}),el&&i.jsx(Cg,{character:E})]})]})})}iv.createRoot(document.getElementById("root")).render(i.jsx(Ig,{}));
